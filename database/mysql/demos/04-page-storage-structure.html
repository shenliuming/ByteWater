<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MySQL Pageå­˜å‚¨ç»“æ„å®Œæ•´æ¼”ç¤º</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .controls {
            text-align: center;
            margin-bottom: 30px;
        }

        .btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 0 10px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .demo-flow {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-bottom: 30px;
        }

        .step-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e9ecef;
            position: relative;
        }

        .step-title {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            color: #2c3e50;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .step-number {
            background: #3498db;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* æ­¥éª¤1ï¼šæ•°æ®å­˜å‚¨è¿›Page */
        .data-input-area {
            display: flex;
            gap: 20px;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .data-record {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            min-width: 150px;
            text-align: center;
            transition: all 0.5s ease;
        }

        .data-record.moving {
            animation: moveToPage 2s ease-in-out;
        }

        @keyframes moveToPage {
            0% { transform: translateX(0); }
            50% { transform: translateX(100px) scale(0.8); }
            100% { transform: translateX(0) scale(1); }
        }

        .arrow-down {
            font-size: 3em;
            color: #e74c3c;
            text-align: center;
            margin: 15px 0;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        /* æ­¥éª¤2ï¼šPageè¿æ¥å½¢æˆB+æ ‘ */
        .btree-structure {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .btree-level {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .page {
            background: #fff;
            border: 3px solid #3498db;
            border-radius: 12px;
            padding: 15px;
            min-width: 120px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .page.root {
            border-color: #e74c3c;
            background: #ffe6e6;
        }

        .page.leaf {
            border-color: #27ae60;
            background: #e8f5e8;
        }

        .page.loading {
            animation: pulse 1.5s infinite;
            box-shadow: 0 0 20px rgba(52, 152, 219, 0.5);
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 20px rgba(52, 152, 219, 0.3); }
            50% { transform: scale(1.05); box-shadow: 0 0 30px rgba(52, 152, 219, 0.7); }
            100% { transform: scale(1); box-shadow: 0 0 20px rgba(52, 152, 219, 0.3); }
        }

        .page-header {
            background: #3498db;
            color: white;
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 0.9em;
            margin-bottom: 10px;
            font-weight: bold;
            line-height: 1.4;
        }
        
        .page-header small {
            font-size: 0.8em;
            opacity: 0.8;
        }

        .query-area {
            background: #f8f9fa;
            border: 2px solid #007bff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .query-area h3 {
            margin: 0 0 10px 0;
            color: #007bff;
        }

        .query-box {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #333;
        }

        .scan-status {
            background: #34495e;
            color: #ecf0f1;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 12px;
            margin-top: 10px;
            border-left: 4px solid #e74c3c;
            font-weight: bold;
        }

        .highlight {
            animation: highlightPulse 2s ease-in-out;
        }

        .scanning {
            animation: scanningPulse 1.5s infinite;
            border: 3px solid #e74c3c !important;
        }

        .loading {
            animation: loadingPulse 1s infinite;
            border: 3px solid #f39c12 !important;
        }

        @keyframes highlightPulse {
            0%, 100% { 
                box-shadow: 0 0 0 rgba(52, 152, 219, 0.7); 
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 20px rgba(52, 152, 219, 0.7); 
                transform: scale(1.05);
            }
        }

        @keyframes scanningPulse {
            0%, 100% { 
                box-shadow: 0 0 0 rgba(231, 76, 60, 0.7); 
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 15px rgba(231, 76, 60, 0.7); 
                transform: scale(1.02);
            }
        }

        @keyframes loadingPulse {
            0%, 100% { 
                box-shadow: 0 0 0 rgba(243, 156, 18, 0.7); 
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 15px rgba(243, 156, 18, 0.7); 
                transform: scale(1.03);
            }
        }

        /* ç£ç›˜ç‰©ç†ç»“æ„æ ·å¼ */
        .disk-physical-structure {
            background: #f8f9fa;
            border: 2px solid #6c757d;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .disk-container {
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .disk-platter {
            position: relative;
            width: 200px;
            height: 200px;
            border: 3px solid #495057;
            border-radius: 50%;
            background: radial-gradient(circle, #6c757d 0%, #495057 70%, #343a40 100%);
            margin: 20px;
        }

        .disk-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background: #212529;
            border-radius: 50%;
            border: 2px solid #adb5bd;
        }

        .disk-tracks {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
        }

        .disk-track {
            position: absolute;
            border: 1px solid rgba(173, 181, 189, 0.3);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .disk-sector {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #28a745;
            border-radius: 50%;
            border: 1px solid #155724;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .disk-sector.active {
            background: #dc3545;
            box-shadow: 0 0 10px #dc3545;
            transform: scale(1.5);
        }

        .disk-sector.reading {
            background: #ffc107;
            animation: sectorReading 1s infinite;
        }

        .disk-sector.writing {
            background: #fd7e14;
            animation: sectorWriting 1s infinite;
        }

        .disk-sector.written {
            background: #6f42c1;
            box-shadow: 0 0 10px #6f42c1;
            transform: scale(1.3);
        }

        .disk-sector.completed {
            background: #20c997;
            box-shadow: 0 0 8px #20c997;
            transform: scale(1.2);
        }

        @keyframes sectorReading {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        @keyframes sectorWriting {
            0%, 100% { opacity: 1; transform: scale(1.5); }
            50% { opacity: 0.5; transform: scale(1.8); }
        }

        .disk-head {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }

        .head-arm {
            width: 4px;
            height: 80px;
            background: #6c757d;
            margin: 0 auto;
            border-radius: 2px;
            transition: transform 0.5s ease;
        }

        .read-head {
            width: 12px;
            height: 8px;
            background: #dc3545;
            margin: 0 auto;
            border-radius: 2px;
            box-shadow: 0 0 5px #dc3545;
        }

        .disk-info {
            flex: 1;
        }

        .disk-stats {
            background: #e9ecef;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .disk-stats div {
            margin: 8px 0;
            font-weight: bold;
            color: #495057;
        }

        .disk-stats span {
            color: #007bff;
        }

        /* Buffer Poolç»“æ„æ ·å¼ */
        .buffer-pool-structure {
            background: #f8f9fa;
            border: 2px solid #17a2b8;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .buffer-pool-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .buffer-pool-header {
            background: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }

        .pool-stats {
            display: flex;
            justify-content: space-around;
            font-weight: bold;
        }

        .pool-stats span {
            color: #495057;
        }

        .pool-stats span span {
            color: #17a2b8;
        }

        .buffer-pool-pages {
            display: flex;
            gap: 20px;
        }

        .lru-list, .free-list, .flush-list {
            flex: 1;
            background: #ffffff;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 10px;
        }

        .lru-list h5 {
            color: #28a745;
            margin: 0 0 10px 0;
            text-align: center;
        }

        .free-list h5 {
            color: #6c757d;
            margin: 0 0 10px 0;
            text-align: center;
        }

        .flush-list h5 {
            color: #dc3545;
            margin: 0 0 10px 0;
            text-align: center;
        }

        .lru-chain, .free-chain, .flush-chain {
            min-height: 100px;
            border: 1px dashed #dee2e6;
            border-radius: 3px;
            padding: 5px;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .buffer-page-item {
            background: #e9ecef;
            border: 1px solid #adb5bd;
            border-radius: 3px;
            padding: 5px;
            font-size: 12px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .buffer-page-item.lru {
            background: #d4edda;
            border-color: #28a745;
        }

        .buffer-page-item.free {
            background: #f8f9fa;
            border-color: #6c757d;
        }

        .buffer-page-item.dirty {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .buffer-page-item.active {
            transform: scale(1.05);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .page.root .page-header {
            background: #e74c3c;
        }

        .page.leaf .page-header {
            background: #27ae60;
        }

        .record {
            background: #e8f4fd;
            border: 1px solid #3498db;
            border-radius: 4px;
            padding: 6px;
            margin: 3px 0;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }

        .record.new {
            animation: slideIn 0.8s ease;
            background: #fff3cd;
            border-color: #ffc107;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-30px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        .connection-line {
            width: 2px;
            height: 30px;
            background: #3498db;
            margin: 0 auto;
        }

        /* æ­¥éª¤3ï¼šç£ç›˜åˆ°Buffer Pool */
        .disk-buffer-flow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 30px;
        }

        .disk-section, .buffer-pool-section {
            flex: 1;
            background: #f1f3f4;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #ddd;
            min-height: 300px;
        }

        .disk-section {
            border-color: #8e44ad;
            background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);
        }

        .buffer-pool-section {
            border-color: #16a085;
            background: linear-gradient(135deg, #f0fdfa 0%, #ccfbf1 100%);
        }

        .section-title {
            font-size: 1.4em;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            color: #2c3e50;
        }

        .transfer-arrow {
            font-size: 4em;
            color: #e74c3c;
            text-align: center;
            animation: slideRight 2s infinite;
        }

        /* æ–°å¢ï¼šæµç¨‹æ­¥éª¤æŒ‡ç¤ºå™¨æ ·å¼ */
        .process-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 30px 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .process-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            transition: all 0.3s ease;
        }

        .process-step.active {
            transform: scale(1.1);
        }

        .process-step.active .step-circle {
            background: #ffd700;
            color: #333;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .step-label {
            font-size: 12px;
            text-align: center;
            font-weight: 500;
        }

        .process-arrow {
            font-size: 24px;
            color: white;
            margin: 0 20px;
            opacity: 0.7;
        }

        /* æ–°å¢ï¼šä¸»è¦æ¼”ç¤ºå®¹å™¨æ ·å¼ */
        .demo-main-container {
            display: flex;
            gap: 20px;
            margin: 30px 0;
            min-height: 600px;
        }

        .demo-left-panel, .demo-right-panel {
            flex: 1;
            background: #ffffff;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border: 2px solid #e9ecef;
        }

        .demo-left-panel {
            border-left: 5px solid #e74c3c;
        }

        .demo-right-panel {
            border-left: 5px solid #3498db;
        }

        .panel-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f8f9fa;
        }

        .panel-header h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }

        .disk-status, .buffer-status {
            background: #f8f9fa;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            color: #6c757d;
            border: 1px solid #dee2e6;
        }

        /* æ–°å¢ï¼šç£ç›˜è¯¦ç»†ä¿¡æ¯æ ·å¼ */
        .disk-details {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-row .label {
            font-weight: 600;
            color: #495057;
        }

        .detail-row .value {
            font-weight: bold;
            color: #007bff;
            background: #e7f3ff;
            padding: 4px 8px;
            border-radius: 4px;
        }

        /* æ–°å¢ï¼šæ“ä½œè¿›åº¦æ ·å¼ */
        .disk-operation-progress, .buffer-operation-progress {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }

        .progress-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }

        .progress-steps {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 1px solid #dee2e6;
            transition: all 0.3s ease;
        }

        .progress-step.active {
            background: #e7f3ff;
            border-color: #007bff;
            transform: translateX(5px);
        }

        .progress-step.completed {
            background: #d4edda;
            border-color: #28a745;
        }

        .progress-icon {
            font-size: 18px;
            width: 30px;
            text-align: center;
        }

        .progress-text {
            flex: 1;
            font-weight: 500;
            color: #495057;
        }

        .progress-status {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 12px;
            background: #f8f9fa;
            color: #6c757d;
        }

        .progress-step.active .progress-status {
            background: #007bff;
            color: white;
        }

        .progress-step.completed .progress-status {
            background: #28a745;
            color: white;
        }

        /* æ–°å¢ï¼šæ“ä½œæ§åˆ¶é¢æ¿æ ·å¼ */
        .operation-control-panel {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .control-section h4 {
            color: white;
            text-align: center;
            margin: 0 0 20px 0;
            font-size: 20px;
        }

        .control-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            min-width: 200px;
        }

        .read-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .read-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        .write-btn {
            background: linear-gradient(135deg, #dc3545, #fd7e14);
            color: white;
        }

        .write-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
        }

        .reset-btn {
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
        }

        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
        }

        .operation-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 12px 20px;
            color: white;
        }

        .status-indicator {
            font-size: 20px;
            animation: pulse 2s infinite;
        }

        .status-text {
            font-weight: 500;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* æ–°å¢ï¼šåŒå‘æµç¨‹æŒ‡ç¤ºå™¨æ ·å¼ */
        .bidirectional-process {
            margin: 30px 0;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e9ecef;
        }

        .process-direction {
            margin-bottom: 25px;
        }

        .process-direction:last-child {
            margin-bottom: 0;
        }

        .process-title {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
            padding: 10px;
            border-radius: 8px;
        }

        .process-direction:nth-child(1) .process-title {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .process-direction:nth-child(2) .process-title {
            background: linear-gradient(135deg, #dc3545, #fd7e14);
            color: white;
        }

        .process-steps {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .process-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            border: 2px solid #dee2e6;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .process-step.active {
            border-color: #007bff;
            background: #e7f3ff;
            transform: scale(1.05);
        }

        .process-step.completed {
            border-color: #28a745;
            background: #d4edda;
        }

        .step-description {
            font-size: 11px;
            color: #6c757d;
            text-align: center;
            margin: 5px 0;
            line-height: 1.3;
            max-width: 140px;
        }

        .step-status {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 12px;
            background: #f8f9fa;
            color: #6c757d;
            margin-top: 8px;
        }

        .process-step.active .step-status {
            background: #007bff;
            color: white;
        }

        .process-step.completed .step-status {
            background: #28a745;
            color: white;
        }

        /* æ–°å¢ï¼šåŒå‘æ•°æ®æµåŠ¨æ ·å¼ */
        .demo-center-flow {
            width: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .flow-container {
            position: relative;
            height: 400px;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 40px;
        }

        .flow-arrow {
            position: relative;
            height: 60px;
            width: 100%;
            opacity: 0.3;
            transition: all 0.5s ease;
        }

        .flow-arrow.active {
            opacity: 1;
            transform: scale(1.1);
        }

        .read-flow {
            transform: rotate(0deg);
        }

        .write-flow {
            transform: rotate(180deg);
        }

        .arrow-body {
            height: 8px;
            background: linear-gradient(90deg, #007bff, #0056b3);
            border-radius: 4px;
            position: relative;
            margin: 26px 10px 26px 0;
        }

        .write-flow .arrow-body {
            background: linear-gradient(90deg, #dc3545, #c82333);
        }

        .arrow-head {
            position: absolute;
            right: -10px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid #0056b3;
            border-top: 15px solid transparent;
            border-bottom: 15px solid transparent;
        }

        .write-flow .arrow-head {
            border-left-color: #c82333;
        }

        .flow-data {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 8px 12px;
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            font-size: 12px;
            font-weight: bold;
            white-space: nowrap;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .flow-arrow.active .flow-data {
            opacity: 1;
            animation: flowData 2s ease-in-out infinite;
        }

        @keyframes flowData {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }

        .flow-label {
            text-align: center;
            font-weight: bold;
            color: #6c757d;
            margin-top: 20px;
            padding: 8px 15px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 1px solid #dee2e6;
        }

        /* æ–°å¢ï¼šBuffer Poolç»Ÿè®¡æ ·å¼ä¼˜åŒ– */
        .buffer-pool-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .stat-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #dee2e6;
        }

        .stat-label {
            font-size: 12px;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 16px;
            font-weight: bold;
            color: #007bff;
        }


        .progress-step.completed .progress-status {
            background: #28a745;
            color: white;
        }

        /* æ–°å¢ï¼šä¸­é—´æ•°æ®æµåŠ¨æ ·å¼ */
        .demo-center-flow {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 120px;
            position: relative;
        }

        .flow-arrow {
            position: relative;
            width: 80px;
            height: 6px;
            background: #e74c3c;
            border-radius: 3px;
            margin: 20px 0;
        }

        .arrow-head {
            position: absolute;
            right: -10px;
            top: -7px;
            width: 0;
            height: 0;
            border-left: 20px solid #e74c3c;
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
        }

        .flow-data {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
        }

        .flow-data.flowing {
            animation: dataFlow 2s ease-in-out;
        }

        .data-packet {
            background: #ffd700;
            color: #333;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        @keyframes dataFlow {
            0% {
                opacity: 0;
                transform: translateX(-150%);
            }
            50% {
                opacity: 1;
                transform: translateX(-50%);
            }
            100% {
                opacity: 0;
                transform: translateX(50%);
            }
        }

        .flow-label {
            font-size: 12px;
            color: #6c757d;
            font-weight: 500;
            text-align: center;
        }

        /* æ–°å¢ï¼šBuffer Poolç»Ÿè®¡æ ·å¼ */
        .buffer-pool-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .stat-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            border: 1px solid #dee2e6;
        }

        .stat-label {
            font-size: 12px;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .stat-value {
            font-weight: bold;
            color: #007bff;
            font-size: 14px;
        }

        /* æ–°å¢ï¼šåº•éƒ¨æ¼”ç¤ºåŒºåŸŸæ ·å¼ */
        .demo-bottom-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }

        /* æ›´æ–°ç£ç›˜å®¹å™¨æ ·å¼ */
        .disk-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .disk-platter {
            position: relative;
            width: 180px;
            height: 180px;
            border: 3px solid #495057;
            border-radius: 50%;
            background: radial-gradient(circle, #6c757d 0%, #495057 70%, #343a40 100%);
        }

        @keyframes slideRight {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(20px); }
        }

        .log-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e9ecef;
            max-height: 350px;
            overflow-y: auto;
        }

        .log-entry {
            padding: 10px 15px;
            margin: 8px 0;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            background: white;
            animation: fadeIn 0.5s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .log-entry.success {
            border-left-color: #27ae60;
            background: #f8fff8;
        }

        .log-entry.warning {
            border-left-color: #f39c12;
            background: #fffbf0;
        }

        .log-entry.info {
            border-left-color: #3498db;
            background: #f8fbff;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .status-bar {
            background: linear-gradient(45deg, #2c3e50, #34495e);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 25px;
            font-weight: bold;
            font-size: 1.1em;
        }

        .highlight {
            animation: highlight 1s ease;
        }

        @keyframes highlight {
            0% { background-color: transparent; }
            50% { background-color: #fff3cd; }
            100% { background-color: transparent; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—„ï¸ MySQL Pageå­˜å‚¨ç»“æ„å®Œæ•´æ¼”ç¤º</h1>
        
        <div class="status-bar" id="statusBar">
            å‡†å¤‡æ¼”ç¤ºå®Œæ•´çš„Pageå­˜å‚¨æµç¨‹ï¼šæ•°æ®å­˜å‚¨ â†’ Pageè¿æ¥ â†’ ç£ç›˜è¯»å–åˆ°Buffer Pool
        </div>

        <div class="controls">
            <button class="btn" onclick="demonstrateDataStorage()">ğŸ“ æ¼”ç¤ºæ•°æ®å­˜å‚¨è¿›Page</button>
            <button class="btn" onclick="demonstratePageConnection()">ğŸ”— æ¼”ç¤ºPageè¿æ¥æˆB+æ ‘</button>
            <button class="btn" onclick="demonstrateDiskToBuffer()">ğŸ’¾ æ¼”ç¤ºç£ç›˜è¯»å–åˆ°Buffer Pool</button>
            <button class="btn" onclick="demonstrateQuery()">ğŸ” æ¼”ç¤ºæŸ¥è¯¢æ“ä½œ</button>
            <button class="btn" onclick="demonstrateComplete()">ğŸ¬ å®Œæ•´æ¼”ç¤ºæµç¨‹</button>
            <button class="btn" onclick="reset()">ğŸ”„ é‡ç½®æ¼”ç¤º</button>
        </div>

        <div class="demo-flow">
            <!-- æ­¥éª¤1ï¼šæ•°æ®å­˜å‚¨è¿›Page -->
            <div class="step-section" id="step1">
                <div class="step-title">
                    <div class="step-number">1</div>
                    æ•°æ®å­˜å‚¨è¿›å…¥Page
                </div>
                <div class="data-input-area" id="dataInputArea">
                    <!-- åŠ¨æ€ç”Ÿæˆæ•°æ®è®°å½• -->
                </div>
                <div class="arrow-down">â¬‡ï¸</div>
                <div id="storagePages" style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                    <!-- åŠ¨æ€ç”ŸæˆPage -->
                </div>
            </div>

            <!-- æ­¥éª¤2ï¼šPageè¿æ¥å½¢æˆB+æ ‘ -->
            <div class="step-section" id="step2">
                <div class="step-title">
                    <div class="step-number">2</div>
                    Pageè¿æ¥å½¢æˆB+æ ‘ç»“æ„
                </div>
                <div class="btree-structure" id="btreeStructure">
                    <!-- åŠ¨æ€ç”ŸæˆB+æ ‘ç»“æ„ -->
                </div>
            </div>

            <!-- æ­¥éª¤3ï¼šç£ç›˜ç‰©ç†ç»“æ„ä¸Buffer Poolè¯»å†™æ¼”ç¤º -->
            <div class="step-section" id="step3">
                <div class="step-title">
                    <div class="step-number">3</div>
                    ç£ç›˜ç‰©ç†ç»“æ„ä¸Buffer Poolè¯»å†™æ¼”ç¤º
                </div>
                
                <!-- æ“ä½œæ§åˆ¶é¢æ¿ -->
                <div class="operation-control-panel">
                    <div class="control-section">
                        <h4>ğŸ“‹ æ“ä½œæ§åˆ¶</h4>
                        <div class="control-buttons">
                            <button class="control-btn read-btn" onclick="startDiskToBufferDemo()">
                                ğŸ“– ç£ç›˜è¯»å–åˆ°Buffer Pool
                            </button>
                            <button class="control-btn write-btn" onclick="startBufferToDiskDemo()">
                                ğŸ’¾ Buffer Poolå†™å›ç£ç›˜
                            </button>
                            <button class="control-btn reset-btn" onclick="resetDemo()">
                                ğŸ”„ é‡ç½®æ¼”ç¤º
                            </button>
                        </div>
                        <div class="operation-status" id="operationStatus">
                            <div class="status-indicator" id="statusIndicator">â¸ï¸</div>
                            <div class="status-text" id="statusText">ç­‰å¾…æ“ä½œ...</div>
                        </div>
                    </div>
                </div>

                <!-- åŒå‘æµç¨‹æŒ‡ç¤ºå™¨ -->
                <div class="bidirectional-process">
                    <!-- è¯»å–æµç¨‹ï¼šç£ç›˜ â†’ Buffer Pool -->
                    <div class="process-direction" id="readProcess">
                        <div class="process-title">ğŸ“– è¯»å–æµç¨‹ï¼šç£ç›˜ â†’ Buffer Pool</div>
                        <div class="process-steps">
                            <div class="process-step" id="read-step-1">
                                <div class="step-circle">1</div>
                                <div class="step-label">SQLæŸ¥è¯¢è¯·æ±‚</div>
                                <div class="step-description">æ¥æ”¶SELECTæŸ¥è¯¢ï¼Œè§£æç›®æ ‡é¡µé¢ID</div>
                                <div class="step-status">å¾…æ‰§è¡Œ</div>
                            </div>
                            <div class="process-arrow">â†’</div>
                            <div class="process-step" id="read-step-2">
                                <div class="step-circle">2</div>
                                <div class="step-label">Buffer Poolæ£€æŸ¥</div>
                                <div class="step-description">åœ¨LRUé“¾è¡¨ä¸­æŸ¥æ‰¾é¡µé¢ï¼Œæ£€æŸ¥ç¼“å­˜å‘½ä¸­</div>
                                <div class="step-status">å¾…æ‰§è¡Œ</div>
                            </div>
                            <div class="process-arrow">â†’</div>
                            <div class="process-step" id="read-step-3">
                                <div class="step-circle">3</div>
                                <div class="step-label">ç£ç›˜å¯»å€å®šä½</div>
                                <div class="step-description">è®¡ç®—é¡µé¢ç‰©ç†åœ°å€ï¼Œç§»åŠ¨ç£å¤´åˆ°ç›®æ ‡ç£é“</div>
                                <div class="step-status">å¾…æ‰§è¡Œ</div>
                            </div>
                            <div class="process-arrow">â†’</div>
                            <div class="process-step" id="read-step-4">
                                <div class="step-circle">4</div>
                                <div class="step-label">ç£ç›˜æ•°æ®è¯»å–</div>
                                <div class="step-description">ç­‰å¾…ç£ç›˜æ—‹è½¬ï¼Œè¯»å–æ‰‡åŒºæ•°æ®åˆ°å†…å­˜</div>
                                <div class="step-status">å¾…æ‰§è¡Œ</div>
                            </div>
                            <div class="process-arrow">â†’</div>
                            <div class="process-step" id="read-step-5">
                                <div class="step-circle">5</div>
                                <div class="step-label">åŠ è½½åˆ°Buffer Pool</div>
                                <div class="step-description">å°†é¡µé¢åŠ å…¥LRUé“¾è¡¨å¤´éƒ¨ï¼Œæ›´æ–°ç»Ÿè®¡ä¿¡æ¯</div>
                                <div class="step-status">å¾…æ‰§è¡Œ</div>
                            </div>
                        </div>
                    </div>

                    <!-- å†™å…¥æµç¨‹ï¼šBuffer Pool â†’ ç£ç›˜ -->
                    <div class="process-direction" id="writeProcess">
                        <div class="process-title">ğŸ’¾ å†™å…¥æµç¨‹ï¼šBuffer Pool â†’ ç£ç›˜</div>
                        <div class="process-steps">
                            <div class="process-step" id="write-step-1">
                                <div class="step-circle">1</div>
                                <div class="step-label">è„é¡µæ£€æµ‹</div>
                                <div class="step-description">æ‰«æBuffer Poolï¼Œè¯†åˆ«éœ€è¦åˆ·ç›˜çš„è„é¡µ</div>
                                <div class="step-status">å¾…æ‰§è¡Œ</div>
                            </div>
                            <div class="process-arrow">â†’</div>
                            <div class="process-step" id="write-step-2">
                                <div class="step-circle">2</div>
                                <div class="step-label">Flushé“¾è¡¨å¤„ç†</div>
                                <div class="step-description">ä»Flushé“¾è¡¨é€‰æ‹©é¡µé¢ï¼Œå‡†å¤‡å†™å›æ“ä½œ</div>
                                <div class="step-status">å¾…æ‰§è¡Œ</div>
                            </div>
                            <div class="process-arrow">â†’</div>
                            <div class="process-step" id="write-step-3">
                                <div class="step-circle">3</div>
                                <div class="step-label">ç£ç›˜å¯»å€å®šä½</div>
                                <div class="step-description">è®¡ç®—ç›®æ ‡ç£ç›˜ä½ç½®ï¼Œç§»åŠ¨ç£å¤´åˆ°å†™å…¥ç£é“</div>
                                <div class="step-status">å¾…æ‰§è¡Œ</div>
                            </div>
                            <div class="process-arrow">â†’</div>
                            <div class="process-step" id="write-step-4">
                                <div class="step-circle">4</div>
                                <div class="step-label">ç£ç›˜æ•°æ®å†™å…¥</div>
                                <div class="step-description">ç­‰å¾…ç£ç›˜æ—‹è½¬ï¼Œå°†è„é¡µæ•°æ®å†™å…¥æ‰‡åŒº</div>
                                <div class="step-status">å¾…æ‰§è¡Œ</div>
                            </div>
                            <div class="process-arrow">â†’</div>
                            <div class="process-step" id="write-step-5">
                                <div class="step-circle">5</div>
                                <div class="step-label">æ›´æ–°é¡µé¢çŠ¶æ€</div>
                                <div class="step-description">æ¸…é™¤è„é¡µæ ‡è®°ï¼Œä»Flushé“¾è¡¨ç§»é™¤</div>
                                <div class="step-status">å¾…æ‰§è¡Œ</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ä¸»è¦æ¼”ç¤ºåŒºåŸŸï¼šå·¦å³å¸ƒå±€ -->
                <div class="demo-main-container">
                    <!-- å·¦ä¾§ï¼šç£ç›˜ç‰©ç†ç»“æ„ -->
                    <div class="demo-left-panel">
                        <div class="panel-header">
                            <h4>ğŸ’¿ ç£ç›˜ç‰©ç†ç»“æ„</h4>
                            <div class="disk-status" id="diskStatus">ç­‰å¾…æ“ä½œ...</div>
                        </div>
                        
                        <div class="disk-container">
                            <div class="disk-platter">
                                <div class="disk-center"></div>
                                <div class="disk-tracks">
                                    <!-- ç£é“å’Œæ‰‡åŒºå°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                                </div>
                                <div class="disk-head">
                                    <div class="head-arm"></div>
                                    <div class="read-head"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="disk-details">
                            <div class="detail-row">
                                <span class="label">å½“å‰ç£é“:</span>
                                <span class="value" id="currentTrack">0</span>
                            </div>
                            <div class="detail-row">
                                <span class="label">å½“å‰æ‰‡åŒº:</span>
                                <span class="value" id="currentSector">0</span>
                            </div>
                            <div class="detail-row">
                                <span class="label">å¯»é“æ—¶é—´:</span>
                                <span class="value" id="seekTime">0ms</span>
                            </div>
                            <div class="detail-row">
                                <span class="label">æ—‹è½¬å»¶è¿Ÿ:</span>
                                <span class="value" id="rotationDelay">0ms</span>
                            </div>
                            <div class="detail-row">
                                <span class="label">ä¼ è¾“æ—¶é—´:</span>
                                <span class="value" id="transferTime">0ms</span>
                            </div>
                            <div class="detail-row">
                                <span class="label">æ€»I/Oæ—¶é—´:</span>
                                <span class="value" id="totalIOTime">0ms</span>
                            </div>
                        </div>

                        <!-- ç£ç›˜æ“ä½œè¿›åº¦ -->
                        <div class="disk-operation-progress">
                            <div class="progress-title">ç£ç›˜æ“ä½œè¿›åº¦</div>
                            <div class="progress-steps">
                                <div class="progress-step" id="seek-progress">
                                    <div class="progress-icon">ğŸ¯</div>
                                    <div class="progress-text">å¯»é“å®šä½</div>
                                    <div class="progress-status">å¾…æ‰§è¡Œ</div>
                                </div>
                                <div class="progress-step" id="rotation-progress">
                                    <div class="progress-icon">ğŸ”„</div>
                                    <div class="progress-text">æ—‹è½¬ç­‰å¾…</div>
                                    <div class="progress-status">å¾…æ‰§è¡Œ</div>
                                </div>
                                <div class="progress-step" id="io-progress">
                                    <div class="progress-icon">ğŸ“–</div>
                                    <div class="progress-text">æ•°æ®I/O</div>
                                    <div class="progress-status">å¾…æ‰§è¡Œ</div>
                                </div>
                                <div class="progress-step" id="transfer-progress">
                                    <div class="progress-icon">ğŸ“¤</div>
                                    <div class="progress-text">æ•°æ®ä¼ è¾“</div>
                                    <div class="progress-status">å¾…æ‰§è¡Œ</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ä¸­é—´ï¼šåŒå‘æ•°æ®æµåŠ¨ -->
                    <div class="demo-center-flow">
                        <div class="flow-container">
                            <!-- è¯»å–æµåŠ¨ï¼šç£ç›˜ â†’ Buffer Pool -->
                            <div class="flow-arrow read-flow" id="readDataFlow">
                                <div class="arrow-body"></div>
                                <div class="arrow-head"></div>
                                <div class="flow-data" id="readFlowingData">
                                    <div class="data-packet">ğŸ“– Page Data</div>
                                </div>
                            </div>
                            
                            <!-- å†™å…¥æµåŠ¨ï¼šBuffer Pool â†’ ç£ç›˜ -->
                            <div class="flow-arrow write-flow" id="writeDataFlow">
                                <div class="arrow-body"></div>
                                <div class="arrow-head"></div>
                                <div class="flow-data" id="writeFlowingData">
                                    <div class="data-packet">ğŸ’¾ Dirty Page</div>
                                </div>
                            </div>
                        </div>
                        <div class="flow-label" id="flowLabel">ç­‰å¾…æ“ä½œ...</div>
                    </div>

                    <!-- å³ä¾§ï¼šBuffer Poolç»“æ„ -->
                    <div class="demo-right-panel">
                        <div class="panel-header">
                            <h4>ğŸ§  Buffer Pool å†…å­˜ç»“æ„</h4>
                            <div class="buffer-status" id="bufferStatus">ç­‰å¾…æ•°æ®...</div>
                        </div>
                        
                        <div class="buffer-pool-stats">
                            <div class="stat-item">
                                <div class="stat-label">æ€»å®¹é‡</div>
                                <div class="stat-value" id="poolTotalSize">128MB</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">å·²ä½¿ç”¨</div>
                                <div class="stat-value" id="poolUsedSize">0MB</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">å‘½ä¸­ç‡</div>
                                <div class="stat-value" id="poolHitRate">0%</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">è¯»å–æ¬¡æ•°</div>
                                <div class="stat-value" id="poolReadCount">0</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">å†™å…¥æ¬¡æ•°</div>
                                <div class="stat-value" id="poolWriteCount">0</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">è„é¡µæ•°é‡</div>
                                <div class="stat-value" id="poolDirtyCount">0</div>
                            </div>
                        </div>

                        <div class="buffer-pool-structure">
                            <div class="lru-list">
                                <h5>ğŸ”„ LRUé“¾è¡¨ (æœ€è¿‘æœ€å°‘ä½¿ç”¨)</h5>
                                <div id="lruChain" class="lru-chain"></div>
                            </div>
                            <div class="free-list">
                                <h5>ğŸ†“ Freeé“¾è¡¨ (ç©ºé—²é¡µé¢)</h5>
                                <div id="freeChain" class="free-chain"></div>
                            </div>
                            <div class="flush-list">
                                <h5>ğŸ’¾ Flushé“¾è¡¨ (è„é¡µ)</h5>
                                <div id="flushChain" class="flush-chain"></div>
                            </div>
                        </div>

                        <!-- Buffer Poolæ“ä½œè¿›åº¦ -->
                        <div class="buffer-operation-progress">
                            <div class="progress-title">Buffer Poolæ“ä½œ</div>
                            <div class="progress-steps">
                                <div class="progress-step" id="cache-check-progress">
                                    <div class="progress-icon">ğŸ”</div>
                                    <div class="progress-text">ç¼“å­˜æ£€æŸ¥</div>
                                    <div class="progress-status">å¾…æ‰§è¡Œ</div>
                                </div>
                                <div class="progress-step" id="page-manage-progress">
                                    <div class="progress-icon">ğŸ“„</div>
                                    <div class="progress-text">é¡µé¢ç®¡ç†</div>
                                    <div class="progress-status">å¾…æ‰§è¡Œ</div>
                                </div>
                                <div class="progress-step" id="lru-update-progress">
                                    <div class="progress-icon">ğŸ”„</div>
                                    <div class="progress-text">LRUæ›´æ–°</div>
                                    <div class="progress-status">å¾…æ‰§è¡Œ</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="log-section">
            <div class="step-title">ğŸ“‹ æ“ä½œæ—¥å¿—</div>
            <div id="operationLog"></div>
        </div>
    </div>

    <script>
        let recordId = 1;
        let pageId = 1;
        let pages = [];
        let bufferPoolPages = [];
        let currentStep = 0;
        
        // ç£ç›˜ç‰©ç†ç»“æ„
        let diskStructure = {
            tracks: 8,        // ç£é“æ•°
            sectorsPerTrack: 16,  // æ¯ç£é“æ‰‡åŒºæ•°
            currentTrack: 0,
            currentSector: 0,
            sectors: []       // æ‰‡åŒºæ•°æ®æ˜ å°„
        };
        
        // Buffer Poolç®¡ç†
        let bufferPoolManager = {
            totalSize: 128 * 1024 * 1024,  // 128MB
            pageSize: 16 * 1024,            // 16KB per page
            maxPages: 8192,                 // æœ€å¤§é¡µé¢æ•°
            usedPages: 0,
            hitCount: 0,
            missCount: 0,
            lruList: [],      // LRUé“¾è¡¨
            freeList: [],     // ç©ºé—²é“¾è¡¨
            flushList: []     // è„é¡µé“¾è¡¨
        };
        
        // å·¥å…·å‡½æ•°
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // åˆå§‹åŒ–ç£ç›˜ç‰©ç†ç»“æ„
        function initializeDiskStructure() {
            const tracksContainer = document.querySelector('.disk-tracks');
            tracksContainer.innerHTML = '';
            
            // åˆå§‹åŒ–æ‰‡åŒºæ•°æ®
            diskStructure.sectors = [];
            
            for (let track = 0; track < diskStructure.tracks; track++) {
                // åˆ›å»ºç£é“
                const trackElement = document.createElement('div');
                trackElement.className = 'disk-track';
                const radius = 30 + track * 15;
                trackElement.style.width = radius * 2 + 'px';
                trackElement.style.height = radius * 2 + 'px';
                tracksContainer.appendChild(trackElement);
                
                // åœ¨æ¯ä¸ªç£é“ä¸Šåˆ›å»ºæ‰‡åŒº
                for (let sector = 0; sector < diskStructure.sectorsPerTrack; sector++) {
                    const sectorElement = document.createElement('div');
                    sectorElement.className = 'disk-sector';
                    sectorElement.setAttribute('data-track', track);
                    sectorElement.setAttribute('data-sector', sector);
                    
                    // è®¡ç®—æ‰‡åŒºä½ç½®
                    const angle = (sector / diskStructure.sectorsPerTrack) * 2 * Math.PI;
                    const x = Math.cos(angle) * radius;
                    const y = Math.sin(angle) * radius;
                    
                    sectorElement.style.left = (100 + x - 4) + 'px';
                    sectorElement.style.top = (100 + y - 4) + 'px';
                    
                    // éšæœºåˆ†é…ä¸€äº›æ‰‡åŒºç»™é¡µé¢
                    const sectorData = {
                        track: track,
                        sector: sector,
                        pageId: null,
                        element: sectorElement
                    };
                    
                    // ä¸ºå‰å‡ ä¸ªé¡µé¢åˆ†é…æ‰‡åŒº
                    if (diskStructure.sectors.length < pages.length) {
                        sectorData.pageId = pages[diskStructure.sectors.length].id;
                        sectorElement.title = `Page ${sectorData.pageId}`;
                    }
                    
                    diskStructure.sectors.push(sectorData);
                    tracksContainer.appendChild(sectorElement);
                }
            }
        }

        // åˆå§‹åŒ–Buffer Pool
        function initializeBufferPool() {
            // åˆå§‹åŒ–ç©ºé—²é“¾è¡¨
            bufferPoolManager.freeList = [];
            for (let i = 0; i < 20; i++) {  // æ˜¾ç¤º20ä¸ªç©ºé—²é¡µé¢æ§½ä½
                bufferPoolManager.freeList.push({
                    id: `free_${i}`,
                    type: 'free',
                    status: 'available'
                });
            }
            
            bufferPoolManager.lruList = [];
            bufferPoolManager.flushList = [];
            bufferPoolManager.usedPages = 0;
            bufferPoolManager.hitCount = 0;
            bufferPoolManager.missCount = 0;
            
            renderBufferPoolStructure();
        }

        // æ¸²æŸ“Buffer Poolç»“æ„
        function renderBufferPoolStructure() {
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            const usedSizeMB = (bufferPoolManager.usedPages * bufferPoolManager.pageSize / (1024 * 1024)).toFixed(1);
            const hitRate = bufferPoolManager.hitCount + bufferPoolManager.missCount > 0 ? 
                ((bufferPoolManager.hitCount / (bufferPoolManager.hitCount + bufferPoolManager.missCount)) * 100).toFixed(1) : 0;
            
            document.getElementById('poolUsedSize').textContent = usedSizeMB + 'MB';
            document.getElementById('poolHitRate').textContent = hitRate + '%';
            
            // æ¸²æŸ“LRUé“¾è¡¨
            const lruChain = document.getElementById('lruChain');
            lruChain.innerHTML = '';
            bufferPoolManager.lruList.forEach((page, index) => {
                const pageItem = document.createElement('div');
                pageItem.className = 'buffer-page-item lru';
                pageItem.textContent = `Page ${page.id}`;
                if (index === 0) pageItem.style.fontWeight = 'bold';
                lruChain.appendChild(pageItem);
            });
            
            // æ¸²æŸ“Freeé“¾è¡¨
            const freeChain = document.getElementById('freeChain');
            freeChain.innerHTML = '';
            bufferPoolManager.freeList.slice(0, 10).forEach(page => {
                const pageItem = document.createElement('div');
                pageItem.className = 'buffer-page-item free';
                pageItem.textContent = page.status === 'available' ? 'ç©ºé—²æ§½ä½' : `Page ${page.id}`;
                freeChain.appendChild(pageItem);
            });
            
            // æ¸²æŸ“Flushé“¾è¡¨ï¼ˆè„é¡µï¼‰
            const flushChain = document.getElementById('flushChain');
            flushChain.innerHTML = '';
            bufferPoolManager.flushList.forEach(page => {
                const pageItem = document.createElement('div');
                pageItem.className = 'buffer-page-item dirty';
                pageItem.textContent = `Page ${page.id} (è„)`;
                flushChain.appendChild(pageItem);
            });
        }

        // æ¨¡æ‹Ÿç£ç›˜å¯»å€
        async function simulateDiskSeek(targetTrack, targetSector) {
            const currentTrack = diskStructure.currentTrack;
            const seekTime = Math.abs(targetTrack - currentTrack) * 2; // æ¯ç£é“2ms
            const rotationDelay = Math.random() * 8; // 0-8msæ—‹è½¬å»¶è¿Ÿ
            
            // æ›´æ–°æ˜¾ç¤º
            document.getElementById('currentTrack').textContent = targetTrack;
            document.getElementById('currentSector').textContent = targetSector;
            document.getElementById('seekTime').textContent = seekTime.toFixed(1) + 'ms';
            document.getElementById('rotationDelay').textContent = rotationDelay.toFixed(1) + 'ms';
            
            // ç§»åŠ¨ç£å¤´
            const headArm = document.querySelector('.head-arm');
            const angle = (targetTrack / diskStructure.tracks) * 45 - 22.5; // -22.5 to 22.5 degrees
            headArm.style.transform = `rotate(${angle}deg)`;
            
            // é«˜äº®ç›®æ ‡æ‰‡åŒº
            const targetSectorElement = document.querySelector(`[data-track="${targetTrack}"][data-sector="${targetSector}"]`);
            if (targetSectorElement) {
                targetSectorElement.classList.add('active');
                setTimeout(() => {
                    targetSectorElement.classList.remove('active');
                }, 2000);
            }
            
            diskStructure.currentTrack = targetTrack;
            diskStructure.currentSector = targetSector;
            
            return seekTime + rotationDelay;
        }

        // Buffer Poolé¡µé¢ç®¡ç†
        function addPageToBufferPool(page) {
            // ä»Freeé“¾è¡¨è·å–ç©ºé—²æ§½ä½
            if (bufferPoolManager.freeList.length > 0) {
                const freeSlot = bufferPoolManager.freeList.shift();
                
                // æ·»åŠ åˆ°LRUé“¾è¡¨å¤´éƒ¨
                const bufferPage = {
                    id: page.id,
                    records: page.records,
                    type: page.type,
                    usedSpace: page.usedSpace,
                    loadTime: new Date().toLocaleTimeString(),
                    isDirty: false
                };
                
                bufferPoolManager.lruList.unshift(bufferPage);
                bufferPoolManager.usedPages++;
                
                // æ¨¡æ‹Ÿé¡µé¢è¢«ä¿®æ”¹ï¼Œéšæœºæ ‡è®°ä¸ºè„é¡µ
                if (Math.random() < 0.7) { // 70%æ¦‚ç‡æˆä¸ºè„é¡µ
                    setTimeout(() => {
                        markPageAsDirty(bufferPage.id);
                    }, 2000);
                }
                
                renderBufferPoolStructure();
                
                addLog(`ğŸ“ é¡µé¢å·²æ·»åŠ åˆ°Buffer Pool LRUé“¾è¡¨å¤´éƒ¨`, 'success');
                return true;
            } else {
                // Buffer Poolæ»¡äº†ï¼Œéœ€è¦LRUæ·˜æ±°
                addLog(`âš ï¸ Buffer Poolå·²æ»¡ï¼Œæ‰§è¡ŒLRUæ·˜æ±°ç­–ç•¥`, 'warning');
                return false;
            }
        }

        function markPageAsDirty(pageId) {
            const page = bufferPoolManager.lruList.find(p => p.id === pageId);
            if (page && !page.isDirty) {
                page.isDirty = true;
                bufferPoolManager.flushList.push(page);
                renderBufferPoolStructure();
                addLog(`ğŸ’¾ Page ${pageId} æ ‡è®°ä¸ºè„é¡µï¼Œæ·»åŠ åˆ°Flushé“¾è¡¨`, 'info');
            }
        }

        // æ‰‹åŠ¨åˆ›å»ºè„é¡µç”¨äºæ¼”ç¤º
        function createDirtyPageForDemo() {
            if (bufferPoolManager.lruList.length > 0) {
                const randomPage = bufferPoolManager.lruList[Math.floor(Math.random() * bufferPoolManager.lruList.length)];
                if (!randomPage.isDirty) {
                    markPageAsDirty(randomPage.id);
                    addLog(`ğŸ”§ æ‰‹åŠ¨åˆ›å»ºè„é¡µ: Page ${randomPage.id}`, 'info');
                }
            }
        }
        
        // çœŸå®çš„ç”¨æˆ·è¡¨ç»“æ„
        const userNames = ['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'èµµå…­', 'é’±ä¸ƒ', 'å­™å…«', 'å‘¨ä¹', 'å´å', 
                          'éƒ‘åä¸€', 'ç‹åäºŒ', 'å†¯åä¸‰', 'é™ˆåå››', 'è¤šåäº”', 'å«åå…­', 'è’‹åä¸ƒ', 
                          'æ²ˆåå…«', 'éŸ©åä¹', 'æ¨äºŒå', 'æœ±äºŒåä¸€', 'ç§¦äºŒåäºŒ'];
        const cities = ['åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·', 'æ·±åœ³', 'æ­å·', 'å—äº¬', 'æ­¦æ±‰', 'æˆéƒ½', 'è¥¿å®‰', 'é‡åº†'];
        const emails = ['@qq.com', '@163.com', '@gmail.com', '@sina.com', '@126.com'];

        function updateStatus(message) {
            document.getElementById('statusBar').textContent = message;
        }

        function addLog(message, type = 'info') {
            const log = document.getElementById('operationLog');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `${new Date().toLocaleTimeString()} - ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        // è®¡ç®—è®°å½•å¤§å°ï¼ˆå­—èŠ‚ï¼‰
        function calculateRecordSize(record) {
            // æ¨¡æ‹ŸçœŸå®åœºæ™¯ï¼šæ¯æ¡è®°å½•çº¦4KBï¼Œè¿™æ ·4æ¡è®°å½•å¡«æ»¡16KBé¡µé¢
            let baseSize = 4000; // åŸºç¡€4KB
            
            // æ·»åŠ ä¸€äº›å˜åŒ–ï¼Œæ¨¡æ‹Ÿä¸åŒè®°å½•çš„å¤§å°å·®å¼‚
            let variableSize = Math.floor(Math.random() * 200) + 50; // 50-250å­—èŠ‚çš„å˜åŒ–
            
            // æ¨¡æ‹ŸåŒ…å«æ›´å¤šå­—æ®µçš„ç”¨æˆ·è¡¨ï¼ˆå¦‚å¤´åƒã€ç®€ä»‹ã€æ‰©å±•ä¿¡æ¯ç­‰ï¼‰
            let totalSize = baseSize + variableSize;
            
            return totalSize;
        }

        let currentId = 1;
        
        function createRecord(id = null) {
            const recordId = id || currentId++;
            const name = userNames[Math.floor(Math.random() * userNames.length)];
            const city = cities[Math.floor(Math.random() * cities.length)];
            const emailPrefix = name.replace(/[^\w]/g, '');
            const emailSuffix = emails[Math.floor(Math.random() * emails.length)];
            
            const record = {
                id: recordId,
                name: name,
                age: 18 + Math.floor(Math.random() * 50),
                email: `${emailPrefix}${Math.floor(Math.random() * 100)}${emailSuffix}`,
                city: city,
                created_time: new Date().toISOString().slice(0, 19).replace('T', ' ')
            };
            
            record.size = calculateRecordSize(record);
            return record;
        }

        async function demonstrateDataStorage() {
            updateStatus('æ¼”ç¤ºæ­¥éª¤1ï¼šæ•°æ®å¦‚ä½•å­˜å‚¨è¿›å…¥Pageï¼ˆ16KBé™åˆ¶ï¼‰');
            addLog('å¼€å§‹æ¼”ç¤ºæ•°æ®å­˜å‚¨è¿›Pageçš„è¿‡ç¨‹', 'info');
            addLog('æ¨¡æ‹Ÿæ’å…¥ç”¨æˆ·è¡¨æ•°æ® (id < 20)...', 'info');
            
            const dataInputArea = document.getElementById('dataInputArea');
            const storagePages = document.getElementById('storagePages');
            
            // æ¸…ç©ºä¹‹å‰çš„å†…å®¹
            dataInputArea.innerHTML = '';
            storagePages.innerHTML = '';
            
            // æ’å…¥è®°å½• (id 1-10)ï¼Œæ¯æ¡çº¦4KBï¼Œæ¼”ç¤ºé¡µé¢å¡«å……è¿‡ç¨‹
             for (let i = 1; i <= 10; i++) {
                 const newRecord = createRecord(i);
                const recordDiv = document.createElement('div');
                recordDiv.className = 'data-record';
                recordDiv.innerHTML = `
                    <strong>æ–°ç”¨æˆ·è®°å½•</strong><br>
                    ID: ${newRecord.id}<br>
                    å§“å: ${newRecord.name}<br>
                    å¹´é¾„: ${newRecord.age}<br>
                    é‚®ç®±: ${newRecord.email}<br>
                    åŸå¸‚: ${newRecord.city}<br>
                    <small>è®°å½•å¤§å°: ${newRecord.size} å­—èŠ‚</small>
                `;
                dataInputArea.innerHTML = '';
                dataInputArea.appendChild(recordDiv);
                
                addLog(`å‡†å¤‡æ’å…¥è®°å½•: ID=${newRecord.id}, å§“å=${newRecord.name}, å¹´é¾„=${newRecord.age}, åŸå¸‚=${newRecord.city}, å¤§å°=${(newRecord.size/1024).toFixed(1)}KB`, 'info');
                
                recordDiv.classList.add('moving');
                
                await new Promise(resolve => {
                    setTimeout(() => {
                        // æ‰¾åˆ°æˆ–åˆ›å»ºç›®æ ‡Pageï¼ˆè€ƒè™‘16KBé™åˆ¶ï¼‰
                        let targetPage = findAvailablePage(newRecord.size);
                        if (!targetPage) {
                            targetPage = createNewPage();
                            addLog(`âœ¨ åˆ›å»ºæ–°é¡µé¢: Page ${targetPage.id} (16KBå®¹é‡)`, 'success');
                        }
                        
                        targetPage.records.push(newRecord);
                        targetPage.usedSpace += newRecord.size;
                        
                        const usagePercent = ((targetPage.usedSpace / 16384) * 100).toFixed(1);
                         const remainingSpace = 16384 - targetPage.usedSpace;
                         addLog(`âœ… è®°å½•å·²æ’å…¥åˆ° Page ${targetPage.id}ï¼Œä½¿ç”¨ç‡: ${usagePercent}%ï¼Œå‰©ä½™: ${(remainingSpace/1024).toFixed(1)}KB`, 'success');
                        
                        // æ£€æŸ¥é¡µé¢æ˜¯å¦æ¥è¿‘æ»¡è½½
                        if (usagePercent > 80) {
                            addLog(`âš ï¸ Page ${targetPage.id} ä½¿ç”¨ç‡è¶…è¿‡80%ï¼Œæ¥è¿‘æ»¡è½½`, 'warning');
                        }
                        
                        // æ¸²æŸ“Page
                        renderStoragePages();
                        updateStatus(`æ•°æ®å·²æˆåŠŸå­˜å‚¨åˆ°Page ${targetPage.id}ï¼Œå‰©ä½™ç©ºé—´${(remainingSpace/1024).toFixed(1)}KB`);
                        resolve();
                    }, 800);
                });
            }
            
            addLog('ğŸ‰ æ•°æ®å­˜å‚¨æ¼”ç¤ºå®Œæˆï¼', 'success');
            addLog(`ğŸ“Š æ€»è®¡åˆ›å»ºäº† ${pages.length} ä¸ªé¡µé¢ï¼Œå­˜å‚¨äº† ${pages.reduce((total, page) => total + page.records.length, 0)} æ¡è®°å½•`, 'info');
        }

        function findAvailablePage(recordSize) {
            // é¡µé¢å¼€é”€1KBï¼Œå®é™…å¯ç”¨ç©ºé—´15KBï¼Œæ¯æ¡è®°å½•çº¦4KBï¼Œæ‰€ä»¥æ¯é¡µçº¦èƒ½å­˜3-4æ¡è®°å½•
            return pages.find(page => (page.usedSpace + recordSize) <= 15360); // 16KB - 1KBå¼€é”€ = 15KBå¯ç”¨
        }

        function createNewPage() {
            const newPage = {
                id: pageId++,
                records: [],
                type: 'leaf',
                usedSpace: 1024 // 1KBé¡µé¢ç®¡ç†å¼€é”€ï¼ˆé¡µå¤´ã€é¡µå°¾ã€æ§½ç›®å½•ç­‰ï¼‰
            };
            pages.push(newPage);
            return newPage;
        }

        function renderStoragePages() {
            const container = document.getElementById('storagePages');
            container.innerHTML = '';
            
            pages.forEach(page => {
                const pageDiv = document.createElement('div');
                pageDiv.className = `page ${page.type}`;
                
                const header = document.createElement('div');
                header.className = 'page-header';
                const usagePercent = ((page.usedSpace / 16384) * 100).toFixed(1);
                header.innerHTML = `
                    Page ${page.id} (${usagePercent}% å·²ä½¿ç”¨)<br>
                    <small>${page.usedSpace}/16384 å­—èŠ‚</small>
                `;
                pageDiv.appendChild(header);
                
                // æ˜¾ç¤ºè®°å½•
                page.records.forEach((record, index) => {
                    const recordDiv = document.createElement('div');
                    recordDiv.className = 'record';
                    if (index === page.records.length - 1) {
                        recordDiv.classList.add('new');
                    }
                    recordDiv.innerHTML = `
                        <strong>ID:${record.id}</strong> ${record.name}<br>
                        <small>${record.age}å² ${record.city} (${record.size}B)</small>
                    `;
                    pageDiv.appendChild(recordDiv);
                });
                
                // æ˜¾ç¤ºå‰©ä½™ç©ºé—´
                const remainingSpace = 15360 - (page.usedSpace - 1024); // å¯ç”¨ç©ºé—´ - å·²ç”¨æ•°æ®ç©ºé—´
                const freeSpaceDiv = document.createElement('div');
                freeSpaceDiv.className = 'record';
                freeSpaceDiv.style.background = '#f0f8ff';
                freeSpaceDiv.style.borderColor = '#87ceeb';
                freeSpaceDiv.innerHTML = `
                    <small>å‰©ä½™ç©ºé—´: ${remainingSpace} å­—èŠ‚</small><br>
                    <small>çº¦å¯å­˜å‚¨ ${Math.floor(remainingSpace / 4000)} æ¡è®°å½• (4KB/æ¡)</small>
                `;
                pageDiv.appendChild(freeSpaceDiv);
                
                container.appendChild(pageDiv);
            });
        }

        function demonstratePageConnection() {
            updateStatus('æ¼”ç¤ºæ­¥éª¤2ï¼šPageå¦‚ä½•è¿æ¥å½¢æˆB+æ ‘ç»“æ„');
            addLog('å¼€å§‹æ¼”ç¤ºPageè¿æ¥æˆB+æ ‘çš„è¿‡ç¨‹', 'info');
            
            if (pages.length === 0) {
                addLog('è¯·å…ˆæ‰§è¡Œæ­¥éª¤1ï¼šæ•°æ®å­˜å‚¨è¿›Page', 'warning');
                return;
            }
            
            const btreeStructure = document.getElementById('btreeStructure');
            btreeStructure.innerHTML = '';
            
            // åˆ›å»ºæ ¹èŠ‚ç‚¹
            const rootLevel = document.createElement('div');
            rootLevel.className = 'btree-level';
            
            const rootPage = document.createElement('div');
            rootPage.className = 'page root';
            rootPage.innerHTML = `
                <div class="page-header">Root Page</div>
                <div class="record">ç´¢å¼•æŒ‡é’ˆ â†’ Page 1-${pages.length}</div>
            `;
            rootLevel.appendChild(rootPage);
            btreeStructure.appendChild(rootLevel);
            
            addLog('åˆ›å»ºæ ¹èŠ‚ç‚¹Pageï¼ŒåŒ…å«æŒ‡å‘å¶å­èŠ‚ç‚¹çš„ç´¢å¼•æŒ‡é’ˆ', 'success');
            
            // è¿æ¥çº¿
            const connectionLine = document.createElement('div');
            connectionLine.className = 'connection-line';
            btreeStructure.appendChild(connectionLine);
            
            // å¶å­èŠ‚ç‚¹å±‚
            const leafLevel = document.createElement('div');
            leafLevel.className = 'btree-level';
            
            pages.forEach((page, index) => {
                const pageDiv = document.createElement('div');
                pageDiv.className = 'page leaf';
                
                const header = document.createElement('div');
                header.className = 'page-header';
                header.innerHTML = `Leaf Page ${page.id} (${Math.floor((page.usedSpace/16384)*100)}%æ»¡)`;
                pageDiv.appendChild(header);
                
                page.records.forEach(record => {
                    const recordDiv = document.createElement('div');
                    recordDiv.className = 'record';
                    recordDiv.innerHTML = `ID:${record.id} ${record.name} (${(record.size/1024).toFixed(1)}KB)`;
                    pageDiv.appendChild(recordDiv);
                });
                
                // æ·»åŠ æŒ‡å‘ä¸‹ä¸€ä¸ªé¡µé¢çš„æŒ‡é’ˆ
                if (index < pages.length - 1) {
                    const pointer = document.createElement('div');
                    pointer.className = 'record';
                    pointer.style.background = '#ffe6e6';
                    pointer.innerHTML = `â†’ Page ${pages[index + 1].id}`;
                    pageDiv.appendChild(pointer);
                }
                
                leafLevel.appendChild(pageDiv);
            });
            
            btreeStructure.appendChild(leafLevel);
            addLog(`åˆ›å»º${pages.length}ä¸ªå¶å­èŠ‚ç‚¹Pageï¼Œå¹¶å»ºç«‹è¿æ¥æŒ‡é’ˆ`, 'success');
            updateStatus('B+æ ‘ç»“æ„æ„å»ºå®Œæˆï¼ŒPageä¹‹é—´å·²å»ºç«‹è¿æ¥');
        }
        
        // æ·»åŠ æŸ¥è¯¢æ¼”ç¤ºåŠŸèƒ½
        async function demonstrateQuery() {
            updateStatus('æ¼”ç¤ºæ­¥éª¤4ï¼šæ¨¡æ‹ŸæŸ¥è¯¢æ“ä½œ - ä»ç£ç›˜è¯»å–é¡µé¢åˆ°Buffer Pool');
            addLog('å¼€å§‹æ¼”ç¤ºæŸ¥è¯¢æ“ä½œ...', 'info');
            
            if (pages.length === 0) {
                addLog('æ²¡æœ‰æ•°æ®å¯æŸ¥è¯¢ï¼Œè¯·å…ˆæ‰§è¡Œæ•°æ®å­˜å‚¨æ¼”ç¤º', 'warning');
                return;
            }
            
            // æ¨¡æ‹ŸæŸ¥è¯¢ä¸åŒçš„è®°å½•
            const queryIds = [1, 5, 10, 15];
            
            for (const queryId of queryIds) {
                addLog(`ğŸ” æŸ¥è¯¢ ID=${queryId} çš„è®°å½•...`, 'info');
                
                // æŸ¥æ‰¾åŒ…å«è¯¥è®°å½•çš„é¡µé¢
                let targetPage = null;
                for (const page of pages) {
                    if (page.records.some(record => record.id === queryId)) {
                        targetPage = page;
                        break;
                    }
                }
                
                if (targetPage) {
                    addLog(`ğŸ“– åœ¨ Page ${targetPage.id} ä¸­æ‰¾åˆ°è®°å½•`, 'info');
                    
                    // æ¨¡æ‹Ÿä»ç£ç›˜è¯»å–é¡µé¢åˆ°Buffer Pool
                    addLog(`ğŸ’¾ ä»ç£ç›˜è¯»å– Page ${targetPage.id} (16KB) åˆ° Buffer Pool...`, 'info');
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    const record = targetPage.records.find(r => r.id === queryId);
                    if (record) {
                        addLog(`âœ… æŸ¥è¯¢æˆåŠŸï¼šID=${record.id}, å§“å=${record.name}, å¹´é¾„=${record.age}, åŸå¸‚=${record.city}`, 'success');
                        addLog(`ğŸ“Š é¡µé¢ä¿¡æ¯ï¼šPage ${targetPage.id}, ä½¿ç”¨ç‡${Math.floor((targetPage.usedSpace/16384)*100)}%, åŒ…å«${targetPage.records.length}æ¡è®°å½•`, 'info');
                    }
                } else {
                    addLog(`âŒ æœªæ‰¾åˆ° ID=${queryId} çš„è®°å½•`, 'warning');
                }
                
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
            
            addLog('ğŸ‰ æŸ¥è¯¢æ¼”ç¤ºå®Œæˆï¼', 'success');
            updateStatus('æŸ¥è¯¢æ¼”ç¤ºå®Œæˆ - å±•ç¤ºäº†é¡µé¢ä»ç£ç›˜åˆ°Buffer Poolçš„è¯»å–è¿‡ç¨‹');
        }

        // å…¨å±€å˜é‡ç”¨äºè·Ÿè¸ªæ“ä½œçŠ¶æ€
        let isOperationRunning = false;
        let currentOperation = null;

        // å¯åŠ¨ç£ç›˜åˆ°Buffer Poolçš„æ¼”ç¤º
        async function startDiskToBufferDemo() {
            if (isOperationRunning) {
                addLog('âš ï¸ æ“ä½œæ­£åœ¨è¿›è¡Œä¸­ï¼Œè¯·ç­‰å¾…å®Œæˆ', 'warning');
                return;
            }
            
            if (pages.length === 0) {
                addLog('è¯·å…ˆæ‰§è¡Œå‰é¢çš„æ­¥éª¤åˆ›å»ºPage', 'warning');
                return;
            }
            
            isOperationRunning = true;
            currentOperation = 'read';
            updateOperationStatus('ğŸ”„', 'æ­£åœ¨æ‰§è¡Œç£ç›˜è¯»å–æ“ä½œ...');
            
            try {
                await demonstrateDiskToBuffer();
            } finally {
                isOperationRunning = false;
                currentOperation = null;
                updateOperationStatus('âœ…', 'ç£ç›˜è¯»å–æ“ä½œå®Œæˆ');
            }
        }

        // å¯åŠ¨Buffer Poolåˆ°ç£ç›˜çš„æ¼”ç¤º
        async function startBufferToDiskDemo() {
            if (isOperationRunning) {
                addLog('âš ï¸ æ“ä½œæ­£åœ¨è¿›è¡Œä¸­ï¼Œè¯·ç­‰å¾…å®Œæˆ', 'warning');
                return;
            }
            
            if (bufferPoolManager.flushList.length === 0) {
                addLog('âš ï¸ Buffer Poolä¸­æ²¡æœ‰è„é¡µï¼Œå…ˆæ‰§è¡Œè¯»å–æ“ä½œæˆ–åˆ›å»ºè„é¡µ', 'warning');
                return;
            }
            
            isOperationRunning = true;
            currentOperation = 'write';
            updateOperationStatus('ğŸ”„', 'æ­£åœ¨æ‰§è¡ŒBuffer Poolå†™å›æ“ä½œ...');
            
            try {
                await demonstrateBufferToDisk();
            } finally {
                isOperationRunning = false;
                currentOperation = null;
                updateOperationStatus('âœ…', 'Buffer Poolå†™å›æ“ä½œå®Œæˆ');
            }
        }

        // é‡ç½®æ¼”ç¤º
        function resetDemo() {
            if (isOperationRunning) {
                addLog('âš ï¸ æ“ä½œæ­£åœ¨è¿›è¡Œä¸­ï¼Œæ— æ³•é‡ç½®', 'warning');
                return;
            }
            
            // é‡ç½®æ‰€æœ‰çŠ¶æ€
            resetAllSteps();
            resetFlowAnimations();
            
            // é‡ç½®Buffer Poolç®¡ç†å™¨
            bufferPoolManager.usedPages = 0;
            bufferPoolManager.hitCount = 0;
            bufferPoolManager.missCount = 0;
            bufferPoolManager.lruList = [];
            bufferPoolManager.flushList = [];
            
            // é‡ç½®ç»Ÿè®¡æ•°æ®
            document.getElementById('poolReadCount').textContent = '0';
            document.getElementById('poolWriteCount').textContent = '0';
            document.getElementById('poolDirtyCount').textContent = '0';
            document.getElementById('poolUsedSize').textContent = '0MB';
            document.getElementById('poolHitRate').textContent = '0%';
            
            // é‡ç½®ç£ç›˜çŠ¶æ€
            document.getElementById('currentTrack').textContent = '0';
            document.getElementById('currentSector').textContent = '0';
            document.getElementById('seekTime').textContent = '0ms';
            document.getElementById('rotationDelay').textContent = '0ms';
            document.getElementById('transferTime').textContent = '0ms';
            document.getElementById('totalIOTime').textContent = '0ms';
            
            // é‡æ–°åˆå§‹åŒ–
            initializeDiskStructure();
            initializeBufferPool();
            
            updateOperationStatus('â¸ï¸', 'ç­‰å¾…æ“ä½œ...');
            addLog('ğŸ”„ æ¼”ç¤ºå·²é‡ç½®', 'info');
        }

        // æ›´æ–°æ“ä½œçŠ¶æ€
        function updateOperationStatus(indicator, text) {
            document.getElementById('statusIndicator').textContent = indicator;
            document.getElementById('statusText').textContent = text;
        }

        // é‡ç½®æ‰€æœ‰æ­¥éª¤çŠ¶æ€
        function resetAllSteps() {
            // é‡ç½®è¯»å–æµç¨‹æ­¥éª¤
            for (let i = 1; i <= 5; i++) {
                const step = document.getElementById(`read-step-${i}`);
                if (step) {
                    step.classList.remove('active', 'completed');
                    const status = step.querySelector('.step-status');
                    if (status) status.textContent = 'å¾…æ‰§è¡Œ';
                }
            }
            
            // é‡ç½®å†™å…¥æµç¨‹æ­¥éª¤
            for (let i = 1; i <= 5; i++) {
                const step = document.getElementById(`write-step-${i}`);
                if (step) {
                    step.classList.remove('active', 'completed');
                    const status = step.querySelector('.step-status');
                    if (status) status.textContent = 'å¾…æ‰§è¡Œ';
                }
            }
            
            // é‡ç½®è¿›åº¦æŒ‡ç¤ºå™¨
            const progressSteps = ['seek-progress', 'rotation-progress', 'io-progress', 'transfer-progress',
                                 'cache-check-progress', 'page-manage-progress', 'lru-update-progress'];
            progressSteps.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.classList.remove('active', 'completed');
                    const status = element.querySelector('.progress-status');
                    if (status) status.textContent = 'å¾…æ‰§è¡Œ';
                }
            });
        }

        // é‡ç½®æµåŠ¨åŠ¨ç”»
        function resetFlowAnimations() {
            const readFlow = document.getElementById('readDataFlow');
            const writeFlow = document.getElementById('writeDataFlow');
            const flowLabel = document.getElementById('flowLabel');
            
            if (readFlow) readFlow.classList.remove('active');
            if (writeFlow) writeFlow.classList.remove('active');
            if (flowLabel) flowLabel.textContent = 'ç­‰å¾…æ“ä½œ...';
        }

        async function demonstrateDiskToBuffer() {
            addLog('ğŸš€ å¼€å§‹æ¼”ç¤ºç£ç›˜ç‰©ç†ç»“æ„è¯»å–åˆ°Buffer Poolçš„å®Œæ•´è¿‡ç¨‹', 'info');
            
            // åˆå§‹åŒ–ç£ç›˜ç‰©ç†ç»“æ„å’ŒBuffer Pool
            initializeDiskStructure();
            initializeBufferPool();
            
            // æ¿€æ´»è¯»å–æµç¨‹å’ŒæµåŠ¨åŠ¨ç”»
            const readFlow = document.getElementById('readDataFlow');
            const flowLabel = document.getElementById('flowLabel');
            if (readFlow) readFlow.classList.add('active');
            if (flowLabel) flowLabel.textContent = 'ğŸ“– ç£ç›˜ â†’ Buffer Pool';
            
            // è·å–è¯»å–æµç¨‹æ­¥éª¤å…ƒç´ 
            const readSteps = [
                document.getElementById('read-step-1'),
                document.getElementById('read-step-2'),
                document.getElementById('read-step-3'),
                document.getElementById('read-step-4'),
                document.getElementById('read-step-5')
            ];
            
            // è·å–è¿›åº¦æŒ‡ç¤ºå™¨å…ƒç´ 
            const progressSteps = [
                document.getElementById('seek-progress'),
                document.getElementById('rotation-progress'),
                document.getElementById('io-progress'),
                document.getElementById('transfer-progress')
            ];
            
            const bufferProgressSteps = [
                document.getElementById('cache-check-progress'),
                document.getElementById('page-manage-progress'),
                document.getElementById('lru-update-progress')
            ];
            
            // æ¨¡æ‹ŸæŸ¥è¯¢è¯·æ±‚
            const pageToQuery = pages[0];
            const randomId = pageToQuery.records.length > 0 ? 
                pageToQuery.records[Math.floor(Math.random() * pageToQuery.records.length)].id : 1;
            
            // æ­¥éª¤1ï¼šSQLæŸ¥è¯¢è¯·æ±‚
            await updateReadStep(1, 'active', 'æ‰§è¡Œä¸­');
            addLog(`ğŸ“ æ”¶åˆ°SQLæŸ¥è¯¢: SELECT * FROM users WHERE id = ${randomId}`, 'info');
            await sleep(1500);
            await updateReadStep(1, 'completed', 'å®Œæˆ');
            
            // æ­¥éª¤2ï¼šBuffer Poolæ£€æŸ¥
            await updateReadStep(2, 'active', 'æ£€æŸ¥ä¸­');
            await updateProgressStep('cache-check-progress', 'active', 'æ£€æŸ¥ä¸­');
            addLog(`ğŸ” æ£€æŸ¥Buffer Poolç¼“å­˜...`, 'info');
            await sleep(1000);
            
            // æ£€æŸ¥LRUé“¾è¡¨ä¸­æ˜¯å¦æœ‰è¯¥é¡µé¢
            const bufferPage = bufferPoolManager.lruList.find(page => page.id === pageToQuery.id);
            
            if (bufferPage) {
                // ç¼“å­˜å‘½ä¸­
                bufferPoolManager.hitCount++;
                addLog(`âœ… Buffer Poolç¼“å­˜å‘½ä¸­ï¼Page ${pageToQuery.id} å·²åœ¨LRUé“¾è¡¨ä¸­`, 'success');
                
                await updateReadStep(2, 'completed', 'å‘½ä¸­');
                await updateProgressStep('cache-check-progress', 'completed', 'å‘½ä¸­');
                
                // æ›´æ–°ç»Ÿè®¡
                updateBufferPoolStats();
                
                // å°†é¡µé¢ç§»åˆ°LRUé“¾è¡¨å¤´éƒ¨
                const pageIndex = bufferPoolManager.lruList.indexOf(bufferPage);
                bufferPoolManager.lruList.splice(pageIndex, 1);
                bufferPoolManager.lruList.unshift(bufferPage);
                renderBufferPoolStructure();
                
                addLog(`ğŸ”„ é¡µé¢å·²ç§»è‡³LRUé“¾è¡¨å¤´éƒ¨`, 'info');
                
                // æ˜¾ç¤ºæŸ¥è¯¢ç»“æœ
                const record = pageToQuery.records.find(r => r.id === randomId);
                if (record) {
                    addLog(`ğŸ“Š æŸ¥è¯¢ç»“æœ: ID=${record.id}, å§“å=${record.name}, å¹´é¾„=${record.age}, åŸå¸‚=${record.city}`, 'success');
                }
            } else {
                // ç¼“å­˜æœªå‘½ä¸­ï¼Œéœ€è¦ä»ç£ç›˜è¯»å–
                bufferPoolManager.missCount++;
                addLog(`âš ï¸ Buffer Poolç¼“å­˜æœªå‘½ä¸­ï¼éœ€è¦ä»ç£ç›˜è¯»å–Page ${pageToQuery.id}`, 'warning');
                
                await updateReadStep(2, 'completed', 'æœªå‘½ä¸­');
                await updateProgressStep('cache-check-progress', 'completed', 'æœªå‘½ä¸­');
                
                // æ­¥éª¤3ï¼šç£ç›˜å¯»å€
                await updateReadStep(3, 'active', 'å¯»å€ä¸­');
                await updateProgressStep('seek-progress', 'active', 'å¯»å€ä¸­');
                
                // æ‰¾åˆ°é¡µé¢å¯¹åº”çš„æ‰‡åŒº
                const pageSector = diskStructure.sectors.find(sector => sector.pageId === pageToQuery.id);
                if (!pageSector) {
                    addLog(`âŒ æœªæ‰¾åˆ°Page ${pageToQuery.id}å¯¹åº”çš„ç£ç›˜æ‰‡åŒº`, 'error');
                    return;
                }
                
                const targetTrack = pageSector.track;
                const targetSector = pageSector.sector;
                
                addLog(`ğŸ’¿ ç£ç›˜å¯»å€ - Page ${pageToQuery.id} ä½äºç£é“${targetTrack}æ‰‡åŒº${targetSector}`, 'info');
                
                // æ¨¡æ‹Ÿç£ç›˜å¯»å€æ—¶é—´
                const seekTime = await simulateDiskSeek(targetTrack, targetSector);
                addLog(`âš™ï¸ ç£å¤´ç§»åŠ¨å®Œæˆï¼Œå¯»å€è€—æ—¶: ${seekTime.toFixed(1)}ms`, 'info');
                
                await updateReadStep(3, 'completed', 'å®Œæˆ');
                await updateProgressStep('seek-progress', 'completed', 'å®Œæˆ');
                
                // æ­¥éª¤4ï¼šç£ç›˜è¯»å–
                await updateReadStep(4, 'active', 'è¯»å–ä¸­');
                await updateProgressStep('io-progress', 'active', 'è¯»å–ä¸­');
                
                addLog(`ğŸ”„ å¼€å§‹è¯»å–æ‰‡åŒºæ•°æ® (16KBé¡µé¢)`, 'info');
                
                // é«˜äº®ç›®æ ‡æ‰‡åŒº
                pageSector.element.classList.add('reading');
                
                // æ¨¡æ‹Ÿè¯»å–è¿›åº¦
                for (let progress = 30; progress <= 80; progress += 10) {
                    addLog(`ğŸ“Š è¯»å–è¿›åº¦ï¼š${progress}% (å·²è¯»å– ${(16 * progress / 100).toFixed(1)}KB)`, 'info');
                    await sleep(300);
                }
                
                pageSector.element.classList.remove('reading');
                pageSector.element.classList.add('completed');
                
                await updateReadStep(4, 'completed', 'å®Œæˆ');
                await updateProgressStep('io-progress', 'completed', 'å®Œæˆ');
                
                // æ­¥éª¤5ï¼šåŠ è½½åˆ°Buffer Pool
                await updateReadStep(5, 'active', 'åŠ è½½ä¸­');
                await updateProgressStep('page-manage-progress', 'active', 'åŠ è½½ä¸­');
                
                addLog(`ğŸ“¤ é€šè¿‡DMAä¼ è¾“æ•°æ®åˆ°å†…å­˜`, 'info');
                await sleep(1000);
                
                addLog(`ğŸ¯ å°†é¡µé¢æ·»åŠ åˆ°Buffer Pool`, 'info');
                
                // æ·»åŠ åˆ°Buffer Pool
                const success = addPageToBufferPool(pageToQuery);
                if (success) {
                    const totalIOTime = seekTime + 15;
                    addLog(`âœ… Page ${pageToQuery.id} å·²æˆåŠŸåŠ è½½åˆ°Buffer Pool`, 'success');
                    addLog(`â±ï¸ æ€»I/Oè€—æ—¶ï¼šçº¦${totalIOTime.toFixed(1)}ms (å¯»å€+è¯»å–+ä¼ è¾“)`, 'info');
                    
                    // æ›´æ–°ç»Ÿè®¡
                    updateBufferPoolStats();
                    updateDiskStats(seekTime, totalIOTime);
                    
                    await updateReadStep(5, 'completed', 'å®Œæˆ');
                    await updateProgressStep('page-manage-progress', 'completed', 'å®Œæˆ');
                    await updateProgressStep('lru-update-progress', 'completed', 'LRUæ›´æ–°');
                    
                    // é¡µå†…è®°å½•æŸ¥æ‰¾
                    addLog(`ğŸ” åœ¨Page ${pageToQuery.id}å†…æŸ¥æ‰¾è®°å½•ID=${randomId}`, 'info');
                    await sleep(500);
                    
                    // æ˜¾ç¤ºæŸ¥è¯¢ç»“æœ
                    const record = pageToQuery.records.find(r => r.id === randomId);
                    if (record) {
                        addLog(`ğŸ“Š æŸ¥è¯¢ç»“æœ: ID=${record.id}, å§“å=${record.name}, å¹´é¾„=${record.age}, åŸå¸‚=${record.city}`, 'success');
                        addLog(`ğŸ“ˆ é¡µé¢ç»Ÿè®¡: ä½¿ç”¨ç‡${Math.floor((pageToQuery.usedSpace/16384)*100)}%, åŒ…å«${pageToQuery.records.length}æ¡è®°å½•`, 'info');
                    } else {
                        addLog(`âŒ åœ¨Page ${pageToQuery.id}ä¸­æœªæ‰¾åˆ°ID=${randomId}çš„è®°å½•`, 'warning');
                    }
                }
            }
            
            // æ€»ç»“
            addLog('ğŸ‰ ç£ç›˜ç‰©ç†ç»“æ„åˆ°Buffer Poolè¯»å–æ¼”ç¤ºå®Œæˆï¼', 'success');
            addLog(`ğŸ“ˆ Buffer Poolç»Ÿè®¡: å‘½ä¸­${bufferPoolManager.hitCount}æ¬¡, æœªå‘½ä¸­${bufferPoolManager.missCount}æ¬¡`, 'info');
            addLog(`ğŸ’¾ LRUé“¾è¡¨åŒ…å« ${bufferPoolManager.lruList.length} ä¸ªé¡µé¢`, 'info');
        }

        // Buffer Poolåˆ°ç£ç›˜çš„æ¼”ç¤ºå‡½æ•°
        async function demonstrateBufferToDisk() {
            addLog('ğŸš€ å¼€å§‹æ¼”ç¤ºBuffer Poolå†™å›ç£ç›˜çš„å®Œæ•´è¿‡ç¨‹', 'info');
            
            // æ¿€æ´»å†™å…¥æµç¨‹å’ŒæµåŠ¨åŠ¨ç”»
            const writeFlow = document.getElementById('writeDataFlow');
            const flowLabel = document.getElementById('flowLabel');
            if (writeFlow) writeFlow.classList.add('active');
            if (flowLabel) flowLabel.textContent = 'ğŸ’¾ Buffer Pool â†’ ç£ç›˜';
            
            // è·å–ä¸€ä¸ªè„é¡µè¿›è¡Œå†™å›
            const dirtyPage = bufferPoolManager.flushList[0];
            if (!dirtyPage) {
                addLog('âš ï¸ æ²¡æœ‰è„é¡µéœ€è¦å†™å›', 'warning');
                return;
            }
            
            // æ­¥éª¤1ï¼šæ£€æŸ¥è„é¡µ
            await updateWriteStep(1, 'active', 'æ£€æŸ¥ä¸­');
            addLog(`ğŸ” æ£€æŸ¥è„é¡µ: Page ${dirtyPage.id}`, 'info');
            await sleep(1000);
            await updateWriteStep(1, 'completed', 'å®Œæˆ');
            
            // æ­¥éª¤2ï¼šå‡†å¤‡å†™å›
            await updateWriteStep(2, 'active', 'å‡†å¤‡ä¸­');
            addLog(`ğŸ“ å‡†å¤‡å†™å›Page ${dirtyPage.id}åˆ°ç£ç›˜`, 'info');
            await sleep(800);
            await updateWriteStep(2, 'completed', 'å®Œæˆ');
            
            // æ­¥éª¤3ï¼šç£ç›˜å¯»å€
            await updateWriteStep(3, 'active', 'å¯»å€ä¸­');
            const pageSector = diskStructure.sectors.find(sector => sector.pageId === dirtyPage.id);
            if (pageSector) {
                addLog(`ğŸ’¿ ç£ç›˜å¯»å€ - Page ${dirtyPage.id} ä½äºç£é“${pageSector.track}æ‰‡åŒº${pageSector.sector}`, 'info');
                const seekTime = await simulateDiskSeek(pageSector.track, pageSector.sector);
                addLog(`âš™ï¸ ç£å¤´ç§»åŠ¨å®Œæˆï¼Œå¯»å€è€—æ—¶: ${seekTime.toFixed(1)}ms`, 'info');
            }
            await updateWriteStep(3, 'completed', 'å®Œæˆ');
            
            // æ­¥éª¤4ï¼šå†™å…¥ç£ç›˜
            await updateWriteStep(4, 'active', 'å†™å…¥ä¸­');
            addLog(`ğŸ’¾ å¼€å§‹å†™å…¥Page ${dirtyPage.id}åˆ°ç£ç›˜æ‰‡åŒº`, 'info');
            
            if (pageSector) {
                pageSector.element.classList.add('writing');
                
                // æ¨¡æ‹Ÿå†™å…¥è¿›åº¦
                for (let progress = 0; progress <= 100; progress += 20) {
                    addLog(`ğŸ“Š å†™å…¥è¿›åº¦ï¼š${progress}% (å·²å†™å…¥ ${(16 * progress / 100).toFixed(1)}KB)`, 'info');
                    await sleep(300);
                }
                
                pageSector.element.classList.remove('writing');
                pageSector.element.classList.add('written');
            }
            
            await updateWriteStep(4, 'completed', 'å®Œæˆ');
            
            // æ­¥éª¤5ï¼šæ›´æ–°çŠ¶æ€
            await updateWriteStep(5, 'active', 'æ›´æ–°ä¸­');
            addLog(`ğŸ”„ æ›´æ–°Buffer PoolçŠ¶æ€`, 'info');
            
            // ä»Flushé“¾è¡¨ä¸­ç§»é™¤
            const flushIndex = bufferPoolManager.flushList.indexOf(dirtyPage);
            if (flushIndex > -1) {
                bufferPoolManager.flushList.splice(flushIndex, 1);
            }
            
            // æ ‡è®°ä¸ºéè„é¡µ
            dirtyPage.isDirty = false;
            
            addLog(`âœ… Page ${dirtyPage.id} å·²æˆåŠŸå†™å›ç£ç›˜`, 'success');
            updateBufferPoolStats();
            
            await updateWriteStep(5, 'completed', 'å®Œæˆ');
            
            // æ¸…ç†æ‰‡åŒºçŠ¶æ€
            if (pageSector) {
                setTimeout(() => {
                    pageSector.element.classList.remove('written');
                }, 3000);
            }
            
            addLog('ğŸ‰ Buffer Poolå†™å›ç£ç›˜æ¼”ç¤ºå®Œæˆï¼', 'success');
        }

        // è¾…åŠ©å‡½æ•°ï¼šæ›´æ–°è¯»å–æµç¨‹æ­¥éª¤
        async function updateReadStep(stepNum, status, text) {
            const step = document.getElementById(`read-step-${stepNum}`);
            if (step) {
                step.classList.remove('active', 'completed');
                step.classList.add(status);
                const statusElement = step.querySelector('.step-status');
                if (statusElement) statusElement.textContent = text;
            }
        }

        // è¾…åŠ©å‡½æ•°ï¼šæ›´æ–°å†™å…¥æµç¨‹æ­¥éª¤
        async function updateWriteStep(stepNum, status, text) {
            const step = document.getElementById(`write-step-${stepNum}`);
            if (step) {
                step.classList.remove('active', 'completed');
                step.classList.add(status);
                const statusElement = step.querySelector('.step-status');
                if (statusElement) statusElement.textContent = text;
            }
        }

        // è¾…åŠ©å‡½æ•°ï¼šæ›´æ–°è¿›åº¦æ­¥éª¤
        async function updateProgressStep(stepId, status, text) {
            const step = document.getElementById(stepId);
            if (step) {
                step.classList.remove('active', 'completed');
                step.classList.add(status);
                const statusElement = step.querySelector('.progress-status');
                if (statusElement) statusElement.textContent = text;
            }
        }

        // è¾…åŠ©å‡½æ•°ï¼šæ›´æ–°Buffer Poolç»Ÿè®¡
        function updateBufferPoolStats() {
            document.getElementById('poolReadCount').textContent = bufferPoolManager.hitCount + bufferPoolManager.missCount;
            document.getElementById('poolWriteCount').textContent = bufferPoolManager.flushList.length;
            document.getElementById('poolDirtyCount').textContent = bufferPoolManager.flushList.length;
            document.getElementById('poolUsedSize').textContent = Math.round(bufferPoolManager.usedPages * 16 / 1024) + 'MB';
            
            const totalAccess = bufferPoolManager.hitCount + bufferPoolManager.missCount;
            const hitRate = totalAccess > 0 ? Math.round((bufferPoolManager.hitCount / totalAccess) * 100) : 0;
            document.getElementById('poolHitRate').textContent = hitRate + '%';
        }

        // è¾…åŠ©å‡½æ•°ï¼šæ›´æ–°ç£ç›˜ç»Ÿè®¡
        function updateDiskStats(seekTime = 0, totalTime = 0) {
            document.getElementById('seekTime').textContent = seekTime.toFixed(1) + 'ms';
            document.getElementById('rotationDelay').textContent = '4.2ms';
            document.getElementById('transferTime').textContent = '10.8ms';
            document.getElementById('totalIOTime').textContent = totalTime.toFixed(1) + 'ms';
        }





        function renderDiskPages() {
            const container = document.getElementById('diskPages');
            container.innerHTML = '';
            
            pages.forEach(page => {
                const pageDiv = document.createElement('div');
                pageDiv.className = `page ${page.type}`;
                pageDiv.setAttribute('data-page-id', page.id);
                
                const header = document.createElement('div');
                header.className = 'page-header';
                header.textContent = `Page ${page.id}`;
                pageDiv.appendChild(header);
                
                page.records.forEach(record => {
                    const recordDiv = document.createElement('div');
                    recordDiv.className = 'record';
                    recordDiv.innerHTML = `ID:${record.id}`;
                    pageDiv.appendChild(recordDiv);
                });
                
                container.appendChild(pageDiv);
            });
        }

        function renderBufferPoolPages() {
            const container = document.getElementById('bufferPoolPages');
            container.innerHTML = '';
            
            bufferPoolPages.forEach(page => {
                const pageDiv = document.createElement('div');
                pageDiv.className = `page ${page.type}`;
                pageDiv.style.borderColor = '#16a085';
                
                const header = document.createElement('div');
                header.className = 'page-header';
                header.style.background = '#16a085';
                header.textContent = `Page ${page.id} (Buffer)`;
                pageDiv.appendChild(header);
                
                page.records.forEach(record => {
                    const recordDiv = document.createElement('div');
                    recordDiv.className = 'record';
                    recordDiv.innerHTML = `ID:${record.id}`;
                    pageDiv.appendChild(recordDiv);
                });
                
                container.appendChild(pageDiv);
            });
        }

        async function demonstrateComplete() {
            updateStatus('å¼€å§‹å®Œæ•´æ¼”ç¤ºæµç¨‹...');
            addLog('ğŸ¬ å¼€å§‹å®Œæ•´çš„Pageå­˜å‚¨æ¼”ç¤ºæµç¨‹', 'info');
            reset();
            
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // æ­¥éª¤1ï¼šæ•°æ®å­˜å‚¨
            await demonstrateDataStorage();
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // æ­¥éª¤2ï¼šé¡µé¢è¿æ¥
            await demonstratePageConnection();
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // æ­¥éª¤3ï¼šç£ç›˜åˆ°Buffer Pool
            await demonstrateDiskToBuffer();
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // æ­¥éª¤4ï¼šæŸ¥è¯¢æ¼”ç¤º
            await demonstrateQuery();
            
            addLog('ğŸ‰ å®Œæ•´æ¼”ç¤ºæµç¨‹ç»“æŸï¼', 'success');
            updateStatus('å®Œæ•´æ¼”ç¤ºæµç¨‹å·²å®Œæˆ - åŒ…å«æ•°æ®å­˜å‚¨ã€é¡µé¢è¿æ¥ã€ç£ç›˜è¯»å–å’ŒæŸ¥è¯¢æ“ä½œ');
        }

        function reset() {
            recordId = 1;
            pageId = 1;
            pages = [];
            bufferPoolPages = [];
            currentStep = 0;
            
            document.getElementById('dataInputArea').innerHTML = '';
            document.getElementById('storagePages').innerHTML = '';
            document.getElementById('btreeStructure').innerHTML = '';
            document.getElementById('diskPages').innerHTML = '';
            document.getElementById('bufferPoolPages').innerHTML = '';
            document.getElementById('operationLog').innerHTML = '';
            
            updateStatus('æ¼”ç¤ºå·²é‡ç½®ï¼Œå‡†å¤‡å¼€å§‹æ–°çš„å®Œæ•´æ¼”ç¤º');
            addLog('ç³»ç»Ÿå·²é‡ç½®ï¼Œå¯ä»¥å¼€å§‹æ–°çš„æ¼”ç¤º', 'success');
        }







        // é¡µé¢åˆå§‹åŒ–
        function initializePage() {
            // åˆå§‹åŒ–æ“ä½œçŠ¶æ€
            updateOperationStatus('ready', 'ç³»ç»Ÿå°±ç»ªï¼Œè¯·é€‰æ‹©æ“ä½œ');
            
            // åˆå§‹åŒ–ç£ç›˜å’ŒBuffer Pool
            initializeDiskStructure();
            initializeBufferPool();
            
            // é‡ç½®æ‰€æœ‰æ­¥éª¤
            resetAllSteps();
            
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            updateBufferPoolStats();
            updateDiskStats();
            
            addLog('MySQL Pageå­˜å‚¨ç»“æ„å®Œæ•´æ¼”ç¤ºç³»ç»Ÿå·²å¯åŠ¨', 'success');
            updateStatus('ç³»ç»Ÿå°±ç»ªï¼Œç‚¹å‡»æŒ‰é’®å¼€å§‹æ¼”ç¤ºå„ä¸ªæ­¥éª¤');
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializePage();
        });

        // åˆå§‹åŒ–
        initializePage();
    </script>
</body>
</html>