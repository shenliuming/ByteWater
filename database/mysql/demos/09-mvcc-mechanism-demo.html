<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MySQL MVCCæœºåˆ¶å·¥ä½œæµæ¼”ç¤º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .workflow-container {
            padding: 30px;
        }

        .workflow-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .workflow-title {
            font-size: 2em;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .workflow-subtitle {
            color: #6c757d;
            font-size: 1.1em;
        }

        .progress-bar {
            background: #e9ecef;
            height: 8px;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #28a745, #20c997);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
        }

        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            position: relative;
        }

        .step-indicator::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: #e9ecef;
            z-index: 1;
        }

        .step {
            background: white;
            border: 3px solid #e9ecef;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #6c757d;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
        }

        .step.completed {
            background: #28a745;
            border-color: #28a745;
            color: white;
        }

        .step.active {
            background: #007bff;
            border-color: #007bff;
            color: white;
            transform: scale(1.2);
        }

        .step-content {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            border-left: 5px solid #007bff;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .step-title {
            font-size: 1.5em;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .step-description {
            color: #6c757d;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .demo-area {
            background: white;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #e9ecef;
        }

        .mvcc-visualization {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .version-chain-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #28a745;
        }

        .version-chain-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #28a745;
            margin-bottom: 15px;
            text-align: center;
        }

        .version-item {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            position: relative;
            transition: all 0.3s ease;
        }

        .version-item.current {
            border-color: #28a745;
            background: #d4edda;
        }

        .version-item.visible {
            border-color: #007bff;
            background: #d1ecf1;
        }

        .version-item.invisible {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .undo-log-container {
            background: #fff3cd;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #ffc107;
        }

        .undo-log-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #856404;
            margin-bottom: 15px;
            text-align: center;
        }

        .undo-record {
            background: white;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            position: relative;
        }

        .undo-record::after {
            content: 'â†“';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
            color: #856404;
        }

        .undo-record:last-child::after {
            content: 'ğŸ”š';
        }

        .readview-container {
            background: #e7f3ff;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #007bff;
        }

        .readview-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #0056b3;
            margin-bottom: 15px;
            text-align: center;
        }

        .readview-info {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }

        .readview-field {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 5px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .readview-field:last-child {
            border-bottom: none;
        }

        .readview-label {
            font-weight: bold;
            color: #495057;
        }

        .readview-value {
            color: #007bff;
            font-family: monospace;
        }

        .judgment-rules {
            margin-top: 15px;
        }

        .rule-item {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
            margin: 8px 0;
            border-left: 4px solid #6c757d;
        }

        .rule-item.passed {
            border-left-color: #28a745;
            background: #d4edda;
        }

        .rule-item.failed {
            border-left-color: #dc3545;
            background: #f8d7da;
        }

        .rule-item.checking {
            border-left-color: #ffc107;
            background: #fff3cd;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .multi-view-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .view-panel {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #6c757d;
        }

        .view-panel.session-a {
            border-color: #007bff;
        }

        .view-panel.session-b {
            border-color: #28a745;
        }

        .view-panel.session-c {
            border-color: #ffc107;
        }

        .view-title {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .session-a .view-title {
            color: #007bff;
        }

        .session-b .view-title {
            color: #28a745;
        }

        .session-c .view-title {
            color: #856404;
        }

        .view-result {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            font-weight: bold;
        }

        .version-chain-visual {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px 0;
        }

        .version-node {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0 10px;
            font-size: 0.8em;
            transition: all 0.3s ease;
        }

        .version-node.current {
            border-color: #28a745;
            background: #d4edda;
        }

        .version-node.visible {
            border-color: #007bff;
            background: #d1ecf1;
        }

        .version-node.invisible {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .version-arrow {
            font-size: 1.5em;
            color: #6c757d; 
            opacity: 0.6;
        }

        .version-item::after {
            content: 'â†“';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 20px;
            color: #6c757d;
        }

        .version-item:last-child::after {
            display: none;
        }

        .readview-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #007bff;
        }

        .readview-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #007bff;
            margin-bottom: 15px;
            text-align: center;
        }

        .readview-info {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 1px solid #dee2e6;
            font-family: 'Courier New', monospace;
        }

        .transaction-timeline {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #ffc107;
        }

        .timeline-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #ffc107;
            margin-bottom: 15px;
            text-align: center;
        }

        .timeline-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #6c757d;
        }

        .timeline-item.active {
            border-left-color: #007bff;
            background: #d1ecf1;
        }

        .timeline-item.completed {
            border-left-color: #28a745;
            background: #d4edda;
        }

        .timeline-time {
            font-weight: bold;
            color: #495057;
            min-width: 60px;
        }

        .timeline-event {
            margin-left: 15px;
            color: #6c757d;
        }

        .control-panel {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #28a745;
            text-align: center;
        }

        .control-button {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        .control-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .reset-button {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }

        .reset-button:hover {
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
        }

        .scenario-selector {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #007bff;
        }

        .scenario-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            margin: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .scenario-button:hover {
            background: #0056b3;
            transform: translateY(-1px);
        }

        .scenario-button.active {
            background: #28a745;
        }

        .highlight-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            color: #856404;
        }

        .success-box {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            color: #155724;
        }

        .error-box {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            color: #721c24;
        }

        .visibility-rules {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #6f42c1;
        }

        .rules-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #6f42c1;
            margin-bottom: 15px;
            text-align: center;
        }

        .rule-item {
            background: #f8f9fa;
            border-radius: 5px;
            padding: 10px;
            margin: 8px 0;
            border-left: 4px solid #6f42c1;
        }

        .rule-item.checking {
            background: #fff3cd;
            border-left-color: #ffc107;
        }

        .rule-item.passed {
            background: #d4edda;
            border-left-color: #28a745;
        }

        .rule-item.failed {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        /* Undo Logæ ·å¼ */
        .undo-log-container {
            background: #fff8e1;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #ff9800;
        }

        .undo-log-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #ff9800;
            margin-bottom: 15px;
            text-align: center;
        }

        .undo-log-item {
            background: #fff;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #ff9800;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .undo-log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .undo-log-type {
            background: #ff9800;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .undo-log-content {
            font-size: 0.9em;
            line-height: 1.6;
            color: #555;
        }

        /* å¤šè§†å›¾å¯¹æ¯”æ ·å¼ */
        .multi-view-container {
            background: #f3e5f5;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #9c27b0;
        }

        .multi-view-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #9c27b0;
            margin-bottom: 20px;
            text-align: center;
        }

        .view-panels {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .view-panel {
            background: #fff;
            border-radius: 8px;
            padding: 15px;
            border: 2px solid #9c27b0;
            box-shadow: 0 2px 8px rgba(156, 39, 176, 0.1);
        }

        .view-panel-title {
            font-weight: bold;
            color: #9c27b0;
            margin-bottom: 10px;
            text-align: center;
            font-size: 1.1em;
        }

        .view-content {
            min-height: 100px;
        }

        .view-status {
            padding: 8px 12px;
            border-radius: 6px;
            margin-bottom: 10px;
            font-weight: bold;
            text-align: center;
        }

        .view-status.reading {
            background: #e8f5e8;
            color: #2e7d32;
            border: 1px solid #4caf50;
        }

        .view-status.waiting {
            background: #fff3e0;
            color: #f57c00;
            border: 1px solid #ff9800;
        }

        .view-status.completed {
            background: #e3f2fd;
            color: #1976d2;
            border: 1px solid #2196f3;
        }

        .view-data {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .data-section {
            margin-bottom: 15px;
        }

        .data-section h4 {
            margin: 0 0 8px 0;
            font-size: 14px;
            color: #2c3e50;
            border-bottom: 1px solid #ecf0f1;
            padding-bottom: 4px;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            padding: 3px 0;
        }

        .data-label {
            font-weight: 500;
            color: #7f8c8d;
        }

        .data-value {
            font-weight: 600;
            color: #2c3e50;
        }

        .readview-info {
            background: #f8f9fa;
            border-radius: 4px;
            padding: 8px;
        }

        .readview-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
            font-size: 12px;
        }

        .readview-label {
            color: #6c757d;
            font-weight: 500;
        }

        .readview-value {
            color: #495057;
            font-weight: 600;
            font-family: 'Courier New', monospace;
        }

        .no-data {
            text-align: center;
            padding: 20px;
            color: #95a5a6;
        }

        .waiting-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .waiting-text {
            font-size: 14px;
            font-style: italic;
        }

        @media (max-width: 1200px) {
            .mvcc-visualization {
                grid-template-columns: 1fr;
            }
            
            .view-panels {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .control-button {
                display: block;
                margin: 10px auto;
                width: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MySQL MVCCæœºåˆ¶å·¥ä½œæµæ¼”ç¤º</h1>
            <p>é€šè¿‡ç‰ˆæœ¬é“¾å’ŒReadViewï¼Œæ·±å…¥ç†è§£å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶åŸç†</p>
        </div>

        <div class="workflow-container">
            <!-- åœºæ™¯é€‰æ‹©å™¨ -->
            <div class="scenario-selector">
                <h3>é€‰æ‹©æ¼”ç¤ºåœºæ™¯ï¼š</h3>
                <button class="scenario-button active" onclick="selectScenario('basic')">åŸºç¡€ç‰ˆæœ¬é“¾</button>
                <button class="scenario-button" onclick="selectScenario('readview')">ReadViewåˆ¤æ–­</button>
                <button class="scenario-button" onclick="selectScenario('undolog')">Undo Logè¯¦è§£</button>
                <button class="scenario-button" onclick="selectScenario('multiview')">å¤šè§†å›¾å¯¹æ¯”</button>
                <button class="scenario-button" onclick="selectScenario('isolation')">éš”ç¦»çº§åˆ«å¯¹æ¯”</button>
                <button class="scenario-button" onclick="selectScenario('concurrent')">å¹¶å‘è¯»å†™</button>
            </div>

            <!-- å·¥ä½œæµæ ‡é¢˜ -->
            <div class="workflow-header">
                <h2 class="workflow-title" id="workflow-title">åŸºç¡€ç‰ˆæœ¬é“¾æ¼”ç¤º</h2>
                <p class="workflow-subtitle" id="workflow-subtitle">äº†è§£MVCCå¦‚ä½•é€šè¿‡ç‰ˆæœ¬é“¾ç®¡ç†æ•°æ®ç‰ˆæœ¬</p>
            </div>

            <!-- è¿›åº¦æ¡ -->
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>

            <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
            <div class="step-indicator" id="step-indicator">
                <div class="step active" id="step-1">1</div>
                <div class="step" id="step-2">2</div>
                <div class="step" id="step-3">3</div>
                <div class="step" id="step-4">4</div>
                <div class="step" id="step-5">5</div>
            </div>

            <!-- æ§åˆ¶é¢æ¿ -->
            <div class="control-panel">
                <button class="control-button" id="prev-button" onclick="prevStep()" disabled>ä¸Šä¸€æ­¥</button>
                <button class="control-button" id="next-button" onclick="nextStep()">ä¸‹ä¸€æ­¥</button>
                <button class="control-button reset-button" onclick="resetDemo()">é‡ç½®æ¼”ç¤º</button>
            </div>

            <!-- å½“å‰æ­¥éª¤å†…å®¹ -->
            <div class="step-content" id="step-content">
                <!-- æ­¥éª¤å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>

            <!-- MVCCå¯è§†åŒ–åŒºåŸŸ -->
            <div class="mvcc-visualization">
                <!-- ç‰ˆæœ¬é“¾ -->
                <div class="version-chain-container">
                    <div class="version-chain-title">ğŸ“š ç‰ˆæœ¬é“¾</div>
                    <div id="version-chain">
                        <!-- ç‰ˆæœ¬é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- Undo Log -->
                <div class="undo-log-container">
                    <div class="undo-log-title">ğŸ“œ Undo Log</div>
                    <div id="undo-log">
                        <!-- Undo Logè®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- ReadView -->
                <div class="readview-container">
                    <div class="readview-title">ğŸ‘ï¸ ReadView</div>
                    <div id="readview-info">
                        <!-- ReadViewä¿¡æ¯å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>

            <!-- å¤šè§†å›¾å¯¹æ¯”åŒºåŸŸ -->
            <div class="multi-view-container" id="multi-view-container" style="display: none;">
                <div class="multi-view-title">ğŸ”„ å¤šè§†å›¾å¯¹æ¯”</div>
                <div class="view-panels">
                    <div class="view-panel">
                        <div class="view-panel-title">äº‹åŠ¡Aè§†å›¾</div>
                        <div id="view-a" class="view-content">
                            <!-- äº‹åŠ¡Açš„è§†å›¾å†…å®¹ -->
                        </div>
                    </div>
                    <div class="view-panel">
                        <div class="view-panel-title">äº‹åŠ¡Bè§†å›¾</div>
                        <div id="view-b" class="view-content">
                            <!-- äº‹åŠ¡Bçš„è§†å›¾å†…å®¹ -->
                        </div>
                    </div>
                    <div class="view-panel">
                        <div class="view-panel-title">äº‹åŠ¡Cè§†å›¾</div>
                        <div id="view-c" class="view-content">
                            <!-- äº‹åŠ¡Cçš„è§†å›¾å†…å®¹ -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- äº‹åŠ¡æ—¶é—´çº¿ -->
            <div class="transaction-timeline">
                <div class="timeline-title">â° äº‹åŠ¡æ—¶é—´çº¿</div>
                <div id="transaction-timeline">
                    <!-- æ—¶é—´çº¿é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <!-- å¯è§æ€§åˆ¤æ–­è§„åˆ™ -->
            <div class="visibility-rules">
                <div class="rules-title">ğŸ” å¯è§æ€§åˆ¤æ–­è§„åˆ™</div>
                <div id="visibility-rules">
                    <!-- è§„åˆ™é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentStep = 1;
        let currentScenario = 'basic';

        // åœºæ™¯é…ç½®
        const scenarios = {
            basic: {
                title: 'åŸºç¡€ç‰ˆæœ¬é“¾æ¼”ç¤º',
                subtitle: 'äº†è§£MVCCå¦‚ä½•é€šè¿‡ç‰ˆæœ¬é“¾ç®¡ç†æ•°æ®ç‰ˆæœ¬',
                steps: [
                    {
                        title: 'ğŸ“ åˆå§‹æ•°æ®æ’å…¥',
                        description: 'äº‹åŠ¡100æ’å…¥ä¸€æ¡ç”¨æˆ·è®°å½•ï¼Œè¿™æ˜¯ç‰ˆæœ¬é“¾çš„èµ·ç‚¹ã€‚',
                        explanation: 'æ¯æ¡è®°å½•éƒ½æœ‰éšè—å­—æ®µï¼šDB_TRX_IDï¼ˆäº‹åŠ¡IDï¼‰å’ŒDB_ROLL_PTRï¼ˆå›æ»šæŒ‡é’ˆï¼‰ã€‚',
                        versions: [
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: true, current: true }
                        ],
                        readview: null,
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' }
                        ],
                        rules: []
                    },
                    {
                        title: 'âœï¸ ç¬¬ä¸€æ¬¡æ›´æ–°',
                        description: 'äº‹åŠ¡200ä¿®æ”¹ç”¨æˆ·å§“åï¼Œåˆ›å»ºæ–°ç‰ˆæœ¬å¹¶å½¢æˆç‰ˆæœ¬é“¾ã€‚',
                        explanation: 'æ–°ç‰ˆæœ¬æŒ‡å‘æ—§ç‰ˆæœ¬ï¼Œå½¢æˆç‰ˆæœ¬é“¾ã€‚æ—§ç‰ˆæœ¬ä¿å­˜åœ¨undo logä¸­ã€‚',
                        versions: [
                            { id: 200, name: 'æå››', age: 25, visible: true, current: true },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: false, current: false }
                        ],
                        readview: null,
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šUPDATE users SET name="æå››" WHERE id=1', status: 'completed' }
                        ],
                        rules: []
                    },
                    {
                        title: 'âœï¸ ç¬¬äºŒæ¬¡æ›´æ–°',
                        description: 'äº‹åŠ¡300ç»§ç»­ä¿®æ”¹ç”¨æˆ·å¹´é¾„ï¼Œç‰ˆæœ¬é“¾ç»§ç»­å»¶é•¿ã€‚',
                        explanation: 'æ¯æ¬¡æ›´æ–°éƒ½ä¼šåˆ›å»ºæ–°ç‰ˆæœ¬ï¼Œç‰ˆæœ¬é“¾æŒ‰æ—¶é—´å€’åºæ’åˆ—ã€‚',
                        versions: [
                            { id: 300, name: 'æå››', age: 30, visible: true, current: true },
                            { id: 200, name: 'æå››', age: 25, visible: false, current: false },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: false, current: false }
                        ],
                        readview: null,
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šUPDATE users SET name="æå››" WHERE id=1', status: 'completed' },
                            { time: 'T3', event: 'äº‹åŠ¡300ï¼šUPDATE users SET age=30 WHERE id=1', status: 'completed' }
                        ],
                        rules: []
                    },
                    {
                        title: 'ğŸ‘ï¸ åˆ›å»ºReadView',
                        description: 'äº‹åŠ¡400å¼€å§‹è¯»å–æ•°æ®ï¼Œåˆ›å»ºReadViewå¿«ç…§ã€‚',
                        explanation: 'ReadViewè®°å½•å½“å‰æ´»è·ƒäº‹åŠ¡åˆ—è¡¨ï¼Œç”¨äºåˆ¤æ–­ç‰ˆæœ¬å¯è§æ€§ã€‚',
                        versions: [
                            { id: 300, name: 'æå››', age: 30, visible: true, current: true },
                            { id: 200, name: 'æå››', age: 25, visible: false, current: false },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: false, current: false }
                        ],
                        readview: {
                            m_ids: [450, 500],
                            min_trx_id: 450,
                            max_trx_id: 501,
                            creator_trx_id: 400
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šUPDATE users SET name="æå››" WHERE id=1', status: 'completed' },
                            { time: 'T3', event: 'äº‹åŠ¡300ï¼šUPDATE users SET age=30 WHERE id=1', status: 'completed' },
                            { time: 'T4', event: 'äº‹åŠ¡400ï¼šBEGIN; SELECT * FROM users WHERE id=1', status: 'active' }
                        ],
                        rules: []
                    },
                    {
                        title: 'ğŸ” ç‰ˆæœ¬å¯è§æ€§åˆ¤æ–­',
                        description: 'æ ¹æ®ReadViewè§„åˆ™åˆ¤æ–­å“ªä¸ªç‰ˆæœ¬å¯¹äº‹åŠ¡400å¯è§ã€‚',
                        explanation: 'äº‹åŠ¡300çš„ç‰ˆæœ¬å¯è§ï¼Œå› ä¸ºå®ƒåœ¨ReadViewåˆ›å»ºå‰å·²æäº¤ã€‚',
                        versions: [
                            { id: 300, name: 'æå››', age: 30, visible: true, current: true },
                            { id: 200, name: 'æå››', age: 25, visible: true, current: false },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: true, current: false }
                        ],
                        readview: {
                            m_ids: [450, 500],
                            min_trx_id: 450,
                            max_trx_id: 501,
                            creator_trx_id: 400
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šUPDATE users SET name="æå››" WHERE id=1', status: 'completed' },
                            { time: 'T3', event: 'äº‹åŠ¡300ï¼šUPDATE users SET age=30 WHERE id=1', status: 'completed' },
                            { time: 'T4', event: 'äº‹åŠ¡400ï¼šBEGIN; SELECT * FROM users WHERE id=1', status: 'active' }
                        ],
                        rules: [
                            { text: 'è§„åˆ™1ï¼štrx_id(300) != creator_trx_id(400)', status: 'failed' },
                            { text: 'è§„åˆ™2ï¼štrx_id(300) < min_trx_id(450)', status: 'passed' },
                            { text: 'ç»“æœï¼šç‰ˆæœ¬300å¯è§ï¼Œè¿”å› ("æå››", 30)', status: 'passed' }
                        ]
                    }
                ]
            },
            readview: {
                title: 'ReadViewåˆ¤æ–­æ¼”ç¤º',
                subtitle: 'æ·±å…¥ç†è§£ReadViewçš„å››ä¸ªåˆ¤æ–­è§„åˆ™',
                steps: [
                    {
                        title: 'ğŸš€ å‡†å¤‡æµ‹è¯•ç¯å¢ƒ',
                        description: 'åˆ›å»ºæµ‹è¯•æ•°æ®å’Œå¤šä¸ªå¹¶å‘äº‹åŠ¡ã€‚',
                        explanation: 'è®¾ç½®å¤æ‚çš„å¹¶å‘åœºæ™¯æ¥æ¼”ç¤ºReadViewçš„åˆ¤æ–­é€»è¾‘ã€‚',
                        versions: [
                            { id: 100, name: 'åŸå§‹æ•°æ®', age: 20, visible: false, current: false }
                        ],
                        readview: null,
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTåˆå§‹æ•°æ®', status: 'completed' }
                        ],
                        rules: []
                    },
                    {
                        title: 'ğŸ“Š åˆ›å»ºReadView',
                        description: 'äº‹åŠ¡150å¼€å§‹è¯»å–ï¼Œæ­¤æ—¶æœ‰å¤šä¸ªæ´»è·ƒäº‹åŠ¡ã€‚',
                        explanation: 'ReadViewè®°å½•äº†å½“å‰æ‰€æœ‰æ´»è·ƒäº‹åŠ¡çš„IDåˆ—è¡¨ã€‚',
                        versions: [
                            { id: 100, name: 'åŸå§‹æ•°æ®', age: 20, visible: false, current: false }
                        ],
                        readview: {
                            m_ids: [120, 140, 160],
                            min_trx_id: 120,
                            max_trx_id: 170,
                            creator_trx_id: 150
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTåˆå§‹æ•°æ®', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡120ï¼šBEGIN (æ´»è·ƒ)', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡140ï¼šBEGIN (æ´»è·ƒ)', status: 'active' },
                            { time: 'T4', event: 'äº‹åŠ¡150ï¼šBEGIN; åˆ›å»ºReadView', status: 'active' },
                            { time: 'T5', event: 'äº‹åŠ¡160ï¼šBEGIN (æ´»è·ƒ)', status: 'active' }
                        ],
                        rules: []
                    },
                    {
                        title: 'ğŸ” è§„åˆ™1ï¼šè‡ªå·±çš„ä¿®æ”¹',
                        description: 'åˆ¤æ–­äº‹åŠ¡è‡ªå·±çš„ä¿®æ”¹æ˜¯å¦å¯è§ï¼ˆæ€»æ˜¯å¯è§ï¼‰ã€‚',
                        explanation: 'å¦‚æœç‰ˆæœ¬çš„äº‹åŠ¡IDç­‰äºReadViewçš„åˆ›å»ºè€…IDï¼Œåˆ™å¯è§ã€‚',
                        versions: [
                            { id: 150, name: 'è‡ªå·±ä¿®æ”¹', age: 25, visible: true, current: true },
                            { id: 100, name: 'åŸå§‹æ•°æ®', age: 20, visible: false, current: false }
                        ],
                        readview: {
                            m_ids: [120, 140, 160],
                            min_trx_id: 120,
                            max_trx_id: 170,
                            creator_trx_id: 150
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTåˆå§‹æ•°æ®', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡120ï¼šBEGIN (æ´»è·ƒ)', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡140ï¼šBEGIN (æ´»è·ƒ)', status: 'active' },
                            { time: 'T4', event: 'äº‹åŠ¡150ï¼šBEGIN; UPDATEæ•°æ®', status: 'active' },
                            { time: 'T5', event: 'äº‹åŠ¡160ï¼šBEGIN (æ´»è·ƒ)', status: 'active' }
                        ],
                        rules: [
                            { text: 'è§„åˆ™1ï¼štrx_id(150) == creator_trx_id(150)', status: 'passed' },
                            { text: 'ç»“æœï¼šè‡ªå·±çš„ä¿®æ”¹æ€»æ˜¯å¯è§', status: 'passed' }
                        ]
                    },
                    {
                        title: 'ğŸ” è§„åˆ™2ï¼šå†å²å·²æäº¤äº‹åŠ¡',
                        description: 'åˆ¤æ–­ReadViewåˆ›å»ºå‰å·²æäº¤çš„äº‹åŠ¡ç‰ˆæœ¬ã€‚',
                        explanation: 'å¦‚æœç‰ˆæœ¬çš„äº‹åŠ¡IDå°äºæœ€å°æ´»è·ƒäº‹åŠ¡IDï¼Œåˆ™å¯è§ã€‚',
                        versions: [
                            { id: 110, name: 'å†å²æäº¤', age: 22, visible: true, current: true },
                            { id: 100, name: 'åŸå§‹æ•°æ®', age: 20, visible: false, current: false }
                        ],
                        readview: {
                            m_ids: [120, 140, 160],
                            min_trx_id: 120,
                            max_trx_id: 170,
                            creator_trx_id: 150
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTåˆå§‹æ•°æ®', status: 'completed' },
                            { time: 'T1.5', event: 'äº‹åŠ¡110ï¼šUPDATEå¹¶COMMIT', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡120ï¼šBEGIN (æ´»è·ƒ)', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡140ï¼šBEGIN (æ´»è·ƒ)', status: 'active' },
                            { time: 'T4', event: 'äº‹åŠ¡150ï¼šBEGIN; åˆ›å»ºReadView', status: 'active' },
                            { time: 'T5', event: 'äº‹åŠ¡160ï¼šBEGIN (æ´»è·ƒ)', status: 'active' }
                        ],
                        rules: [
                            { text: 'è§„åˆ™1ï¼štrx_id(110) != creator_trx_id(150)', status: 'failed' },
                            { text: 'è§„åˆ™2ï¼štrx_id(110) < min_trx_id(120)', status: 'passed' },
                            { text: 'ç»“æœï¼šå†å²å·²æäº¤äº‹åŠ¡å¯è§', status: 'passed' }
                        ]
                    },
                    {
                        title: 'ğŸ” è§„åˆ™3å’Œ4ï¼šæ´»è·ƒäº‹åŠ¡åˆ¤æ–­',
                        description: 'åˆ¤æ–­æ´»è·ƒäº‹åŠ¡å’Œæœªæ¥äº‹åŠ¡çš„å¯è§æ€§ã€‚',
                        explanation: 'æ´»è·ƒäº‹åŠ¡å’Œæœªæ¥äº‹åŠ¡çš„ä¿®æ”¹éƒ½ä¸å¯è§ï¼Œéœ€è¦æŸ¥æ‰¾å†å²ç‰ˆæœ¬ã€‚',
                        versions: [
                            { id: 140, name: 'æ´»è·ƒäº‹åŠ¡ä¿®æ”¹', age: 28, visible: false, current: true },
                            { id: 110, name: 'å†å²æäº¤', age: 22, visible: true, current: false },
                            { id: 100, name: 'åŸå§‹æ•°æ®', age: 20, visible: false, current: false }
                        ],
                        readview: {
                            m_ids: [120, 140, 160],
                            min_trx_id: 120,
                            max_trx_id: 170,
                            creator_trx_id: 150
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTåˆå§‹æ•°æ®', status: 'completed' },
                            { time: 'T1.5', event: 'äº‹åŠ¡110ï¼šUPDATEå¹¶COMMIT', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡120ï¼šBEGIN (æ´»è·ƒ)', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡140ï¼šBEGIN; UPDATEæ•°æ®', status: 'active' },
                            { time: 'T4', event: 'äº‹åŠ¡150ï¼šBEGIN; åˆ›å»ºReadView', status: 'active' },
                            { time: 'T5', event: 'äº‹åŠ¡160ï¼šBEGIN (æ´»è·ƒ)', status: 'active' }
                        ],
                        rules: [
                            { text: 'è§„åˆ™1ï¼štrx_id(140) != creator_trx_id(150)', status: 'failed' },
                            { text: 'è§„åˆ™2ï¼štrx_id(140) >= min_trx_id(120)', status: 'failed' },
                            { text: 'è§„åˆ™3ï¼štrx_id(140) < max_trx_id(170)', status: 'passed' },
                            { text: 'è§„åˆ™4ï¼štrx_id(140) in m_ids[120,140,160]', status: 'failed' },
                            { text: 'ç»“æœï¼šæ´»è·ƒäº‹åŠ¡ä¸å¯è§ï¼ŒæŸ¥æ‰¾å†å²ç‰ˆæœ¬', status: 'failed' }
                        ]
                    }
                ]
            },
            isolation: {
                title: 'éš”ç¦»çº§åˆ«å¯¹æ¯”æ¼”ç¤º',
                subtitle: 'å¯¹æ¯”READ COMMITTEDå’ŒREPEATABLE READçš„ReadViewè¡Œä¸ºå·®å¼‚',
                steps: [
                    {
                        title: 'ğŸ”§ å‡†å¤‡æµ‹è¯•ç¯å¢ƒ',
                        description: 'åˆ›å»ºæµ‹è¯•æ•°æ®ï¼Œå‡†å¤‡ä¸¤ä¸ªä¸åŒéš”ç¦»çº§åˆ«çš„ä¼šè¯ã€‚',
                        explanation: 'READ COMMITTEDæ¯æ¬¡è¯»å–éƒ½åˆ›å»ºæ–°ReadViewï¼ŒREPEATABLE READåªåœ¨ç¬¬ä¸€æ¬¡è¯»å–æ—¶åˆ›å»ºã€‚',
                        versions: [
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: true, current: true }
                        ],
                        readview: null,
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' },
                            { time: 'T2', event: 'ä¼šè¯Aï¼šSET ISOLATION LEVEL READ COMMITTED', status: 'completed' },
                            { time: 'T3', event: 'ä¼šè¯Bï¼šSET ISOLATION LEVEL REPEATABLE READ', status: 'completed' }
                        ],
                        rules: []
                    },
                    {
                        title: 'ğŸš€ å¼€å¯äº‹åŠ¡å¹¶é¦–æ¬¡è¯»å–',
                        description: 'ä¸¤ä¸ªä¼šè¯åŒæ—¶å¼€å¯äº‹åŠ¡å¹¶è¿›è¡Œé¦–æ¬¡è¯»å–ã€‚',
                        explanation: 'ä¸¤ä¸ªéš”ç¦»çº§åˆ«éƒ½ä¼šåˆ›å»ºReadViewï¼Œæ­¤æ—¶è¯»å–ç»“æœç›¸åŒã€‚',
                        versions: [
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: true, current: true }
                        ],
                        readview: {
                            m_ids: [200, 300],
                            min_trx_id: 200,
                            max_trx_id: 400,
                            creator_trx_id: 200
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTåˆå§‹æ•°æ®', status: 'completed' },
                            { time: 'T4', event: 'ä¼šè¯A(RC)ï¼šBEGIN; SELECT * FROM users', status: 'active' },
                            { time: 'T5', event: 'ä¼šè¯B(RR)ï¼šBEGIN; SELECT * FROM users', status: 'active' }
                        ],
                        rules: [
                            { text: 'RCä¼šè¯ï¼šåˆ›å»ºReadView-1ï¼Œè¯»å–åˆ° ("å¼ ä¸‰", 25)', status: 'passed' },
                            { text: 'RRä¼šè¯ï¼šåˆ›å»ºReadView-1ï¼Œè¯»å–åˆ° ("å¼ ä¸‰", 25)', status: 'passed' },
                            { text: 'ç»“æœï¼šä¸¤ä¸ªä¼šè¯è¯»å–ç»“æœç›¸åŒ', status: 'passed' }
                        ]
                    },
                    {
                        title: 'âœï¸ å…¶ä»–äº‹åŠ¡ä¿®æ”¹æ•°æ®',
                        description: 'äº‹åŠ¡400ä¿®æ”¹æ•°æ®å¹¶æäº¤ã€‚',
                        explanation: 'å¤–éƒ¨äº‹åŠ¡çš„ä¿®æ”¹ä¼šå½±å“åç»­çš„ReadViewåˆ›å»ºã€‚',
                        versions: [
                            { id: 400, name: 'æå››', age: 30, visible: true, current: true },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: false, current: false }
                        ],
                        readview: {
                            m_ids: [200, 300],
                            min_trx_id: 200,
                            max_trx_id: 500,
                            creator_trx_id: 200
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTåˆå§‹æ•°æ®', status: 'completed' },
                            { time: 'T4', event: 'ä¼šè¯A(RC)ï¼šBEGIN; SELECT * FROM users', status: 'active' },
                            { time: 'T5', event: 'ä¼šè¯B(RR)ï¼šBEGIN; SELECT * FROM users', status: 'active' },
                            { time: 'T6', event: 'äº‹åŠ¡400ï¼šUPDATE users SET name="æå››", age=30; COMMIT', status: 'completed' }
                        ],
                        rules: [
                            { text: 'äº‹åŠ¡400ï¼šä¿®æ”¹æ•°æ®å¹¶æäº¤', status: 'passed' },
                            { text: 'ç‰ˆæœ¬é“¾ï¼š400("æå››",30) -> 100("å¼ ä¸‰",25)', status: 'passed' }
                        ]
                    },
                    {
                        title: 'ğŸ” å†æ¬¡è¯»å– - å…³é”®å·®å¼‚',
                        description: 'ä¸¤ä¸ªä¼šè¯å†æ¬¡è¯»å–ï¼Œè§‚å¯Ÿéš”ç¦»çº§åˆ«å·®å¼‚ã€‚',
                        explanation: 'RCä¼šåˆ›å»ºæ–°ReadViewèƒ½çœ‹åˆ°æ–°æ•°æ®ï¼ŒRRå¤ç”¨æ—§ReadViewçœ‹åˆ°æ—§æ•°æ®ã€‚',
                        versions: [
                            { id: 400, name: 'æå››', age: 30, visible: true, current: true },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: true, current: false }
                        ],
                        readview: {
                            m_ids: [200, 300],
                            min_trx_id: 200,
                            max_trx_id: 500,
                            creator_trx_id: 200
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTåˆå§‹æ•°æ®', status: 'completed' },
                            { time: 'T4', event: 'ä¼šè¯A(RC)ï¼šBEGIN; SELECT * FROM users', status: 'active' },
                            { time: 'T5', event: 'ä¼šè¯B(RR)ï¼šBEGIN; SELECT * FROM users', status: 'active' },
                            { time: 'T6', event: 'äº‹åŠ¡400ï¼šUPDATEå¹¶COMMIT', status: 'completed' },
                            { time: 'T7', event: 'ä¼šè¯A(RC)ï¼šå†æ¬¡SELECT (åˆ›å»ºæ–°ReadView)', status: 'active' },
                            { time: 'T8', event: 'ä¼šè¯B(RR)ï¼šå†æ¬¡SELECT (å¤ç”¨æ—§ReadView)', status: 'active' }
                        ],
                        rules: [
                            { text: 'RCä¼šè¯ï¼šåˆ›å»ºReadView-2ï¼Œtrx_id(400) < min_trx_id(500)', status: 'passed' },
                            { text: 'RCä¼šè¯ï¼šè¯»å–åˆ° ("æå››", 30) - ä¸å¯é‡å¤è¯»', status: 'failed' },
                            { text: 'RRä¼šè¯ï¼šå¤ç”¨ReadView-1ï¼Œtrx_id(400) >= min_trx_id(200)', status: 'failed' },
                            { text: 'RRä¼šè¯ï¼šè¯»å–åˆ° ("å¼ ä¸‰", 25) - å¯é‡å¤è¯»', status: 'passed' }
                        ]
                    },
                    {
                        title: 'ğŸ“Š éš”ç¦»çº§åˆ«å¯¹æ¯”æ€»ç»“',
                        description: 'æ€»ç»“ä¸¤ç§éš”ç¦»çº§åˆ«çš„ReadViewè¡Œä¸ºå·®å¼‚ã€‚',
                        explanation: 'READ COMMITTEDæä¾›æ›´æ–°çš„æ•°æ®ä½†ä¸ä¿è¯å¯é‡å¤è¯»ï¼ŒREPEATABLE READä¿è¯ä¸€è‡´æ€§è¯»å–ã€‚',
                        versions: [
                            { id: 400, name: 'æå››', age: 30, visible: true, current: true },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: true, current: false }
                        ],
                        readview: {
                            m_ids: [200, 300],
                            min_trx_id: 200,
                            max_trx_id: 500,
                            creator_trx_id: 200
                        },
                        timeline: [
                            { time: 'T1-T8', event: 'å®Œæ•´æ¼”ç¤ºæµç¨‹', status: 'completed' }
                        ],
                        rules: [
                            { text: 'READ COMMITTEDï¼šæ¯æ¬¡è¯»å–åˆ›å»ºæ–°ReadView', status: 'passed' },
                            { text: 'REPEATABLE READï¼šäº‹åŠ¡å†…å¤ç”¨åŒä¸€ReadView', status: 'passed' },
                            { text: 'RCä¼˜åŠ¿ï¼šèƒ½è¯»å–åˆ°æœ€æ–°å·²æäº¤æ•°æ®', status: 'passed' },
                            { text: 'RRä¼˜åŠ¿ï¼šä¿è¯äº‹åŠ¡å†…è¯»å–ä¸€è‡´æ€§', status: 'passed' }
                        ]
                    }
                ]
            },
            concurrent: {
                title: 'å¹¶å‘è¯»å†™æ¼”ç¤º',
                subtitle: 'æ¼”ç¤ºå¤šä¸ªäº‹åŠ¡å¹¶å‘è¯»å†™æ—¶çš„MVCCè¡Œä¸º',
                steps: [
                    {
                        title: 'ğŸ”§ åˆå§‹åŒ–å¹¶å‘ç¯å¢ƒ',
                        description: 'åˆ›å»ºæµ‹è¯•æ•°æ®ï¼Œå‡†å¤‡å¤šä¸ªå¹¶å‘äº‹åŠ¡ã€‚',
                        explanation: 'æ¨¡æ‹ŸçœŸå®çš„å¹¶å‘è¯»å†™åœºæ™¯ï¼Œå±•ç¤ºMVCCå¦‚ä½•å¤„ç†å¹¶å‘å†²çªã€‚',
                        versions: [
                            { id: 100, name: 'åˆå§‹ç”¨æˆ·', age: 20, visible: true, current: true }
                        ],
                        readview: null,
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "åˆå§‹ç”¨æˆ·", 20)', status: 'completed' }
                        ],
                        rules: []
                    },
                    {
                        title: 'ğŸš€ å¯åŠ¨å¹¶å‘äº‹åŠ¡',
                        description: 'åŒæ—¶å¯åŠ¨ä¸‰ä¸ªäº‹åŠ¡ï¼šè¯»äº‹åŠ¡ã€å†™äº‹åŠ¡Aã€å†™äº‹åŠ¡Bã€‚',
                        explanation: 'ä¸‰ä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œï¼Œè¯»äº‹åŠ¡éœ€è¦åœ¨å†™äº‹åŠ¡çš„å¹²æ‰°ä¸‹ä¿æŒæ•°æ®ä¸€è‡´æ€§ã€‚',
                        versions: [
                            { id: 100, name: 'åˆå§‹ç”¨æˆ·', age: 20, visible: true, current: true }
                        ],
                        readview: null,
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTåˆå§‹æ•°æ®', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šBEGIN (è¯»äº‹åŠ¡)', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡300ï¼šBEGIN (å†™äº‹åŠ¡A)', status: 'active' },
                            { time: 'T4', event: 'äº‹åŠ¡400ï¼šBEGIN (å†™äº‹åŠ¡B)', status: 'active' }
                        ],
                        rules: [
                            { text: 'ä¸‰ä¸ªäº‹åŠ¡åŒæ—¶å¤„äºæ´»è·ƒçŠ¶æ€', status: 'passed' },
                            { text: 'å‡†å¤‡æ¼”ç¤ºå¹¶å‘è¯»å†™åœºæ™¯', status: 'passed' }
                        ]
                    },
                    {
                        title: 'ğŸ“– è¯»äº‹åŠ¡åˆ›å»ºReadView',
                        description: 'äº‹åŠ¡200å¼€å§‹è¯»å–ï¼Œåˆ›å»ºReadViewå¿«ç…§ã€‚',
                        explanation: 'ReadViewè®°å½•å½“å‰æ´»è·ƒäº‹åŠ¡ï¼Œç¡®ä¿è¯»å–çš„ä¸€è‡´æ€§ã€‚',
                        versions: [
                            { id: 100, name: 'åˆå§‹ç”¨æˆ·', age: 20, visible: true, current: true }
                        ],
                        readview: {
                            m_ids: [200, 300, 400],
                            min_trx_id: 200,
                            max_trx_id: 500,
                            creator_trx_id: 200
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTåˆå§‹æ•°æ®', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šBEGIN', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡300ï¼šBEGIN', status: 'active' },
                            { time: 'T4', event: 'äº‹åŠ¡400ï¼šBEGIN', status: 'active' },
                            { time: 'T5', event: 'äº‹åŠ¡200ï¼šSELECT * FROM users (åˆ›å»ºReadView)', status: 'active' }
                        ],
                        rules: [
                            { text: 'ReadViewè®°å½•æ´»è·ƒäº‹åŠ¡ï¼š[200, 300, 400]', status: 'passed' },
                            { text: 'è¯»å–åˆ°åˆå§‹æ•°æ®ï¼š("åˆå§‹ç”¨æˆ·", 20)', status: 'passed' }
                        ]
                    },
                    {
                        title: 'âœï¸ å†™äº‹åŠ¡Aä¿®æ”¹æ•°æ®',
                        description: 'äº‹åŠ¡300ä¿®æ”¹ç”¨æˆ·å§“åå¹¶æäº¤ã€‚',
                        explanation: 'å†™äº‹åŠ¡çš„ä¿®æ”¹å¯¹å·²åˆ›å»ºReadViewçš„è¯»äº‹åŠ¡ä¸å¯è§ã€‚',
                        versions: [
                            { id: 300, name: 'ç”¨æˆ·A', age: 20, visible: false, current: true },
                            { id: 100, name: 'åˆå§‹ç”¨æˆ·', age: 20, visible: true, current: false }
                        ],
                        readview: {
                            m_ids: [200, 300, 400],
                            min_trx_id: 200,
                            max_trx_id: 500,
                            creator_trx_id: 200
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTåˆå§‹æ•°æ®', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šBEGIN', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡300ï¼šBEGIN', status: 'active' },
                            { time: 'T4', event: 'äº‹åŠ¡400ï¼šBEGIN', status: 'active' },
                            { time: 'T5', event: 'äº‹åŠ¡200ï¼šSELECT (åˆ›å»ºReadView)', status: 'active' },
                            { time: 'T6', event: 'äº‹åŠ¡300ï¼šUPDATE name="ç”¨æˆ·A"; COMMIT', status: 'completed' }
                        ],
                        rules: [
                            { text: 'äº‹åŠ¡300ï¼štrx_id(300) in m_ids[200,300,400]', status: 'failed' },
                            { text: 'å¯¹äº‹åŠ¡200ä¸å¯è§ï¼Œä»è¯»å–åˆå§‹æ•°æ®', status: 'passed' }
                        ]
                    },
                    {
                        title: 'âœï¸ å†™äº‹åŠ¡Bä¿®æ”¹æ•°æ®',
                        description: 'äº‹åŠ¡400ä¿®æ”¹ç”¨æˆ·å¹´é¾„å¹¶æäº¤ã€‚',
                        explanation: 'å¤šä¸ªå†™äº‹åŠ¡çš„ä¿®æ”¹å½¢æˆç‰ˆæœ¬é“¾ï¼Œä½†å¯¹è¯»äº‹åŠ¡éƒ½ä¸å¯è§ã€‚',
                        versions: [
                            { id: 400, name: 'ç”¨æˆ·A', age: 25, visible: false, current: true },
                            { id: 300, name: 'ç”¨æˆ·A', age: 20, visible: false, current: false },
                            { id: 100, name: 'åˆå§‹ç”¨æˆ·', age: 20, visible: true, current: false }
                        ],
                        readview: {
                            m_ids: [200, 300, 400],
                            min_trx_id: 200,
                            max_trx_id: 500,
                            creator_trx_id: 200
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTåˆå§‹æ•°æ®', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šBEGIN', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡300ï¼šBEGIN', status: 'active' },
                            { time: 'T4', event: 'äº‹åŠ¡400ï¼šBEGIN', status: 'active' },
                            { time: 'T5', event: 'äº‹åŠ¡200ï¼šSELECT (åˆ›å»ºReadView)', status: 'active' },
                            { time: 'T6', event: 'äº‹åŠ¡300ï¼šUPDATE name="ç”¨æˆ·A"; COMMIT', status: 'completed' },
                            { time: 'T7', event: 'äº‹åŠ¡400ï¼šUPDATE age=25; COMMIT', status: 'completed' }
                        ],
                        rules: [
                            { text: 'äº‹åŠ¡400ï¼štrx_id(400) in m_ids[200,300,400]', status: 'failed' },
                            { text: 'ç‰ˆæœ¬é“¾ï¼š400->300->100ï¼Œä½†åªæœ‰100å¯è§', status: 'passed' }
                        ]
                    },
                    {
                        title: 'ğŸ” è¯»äº‹åŠ¡å†æ¬¡è¯»å–',
                        description: 'äº‹åŠ¡200å†æ¬¡è¯»å–ï¼ŒéªŒè¯è¯»å–ä¸€è‡´æ€§ã€‚',
                        explanation: 'REPEATABLE READä¿è¯äº‹åŠ¡å†…å¤šæ¬¡è¯»å–ç»“æœä¸€è‡´ï¼Œä¸å—å…¶ä»–äº‹åŠ¡å½±å“ã€‚',
                        versions: [
                            { id: 400, name: 'ç”¨æˆ·A', age: 25, visible: false, current: true },
                            { id: 300, name: 'ç”¨æˆ·A', age: 20, visible: false, current: false },
                            { id: 100, name: 'åˆå§‹ç”¨æˆ·', age: 20, visible: true, current: false }
                        ],
                        readview: {
                            m_ids: [200, 300, 400],
                            min_trx_id: 200,
                            max_trx_id: 500,
                            creator_trx_id: 200
                        },
                        timeline: [
                            { time: 'T1-T7', event: 'å‰é¢çš„æ‰€æœ‰æ“ä½œ', status: 'completed' },
                            { time: 'T8', event: 'äº‹åŠ¡200ï¼šå†æ¬¡SELECT * FROM users', status: 'active' }
                        ],
                        rules: [
                            { text: 'å¤ç”¨åŸæœ‰ReadViewï¼Œä¸åˆ›å»ºæ–°çš„', status: 'passed' },
                            { text: 'ä»ç„¶åªèƒ½çœ‹åˆ°ç‰ˆæœ¬100çš„æ•°æ®', status: 'passed' },
                            { text: 'è¯»å–ç»“æœï¼š("åˆå§‹ç”¨æˆ·", 20) - ä¿æŒä¸€è‡´', status: 'passed' },
                            { text: 'MVCCæˆåŠŸå®ç°å¹¶å‘è¯»å†™éš”ç¦»', status: 'passed' }
                        ]
                    },
                    {
                        title: 'ğŸ“Š å¹¶å‘è¯»å†™æ€»ç»“',
                        description: 'æ€»ç»“MVCCåœ¨å¹¶å‘è¯»å†™åœºæ™¯ä¸‹çš„ä¼˜åŠ¿ã€‚',
                        explanation: 'MVCCé€šè¿‡ç‰ˆæœ¬é“¾å’ŒReadViewå®ç°äº†è¯»å†™ä¸é˜»å¡ï¼Œæé«˜äº†å¹¶å‘æ€§èƒ½ã€‚',
                        versions: [
                            { id: 400, name: 'ç”¨æˆ·A', age: 25, visible: false, current: true },
                            { id: 300, name: 'ç”¨æˆ·A', age: 20, visible: false, current: false },
                            { id: 100, name: 'åˆå§‹ç”¨æˆ·', age: 20, visible: true, current: false }
                        ],
                        readview: {
                            m_ids: [200, 300, 400],
                            min_trx_id: 200,
                            max_trx_id: 500,
                            creator_trx_id: 200
                        },
                        timeline: [
                            { time: 'æ€»ç»“', event: 'å¹¶å‘è¯»å†™æ¼”ç¤ºå®Œæˆ', status: 'completed' }
                        ],
                        rules: [
                            { text: 'âœ… è¯»äº‹åŠ¡ä¸é˜»å¡å†™äº‹åŠ¡', status: 'passed' },
                            { text: 'âœ… å†™äº‹åŠ¡ä¸é˜»å¡è¯»äº‹åŠ¡', status: 'passed' },
                            { text: 'âœ… ä¿è¯è¯»å–ä¸€è‡´æ€§', status: 'passed' },
                            { text: 'âœ… æé«˜å¹¶å‘æ€§èƒ½', status: 'passed' }
                        ]
                    }
                ]
            },
            undolog: {
                title: 'Undo Logè¯¦è§£',
                subtitle: 'æ·±å…¥ç†è§£Undo Logçš„å­˜å‚¨ç»“æ„å’ŒReadViewåˆ¤æ–­æœºåˆ¶',
                steps: [
                    {
                        title: 'ğŸ“ åˆå§‹æ•°æ®å’Œäº‹åŠ¡å‡†å¤‡',
                        description: 'äº‹åŠ¡100æ’å…¥åˆå§‹è®°å½•ï¼Œäº‹åŠ¡400å¼€å§‹å¹¶åˆ›å»ºReadViewã€‚',
                        explanation: 'INSERTæ“ä½œåˆ›å»ºDELETEç±»å‹çš„Undo Logã€‚äº‹åŠ¡400åˆ›å»ºReadViewæ—¶è®°å½•å½“å‰æ´»è·ƒäº‹åŠ¡åˆ—è¡¨ã€‚',
                        versions: [
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: true, current: true }
                        ],
                        undolog: [
                            { type: 'DELETE', trx_id: 100, operation: 'DELETE FROM users WHERE id=1', rollback_ptr: null }
                        ],
                        readview: {
                            m_ids: [200, 300],
                            min_trx_id: 200,
                            max_trx_id: 400,
                            creator_trx_id: 400
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šBEGIN (æ´»è·ƒ)', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡300ï¼šBEGIN (æ´»è·ƒ)', status: 'active' },
                            { time: 'T4', event: 'äº‹åŠ¡400ï¼šBEGIN; åˆ›å»ºReadView', status: 'active' }
                        ],
                        rules: [
                            { text: 'ReadViewåˆ›å»ºï¼šè®°å½•æ´»è·ƒäº‹åŠ¡[200,300]', status: 'passed' },
                            { text: 'trx_id(100) < min_trx_id(200) â†’ ç‰ˆæœ¬100å¯è§', status: 'passed' }
                        ]
                    },
                    {
                        title: 'âœï¸ æ´»è·ƒäº‹åŠ¡200ä¿®æ”¹æ•°æ®',
                        description: 'äº‹åŠ¡200ä¿®æ”¹å§“åï¼Œç”ŸæˆUPDATEç±»å‹çš„Undo Logï¼Œä½†å¯¹äº‹åŠ¡400ä¸å¯è§ã€‚',
                        explanation: 'UPDATEæ“ä½œåˆ›å»ºåŒ…å«æ—§å€¼çš„Undo Logã€‚ç”±äºäº‹åŠ¡200åœ¨ReadViewçš„æ´»è·ƒåˆ—è¡¨ä¸­ï¼Œå…¶ä¿®æ”¹ä¸å¯è§ã€‚',
                        versions: [
                            { id: 200, name: 'æå››', age: 25, visible: false, current: true },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: true, current: false }
                        ],
                        undolog: [
                            { type: 'UPDATE', trx_id: 200, operation: 'UPDATE users SET name="å¼ ä¸‰" WHERE id=1', rollback_ptr: 'ptr_100' },
                            { type: 'DELETE', trx_id: 100, operation: 'DELETE FROM users WHERE id=1', rollback_ptr: null }
                        ],
                        readview: {
                            m_ids: [200, 300],
                            min_trx_id: 200,
                            max_trx_id: 400,
                            creator_trx_id: 400
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERTå®Œæˆ', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šBEGIN', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡300ï¼šBEGIN', status: 'active' },
                            { time: 'T4', event: 'äº‹åŠ¡400ï¼šBEGIN; åˆ›å»ºReadView', status: 'active' },
                            { time: 'T5', event: 'äº‹åŠ¡200ï¼šUPDATE name="æå››"', status: 'active' }
                        ],
                        rules: [
                            { text: 'åˆ¤æ–­ç‰ˆæœ¬200ï¼štrx_id(200) in m_ids[200,300]', status: 'failed' },
                            { text: 'ç‰ˆæœ¬200ä¸å¯è§ï¼Œæ²¿Undo Logé“¾æŸ¥æ‰¾', status: 'checking' },
                            { text: 'åˆ¤æ–­ç‰ˆæœ¬100ï¼štrx_id(100) < min_trx_id(200)', status: 'passed' },
                            { text: 'è¿”å›ç‰ˆæœ¬100ï¼š("å¼ ä¸‰", 25)', status: 'passed' }
                        ]
                    },
                    {
                        title: 'âœï¸ æ´»è·ƒäº‹åŠ¡300ç»§ç»­ä¿®æ”¹',
                        description: 'äº‹åŠ¡300ä¿®æ”¹å¹´é¾„ï¼ŒUndo Logé“¾ç»§ç»­å»¶é•¿ï¼Œæ¼”ç¤ºå¤šå±‚ç‰ˆæœ¬æŸ¥æ‰¾ã€‚',
                        explanation: 'å¤šä¸ªæ´»è·ƒäº‹åŠ¡çš„ä¿®æ”¹éƒ½ä¸å¯è§ï¼Œéœ€è¦æ²¿ç€Undo Logé“¾ä¸€ç›´å›æº¯åˆ°å¯è§ç‰ˆæœ¬ã€‚',
                        versions: [
                            { id: 300, name: 'æå››', age: 30, visible: false, current: true },
                            { id: 200, name: 'æå››', age: 25, visible: false, current: false },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: true, current: false }
                        ],
                        undolog: [
                            { type: 'UPDATE', trx_id: 300, operation: 'UPDATE users SET age=25 WHERE id=1', rollback_ptr: 'ptr_200' },
                            { type: 'UPDATE', trx_id: 200, operation: 'UPDATE users SET name="å¼ ä¸‰" WHERE id=1', rollback_ptr: 'ptr_100' },
                            { type: 'DELETE', trx_id: 100, operation: 'DELETE FROM users WHERE id=1', rollback_ptr: null }
                        ],
                        readview: {
                            m_ids: [200, 300],
                            min_trx_id: 200,
                            max_trx_id: 400,
                            creator_trx_id: 400
                        },
                        timeline: [
                            { time: 'T1-T5', event: 'å‰é¢çš„æ“ä½œ', status: 'completed' },
                            { time: 'T6', event: 'äº‹åŠ¡300ï¼šUPDATE age=30', status: 'active' }
                        ],
                        rules: [
                            { text: 'åˆ¤æ–­ç‰ˆæœ¬300ï¼štrx_id(300) in m_ids[200,300]', status: 'failed' },
                            { text: 'æ²¿rollback_ptræŸ¥æ‰¾ç‰ˆæœ¬200', status: 'checking' },
                            { text: 'åˆ¤æ–­ç‰ˆæœ¬200ï¼štrx_id(200) in m_ids[200,300]', status: 'failed' },
                            { text: 'ç»§ç»­æ²¿rollback_ptræŸ¥æ‰¾ç‰ˆæœ¬100', status: 'checking' },
                            { text: 'åˆ¤æ–­ç‰ˆæœ¬100ï¼štrx_id(100) < min_trx_id(200)', status: 'passed' },
                            { text: 'è¿”å›ç‰ˆæœ¬100ï¼š("å¼ ä¸‰", 25)', status: 'passed' }
                        ]
                    },
                    {
                        title: 'ğŸ”„ äº‹åŠ¡200æäº¤åçš„å˜åŒ–',
                        description: 'äº‹åŠ¡200æäº¤åï¼Œæ–°çš„ReadViewå¯ä»¥çœ‹åˆ°å…¶ä¿®æ”¹ï¼Œæ¼”ç¤ºReadViewæ›´æ–°æœºåˆ¶ã€‚',
                        explanation: 'äº‹åŠ¡æäº¤åä¸å†æ´»è·ƒï¼Œæ–°åˆ›å»ºçš„ReadViewå¯ä»¥çœ‹åˆ°å·²æäº¤äº‹åŠ¡çš„ä¿®æ”¹ã€‚',
                        versions: [
                            { id: 300, name: 'æå››', age: 30, visible: false, current: true },
                            { id: 200, name: 'æå››', age: 25, visible: true, current: false },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: false, current: false }
                        ],
                        undolog: [
                            { type: 'UPDATE', trx_id: 300, operation: 'UPDATE users SET age=25 WHERE id=1', rollback_ptr: 'ptr_200' },
                            { type: 'UPDATE', trx_id: 200, operation: 'UPDATE users SET name="å¼ ä¸‰" WHERE id=1', rollback_ptr: 'ptr_100' },
                            { type: 'DELETE', trx_id: 100, operation: 'DELETE FROM users WHERE id=1', rollback_ptr: null }
                        ],
                        readview: {
                            m_ids: [300],
                            min_trx_id: 300,
                            max_trx_id: 500,
                            creator_trx_id: 500
                        },
                        timeline: [
                            { time: 'T1-T6', event: 'å‰é¢çš„æ“ä½œ', status: 'completed' },
                            { time: 'T7', event: 'äº‹åŠ¡200ï¼šCOMMIT', status: 'completed' },
                            { time: 'T8', event: 'äº‹åŠ¡500ï¼šBEGIN; åˆ›å»ºæ–°ReadView', status: 'active' }
                        ],
                        rules: [
                            { text: 'æ–°ReadViewï¼šæ´»è·ƒäº‹åŠ¡[300]', status: 'passed' },
                            { text: 'åˆ¤æ–­ç‰ˆæœ¬300ï¼štrx_id(300) in m_ids[300]', status: 'failed' },
                            { text: 'æ²¿rollback_ptræŸ¥æ‰¾ç‰ˆæœ¬200', status: 'checking' },
                            { text: 'åˆ¤æ–­ç‰ˆæœ¬200ï¼štrx_id(200) < min_trx_id(300)', status: 'passed' },
                            { text: 'è¿”å›ç‰ˆæœ¬200ï¼š("æå››", 25)', status: 'passed' }
                        ]
                    },
                    {
                        title: 'ğŸ§¹ Purgeçº¿ç¨‹æ¸…ç†æœºåˆ¶',
                        description: 'æ¼”ç¤ºPurgeçº¿ç¨‹å¦‚ä½•æ¸…ç†ä¸å†éœ€è¦çš„Undo Logè®°å½•ã€‚',
                        explanation: 'å½“æ²¡æœ‰æ´»è·ƒäº‹åŠ¡éœ€è¦è®¿é—®æŸä¸ªUndo Logç‰ˆæœ¬æ—¶ï¼ŒPurgeçº¿ç¨‹ä¼šæ¸…ç†å®ƒä»¥é‡Šæ”¾ç©ºé—´ã€‚',
                        versions: [
                            { id: 300, name: 'æå››', age: 30, visible: true, current: true },
                            { id: 200, name: 'æå››', age: 25, visible: false, current: false }
                        ],
                        undolog: [
                            { type: 'UPDATE', trx_id: 300, operation: 'UPDATE users SET age=25 WHERE id=1', rollback_ptr: 'ptr_200' },
                            { type: 'UPDATE', trx_id: 200, operation: 'UPDATE users SET name="å¼ ä¸‰" WHERE id=1', rollback_ptr: 'PURGED' }
                        ],
                        readview: {
                            m_ids: [],
                            min_trx_id: 600,
                            max_trx_id: 600,
                            creator_trx_id: 600
                        },
                        timeline: [
                            { time: 'T1-T8', event: 'å‰é¢çš„æ“ä½œ', status: 'completed' },
                            { time: 'T9', event: 'äº‹åŠ¡300ï¼šCOMMIT', status: 'completed' },
                            { time: 'T10', event: 'Purgeçº¿ç¨‹ï¼šæ¸…ç†ç‰ˆæœ¬100çš„Undo Log', status: 'completed' },
                            { time: 'T11', event: 'äº‹åŠ¡600ï¼šBEGIN; åˆ›å»ºReadView', status: 'active' }
                        ],
                        rules: [
                            { text: 'æ‰€æœ‰äº‹åŠ¡éƒ½å·²æäº¤ï¼Œæ— æ´»è·ƒäº‹åŠ¡', status: 'passed' },
                            { text: 'åˆ¤æ–­ç‰ˆæœ¬300ï¼štrx_id(300) < min_trx_id(600)', status: 'passed' },
                            { text: 'è¿”å›ç‰ˆæœ¬300ï¼š("æå››", 30)', status: 'passed' },
                            { text: 'Purgeçº¿ç¨‹å·²æ¸…ç†ä¸éœ€è¦çš„å†å²ç‰ˆæœ¬', status: 'passed' }
                        ]
                    },
                    {
                        title: 'ğŸ—‘ï¸ Undo Logæ¸…ç†æœºåˆ¶',
                        description: 'äº†è§£Undo Logçš„æ¸…ç†æ—¶æœºå’Œpurgeçº¿ç¨‹çš„å·¥ä½œåŸç†ã€‚',
                        explanation: 'å½“æ²¡æœ‰äº‹åŠ¡éœ€è¦è®¿é—®æŸä¸ªUndo Logè®°å½•æ—¶ï¼Œpurgeçº¿ç¨‹ä¼šæ¸…ç†è¿™äº›è®°å½•ä»¥é‡Šæ”¾ç©ºé—´ã€‚',
                        versions: [
                            { id: 300, name: 'æå››', age: 30, visible: true, current: true }
                        ],
                        undolog: [
                            { type: 'UPDATE', trx_id: 300, operation: 'UPDATE users SET age=25 WHERE id=1', rollback_ptr: 'ptr_200' }
                        ],
                        readview: null,
                        timeline: [
                            { time: 'T1-T3', event: 'å†å²äº‹åŠ¡å·²æäº¤', status: 'completed' },
                            { time: 'T4', event: 'Purgeçº¿ç¨‹æ¸…ç†ä¸éœ€è¦çš„Undo Log', status: 'completed' }
                        ],
                        rules: [
                            { text: 'âœ… æ¸…ç†äº‹åŠ¡100çš„Undo Logè®°å½•', status: 'passed' },
                            { text: 'âœ… æ¸…ç†äº‹åŠ¡200çš„Undo Logè®°å½•', status: 'passed' },
                            { text: 'âœ… ä¿ç•™äº‹åŠ¡300çš„Undo Logè®°å½•', status: 'passed' }
                        ]
                    }
                ]
            },
            multiview: {
                title: 'å¤šè§†å›¾å¯¹æ¯”æ¼”ç¤º',
                subtitle: 'æ·±å…¥ç†è§£ReadViewåˆ¤æ–­æœºåˆ¶å’ŒMVCCå¦‚ä½•è§£å†³å¹¶å‘è¯»å†™é—®é¢˜',
                steps: [
                    {
                        title: 'ğŸš€ åˆå§‹åŒ–æ•°æ®ç¯å¢ƒ',
                        description: 'åˆ›å»ºåˆå§‹æ•°æ®è®°å½•ï¼Œå‡†å¤‡å¤šäº‹åŠ¡å¹¶å‘æ¼”ç¤ºã€‚',
                        explanation: 'å»ºç«‹åŸºç¡€æ•°æ®ç‰ˆæœ¬ï¼Œä¸ºåç»­çš„å¹¶å‘è¯»å†™æ¼”ç¤ºåšå‡†å¤‡ã€‚',
                        versions: [
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: true, current: true }
                        ],
                        undolog: [
                            { type: 'INSERT', trx_id: 100, operation: 'INSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', rollback_ptr: null }
                        ],
                        multiview: {
                            viewA: { trx_id: 200, data: null, status: 'preparing', readview: null },
                            viewB: { trx_id: 300, data: null, status: 'preparing', readview: null },
                            viewC: { trx_id: 400, data: null, status: 'preparing', readview: null }
                        },
                        readview: null,
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' }
                        ],
                        rules: [
                            { text: 'âœ… åˆå§‹æ•°æ®ç‰ˆæœ¬100å·²åˆ›å»º', status: 'passed' },
                            { text: 'ğŸ“ å‡†å¤‡å¯åŠ¨ä¸‰ä¸ªå¹¶å‘äº‹åŠ¡', status: 'checking' }
                        ]
                    },
                    {
                        title: 'ğŸ‘ï¸ äº‹åŠ¡Aåˆ›å»ºReadView',
                        description: 'äº‹åŠ¡200å¼€å§‹ï¼Œåˆ›å»ºReadView-Aå¹¶æ‰§è¡Œç¬¬ä¸€æ¬¡è¯»å–ã€‚',
                        explanation: 'ReadViewè®°å½•å½“å‰æ´»è·ƒäº‹åŠ¡åˆ—è¡¨ï¼Œå†³å®šå“ªäº›ç‰ˆæœ¬å¯¹å½“å‰äº‹åŠ¡å¯è§ã€‚',
                        versions: [
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: true, current: true }
                        ],
                        undolog: [
                            { type: 'INSERT', trx_id: 100, operation: 'INSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', rollback_ptr: null }
                        ],
                        multiview: {
                            viewA: { 
                                trx_id: 200, 
                                data: { name: 'å¼ ä¸‰', age: 25 }, 
                                status: 'reading',
                                readview: { m_ids: [200], min_trx_id: 200, max_trx_id: 201, creator_trx_id: 200 }
                            },
                            viewB: { trx_id: 300, data: null, status: 'preparing', readview: null },
                            viewC: { trx_id: 400, data: null, status: 'preparing', readview: null }
                        },
                        readview: {
                            m_ids: [200],
                            min_trx_id: 200,
                            max_trx_id: 201,
                            creator_trx_id: 200
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šBEGIN; åˆ›å»ºReadView-A', status: 'active' }
                        ],
                        rules: [
                            { text: 'ğŸ” æ£€æŸ¥ç‰ˆæœ¬100ï¼štrx_id(100) < min_trx_id(200)', status: 'passed' },
                            { text: 'âœ… ç‰ˆæœ¬100å¯¹äº‹åŠ¡Aå¯è§', status: 'passed' },
                            { text: 'ğŸ“– äº‹åŠ¡Aè¯»å–åˆ°ï¼š("å¼ ä¸‰", 25)', status: 'passed' }
                        ]
                    },
                    {
                        title: 'âœï¸ å¹¶å‘å†™å…¥æ“ä½œ',
                        description: 'äº‹åŠ¡250æ‰§è¡ŒUPDATEæ“ä½œï¼Œåˆ›å»ºæ–°ç‰ˆæœ¬ã€‚',
                        explanation: 'å†™æ“ä½œåˆ›å»ºæ–°çš„æ•°æ®ç‰ˆæœ¬å’ŒUndo Logè®°å½•ï¼Œä½†ä¸å½±å“å·²æœ‰ReadViewçš„å¯è§æ€§ã€‚',
                        versions: [
                            { id: 250, name: 'æå››', age: 25, visible: false, current: true },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: true, current: false }
                        ],
                        undolog: [
                            { type: 'UPDATE', trx_id: 250, operation: 'UPDATE users SET name="æå››" WHERE id=1', rollback_ptr: 'ptr_100' },
                            { type: 'INSERT', trx_id: 100, operation: 'INSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', rollback_ptr: null }
                        ],
                        multiview: {
                            viewA: { 
                                trx_id: 200, 
                                data: { name: 'å¼ ä¸‰', age: 25 }, 
                                status: 'reading',
                                readview: { m_ids: [200], min_trx_id: 200, max_trx_id: 201, creator_trx_id: 200 }
                            },
                            viewB: { trx_id: 300, data: null, status: 'preparing', readview: null },
                            viewC: { trx_id: 400, data: null, status: 'preparing', readview: null }
                        },
                        readview: {
                            m_ids: [200],
                            min_trx_id: 200,
                            max_trx_id: 201,
                            creator_trx_id: 200
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šBEGIN; åˆ›å»ºReadView-A', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡250ï¼šUPDATE users SET name="æå››"', status: 'completed' }
                        ],
                        rules: [
                            { text: 'ğŸ” äº‹åŠ¡Aæ£€æŸ¥ç‰ˆæœ¬250ï¼štrx_id(250) > max_trx_id(201)', status: 'checking' },
                            { text: 'âŒ ç‰ˆæœ¬250å¯¹äº‹åŠ¡Aä¸å¯è§', status: 'failed' },
                            { text: 'ğŸ”„ æ²¿ç‰ˆæœ¬é“¾æŸ¥æ‰¾ï¼š250 â†’ 100', status: 'passed' },
                            { text: 'âœ… äº‹åŠ¡Aä»è¯»å–ç‰ˆæœ¬100ï¼š("å¼ ä¸‰", 25)', status: 'passed' }
                        ]
                    },
                    {
                        title: 'ğŸ‘ï¸ äº‹åŠ¡Båˆ›å»ºReadView',
                        description: 'äº‹åŠ¡300å¼€å§‹ï¼Œåˆ›å»ºReadView-Bï¼Œèƒ½çœ‹åˆ°äº‹åŠ¡250çš„ä¿®æ”¹ã€‚',
                        explanation: 'æ–°çš„ReadViewèƒ½çœ‹åˆ°åœ¨å…¶åˆ›å»ºå‰å·²æäº¤çš„æ‰€æœ‰äº‹åŠ¡ä¿®æ”¹ã€‚',
                        versions: [
                            { id: 250, name: 'æå››', age: 25, visible: true, current: true },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: false, current: false }
                        ],
                        undolog: [
                            { type: 'UPDATE', trx_id: 250, operation: 'UPDATE users SET name="æå››" WHERE id=1', rollback_ptr: 'ptr_100' },
                            { type: 'INSERT', trx_id: 100, operation: 'INSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', rollback_ptr: null }
                        ],
                        multiview: {
                            viewA: { 
                                trx_id: 200, 
                                data: { name: 'å¼ ä¸‰', age: 25 }, 
                                status: 'reading',
                                readview: { m_ids: [200], min_trx_id: 200, max_trx_id: 201, creator_trx_id: 200 }
                            },
                            viewB: { 
                                trx_id: 300, 
                                data: { name: 'æå››', age: 25 }, 
                                status: 'reading',
                                readview: { m_ids: [200, 300], min_trx_id: 200, max_trx_id: 301, creator_trx_id: 300 }
                            },
                            viewC: { trx_id: 400, data: null, status: 'preparing', readview: null }
                        },
                        readview: {
                            m_ids: [200, 300],
                            min_trx_id: 200,
                            max_trx_id: 301,
                            creator_trx_id: 300
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šBEGIN; åˆ›å»ºReadView-A', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡250ï¼šUPDATE users SET name="æå››"', status: 'completed' },
                            { time: 'T4', event: 'äº‹åŠ¡300ï¼šBEGIN; åˆ›å»ºReadView-B', status: 'active' }
                        ],
                        rules: [
                            { text: 'ğŸ” äº‹åŠ¡Bæ£€æŸ¥ç‰ˆæœ¬250ï¼štrx_id(250) < min_trx_id(200)', status: 'passed' },
                            { text: 'âœ… ç‰ˆæœ¬250å¯¹äº‹åŠ¡Bå¯è§', status: 'passed' },
                            { text: 'ğŸ“– äº‹åŠ¡Bè¯»å–åˆ°ï¼š("æå››", 25)', status: 'passed' },
                            { text: 'ğŸ”„ äº‹åŠ¡Aä»ä½¿ç”¨æ—§ReadViewï¼Œè¯»å–ï¼š("å¼ ä¸‰", 25)', status: 'passed' }
                        ]
                    },
                    {
                        title: 'âœï¸ ç¬¬äºŒæ¬¡å¹¶å‘å†™å…¥',
                        description: 'äº‹åŠ¡350æ‰§è¡Œç¬¬äºŒæ¬¡UPDATEï¼Œè¿›ä¸€æ­¥æµ‹è¯•ReadViewéš”ç¦»æ€§ã€‚',
                        explanation: 'å¤šæ¬¡å†™å…¥æ“ä½œéªŒè¯MVCCçš„ç‰ˆæœ¬é“¾ç®¡ç†å’ŒReadViewçš„ä¸€è‡´æ€§ä¿è¯ã€‚',
                        versions: [
                            { id: 350, name: 'æå››', age: 30, visible: false, current: true },
                            { id: 250, name: 'æå››', age: 25, visible: false, current: false },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: false, current: false }
                        ],
                        undolog: [
                            { type: 'UPDATE', trx_id: 350, operation: 'UPDATE users SET age=30 WHERE id=1', rollback_ptr: 'ptr_250' },
                            { type: 'UPDATE', trx_id: 250, operation: 'UPDATE users SET name="æå››" WHERE id=1', rollback_ptr: 'ptr_100' },
                            { type: 'INSERT', trx_id: 100, operation: 'INSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', rollback_ptr: null }
                        ],
                        multiview: {
                            viewA: { 
                                trx_id: 200, 
                                data: { name: 'å¼ ä¸‰', age: 25 }, 
                                status: 'reading',
                                readview: { m_ids: [200], min_trx_id: 200, max_trx_id: 201, creator_trx_id: 200 }
                            },
                            viewB: { 
                                trx_id: 300, 
                                data: { name: 'æå››', age: 25 }, 
                                status: 'reading',
                                readview: { m_ids: [200, 300], min_trx_id: 200, max_trx_id: 301, creator_trx_id: 300 }
                            },
                            viewC: { trx_id: 400, data: null, status: 'preparing', readview: null }
                        },
                        readview: {
                            m_ids: [200, 300],
                            min_trx_id: 200,
                            max_trx_id: 301,
                            creator_trx_id: 300
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šBEGIN; åˆ›å»ºReadView-A', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡250ï¼šUPDATE users SET name="æå››"', status: 'completed' },
                            { time: 'T4', event: 'äº‹åŠ¡300ï¼šBEGIN; åˆ›å»ºReadView-B', status: 'active' },
                            { time: 'T5', event: 'äº‹åŠ¡350ï¼šUPDATE users SET age=30', status: 'completed' }
                        ],
                        rules: [
                            { text: 'ğŸ” äº‹åŠ¡Aæ£€æŸ¥ç‰ˆæœ¬350ï¼šä¸å¯è§ï¼ŒæŸ¥æ‰¾ç‰ˆæœ¬é“¾', status: 'checking' },
                            { text: 'ğŸ”„ ç‰ˆæœ¬é“¾éå†ï¼š350 â†’ 250 â†’ 100', status: 'passed' },
                            { text: 'âœ… äº‹åŠ¡Aè¯»å–ç‰ˆæœ¬100ï¼š("å¼ ä¸‰", 25)', status: 'passed' },
                            { text: 'ğŸ” äº‹åŠ¡Bæ£€æŸ¥ç‰ˆæœ¬350ï¼šä¸å¯è§ï¼Œè¯»å–ç‰ˆæœ¬250', status: 'passed' },
                            { text: 'âœ… äº‹åŠ¡Bè¯»å–ç‰ˆæœ¬250ï¼š("æå››", 25)', status: 'passed' }
                        ]
                    },
                    {
                        title: 'ğŸ‘ï¸ äº‹åŠ¡Cåˆ›å»ºReadView',
                        description: 'äº‹åŠ¡400å¼€å§‹ï¼Œåˆ›å»ºReadView-Cï¼Œå±•ç¤ºæœ€æ–°çš„æ•°æ®è§†å›¾ã€‚',
                        explanation: 'æœ€æ–°çš„ReadViewèƒ½çœ‹åˆ°æ‰€æœ‰å·²æäº¤çš„ä¿®æ”¹ï¼Œä½“ç°MVCCçš„æ—¶é—´ç‚¹ä¸€è‡´æ€§ã€‚',
                        versions: [
                            { id: 350, name: 'æå››', age: 30, visible: true, current: true },
                            { id: 250, name: 'æå››', age: 25, visible: false, current: false },
                            { id: 100, name: 'å¼ ä¸‰', age: 25, visible: false, current: false }
                        ],
                        undolog: [
                            { type: 'UPDATE', trx_id: 350, operation: 'UPDATE users SET age=30 WHERE id=1', rollback_ptr: 'ptr_250' },
                            { type: 'UPDATE', trx_id: 250, operation: 'UPDATE users SET name="æå››" WHERE id=1', rollback_ptr: 'ptr_100' },
                            { type: 'INSERT', trx_id: 100, operation: 'INSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', rollback_ptr: null }
                        ],
                        multiview: {
                            viewA: { 
                                trx_id: 200, 
                                data: { name: 'å¼ ä¸‰', age: 25 }, 
                                status: 'reading',
                                readview: { m_ids: [200], min_trx_id: 200, max_trx_id: 201, creator_trx_id: 200 }
                            },
                            viewB: { 
                                trx_id: 300, 
                                data: { name: 'æå››', age: 25 }, 
                                status: 'reading',
                                readview: { m_ids: [200, 300], min_trx_id: 200, max_trx_id: 301, creator_trx_id: 300 }
                            },
                            viewC: { 
                                trx_id: 400, 
                                data: { name: 'æå››', age: 30 }, 
                                status: 'reading',
                                readview: { m_ids: [200, 300, 400], min_trx_id: 200, max_trx_id: 401, creator_trx_id: 400 }
                            }
                        },
                        readview: {
                            m_ids: [200, 300, 400],
                            min_trx_id: 200,
                            max_trx_id: 401,
                            creator_trx_id: 400
                        },
                        timeline: [
                            { time: 'T1', event: 'äº‹åŠ¡100ï¼šINSERT INTO users VALUES(1, "å¼ ä¸‰", 25)', status: 'completed' },
                            { time: 'T2', event: 'äº‹åŠ¡200ï¼šBEGIN; åˆ›å»ºReadView-A', status: 'active' },
                            { time: 'T3', event: 'äº‹åŠ¡250ï¼šUPDATE users SET name="æå››"', status: 'completed' },
                            { time: 'T4', event: 'äº‹åŠ¡300ï¼šBEGIN; åˆ›å»ºReadView-B', status: 'active' },
                            { time: 'T5', event: 'äº‹åŠ¡350ï¼šUPDATE users SET age=30', status: 'completed' },
                            { time: 'T6', event: 'äº‹åŠ¡400ï¼šBEGIN; åˆ›å»ºReadView-C', status: 'active' }
                        ],
                        rules: [
                            { text: 'ğŸ” äº‹åŠ¡Cæ£€æŸ¥ç‰ˆæœ¬350ï¼štrx_id(350) < min_trx_id(200)', status: 'passed' },
                            { text: 'âœ… ç‰ˆæœ¬350å¯¹äº‹åŠ¡Cå¯è§', status: 'passed' },
                            { text: 'ğŸ“Š ä¸‰ä¸ªäº‹åŠ¡çš„è¯»å–ç»“æœå¯¹æ¯”ï¼š', status: 'passed' },
                            { text: '  â€¢ äº‹åŠ¡A(200)ï¼š("å¼ ä¸‰", 25) - æœ€æ—©çš„è§†å›¾', status: 'passed' },
                            { text: '  â€¢ äº‹åŠ¡B(300)ï¼š("æå››", 25) - ä¸­é—´çš„è§†å›¾', status: 'passed' },
                            { text: '  â€¢ äº‹åŠ¡C(400)ï¼š("æå››", 30) - æœ€æ–°çš„è§†å›¾', status: 'passed' },
                            { text: 'ğŸ¯ MVCCæˆåŠŸè§£å†³å¹¶å‘è¯»å†™å†²çªï¼', status: 'passed' }
                        ]
                    }
                ]
            }
        };

        // åˆå§‹åŒ–æ¼”ç¤º
        function initDemo() {
            updateStepContent();
            updateProgress();
            updateButtons();
            updateStepIndicator();
            updateVisualization();
        }

        // é€‰æ‹©åœºæ™¯
        function selectScenario(scenario) {
            currentScenario = scenario;
            currentStep = 1;
            
            // æ›´æ–°åœºæ™¯æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.scenario-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // æ›´æ–°æ ‡é¢˜
            const config = scenarios[scenario];
            document.getElementById('workflow-title').textContent = config.title;
            document.getElementById('workflow-subtitle').textContent = config.subtitle;
            
            // æ§åˆ¶å¤šè§†å›¾å®¹å™¨çš„æ˜¾ç¤º
            const multiViewContainer = document.getElementById('multi-view-container');
            if (scenario === 'multiview') {
                multiViewContainer.style.display = 'block';
            } else {
                multiViewContainer.style.display = 'none';
            }
            
            // æ›´æ–°æ˜¾ç¤º
            updateStepContent();
            updateProgress();
            updateButtons();
            updateStepIndicator();
            updateVisualization();
        }

        // ä¸‹ä¸€æ­¥
        function nextStep() {
            if (currentStep < scenarios[currentScenario].steps.length) {
                currentStep++;
                updateStepContent();
                updateProgress();
                updateButtons();
                updateStepIndicator();
                updateVisualization();
            }
        }

        // ä¸Šä¸€æ­¥
        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepContent();
                updateProgress();
                updateButtons();
                updateStepIndicator();
                updateVisualization();
            }
        }

        // é‡ç½®æ¼”ç¤º
        function resetDemo() {
            currentStep = 1;
            updateStepContent();
            updateProgress();
            updateButtons();
            updateStepIndicator();
            updateVisualization();
        }

        // æ›´æ–°æ­¥éª¤å†…å®¹
        function updateStepContent() {
            const step = scenarios[currentScenario].steps[currentStep - 1];
            const content = document.getElementById('step-content');
            
            content.innerHTML = `
                <div class="step-title">
                    ${step.title}
                </div>
                <div class="step-description">
                    ${step.description}
                </div>
                <div class="highlight-box">
                    <strong>è¯´æ˜ï¼š</strong>${step.explanation}
                </div>
            `;
        }

        // æ›´æ–°è¿›åº¦æ¡
        function updateProgress() {
            const progress = (currentStep / scenarios[currentScenario].steps.length) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
        }

        // æ›´æ–°æŒ‰é’®çŠ¶æ€
        function updateButtons() {
            const nextBtn = document.getElementById('next-button');
            const prevBtn = document.getElementById('prev-button');
            
            nextBtn.disabled = currentStep >= scenarios[currentScenario].steps.length;
            prevBtn.disabled = currentStep <= 1;
            
            if (nextBtn.disabled) {
                nextBtn.textContent = 'æ¼”ç¤ºå®Œæˆ';
            } else {
                nextBtn.textContent = 'ä¸‹ä¸€æ­¥';
            }
        }

        // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
        function updateStepIndicator() {
            const totalSteps = scenarios[currentScenario].steps.length;
            const indicator = document.getElementById('step-indicator');
            
            // æ¸…ç©ºç°æœ‰æ­¥éª¤
            indicator.innerHTML = '';
            
            // åˆ›å»ºæ­¥éª¤åœ†åœˆ
            for (let i = 1; i <= totalSteps; i++) {
                const step = document.createElement('div');
                step.className = 'step';
                step.textContent = i;
                step.id = `step-${i}`;
                
                if (i < currentStep) {
                    step.classList.add('completed');
                } else if (i === currentStep) {
                    step.classList.add('active');
                }
                
                indicator.appendChild(step);
            }
        }

        // æ›´æ–°å¯è§†åŒ–
        function updateVisualization() {
            const step = scenarios[currentScenario].steps[currentStep - 1];
            
            // æ›´æ–°ç‰ˆæœ¬é“¾
            updateVersionChain(step.versions);
            
            // æ›´æ–°Undo Log
            updateUndoLog(step.undolog);
            
            // æ›´æ–°ReadView
            updateReadView(step.readview);
            
            // æ›´æ–°å¤šè§†å›¾
            updateMultiView(step.multiview);
            
            // æ›´æ–°æ—¶é—´çº¿
            updateTimeline(step.timeline);
            
            // æ›´æ–°è§„åˆ™
            updateRules(step.rules);
        }

        // æ›´æ–°ç‰ˆæœ¬é“¾
        function updateVersionChain(versions) {
            const container = document.getElementById('version-chain');
            container.innerHTML = '';
            
            if (!versions || versions.length === 0) {
                container.innerHTML = '<div class="version-item">æš‚æ— ç‰ˆæœ¬æ•°æ®</div>';
                return;
            }
            
            versions.forEach((version, index) => {
                const versionDiv = document.createElement('div');
                versionDiv.className = 'version-item';
                
                if (version.current) {
                    versionDiv.classList.add('current');
                } else if (version.visible) {
                    versionDiv.classList.add('visible');
                } else {
                    versionDiv.classList.add('invisible');
                }
                
                versionDiv.innerHTML = `
                    <strong>ç‰ˆæœ¬ ${index + 1}</strong><br>
                    <strong>äº‹åŠ¡ID:</strong> ${version.id}<br>
                    <strong>æ•°æ®:</strong> name='${version.name}', age=${version.age}<br>
                    <strong>çŠ¶æ€:</strong> ${version.current ? 'å½“å‰ç‰ˆæœ¬' : version.visible ? 'å¯è§' : 'ä¸å¯è§'}
                `;
                
                container.appendChild(versionDiv);
            });
        }

        // æ›´æ–°ReadView
        function updateReadView(readview) {
            const container = document.getElementById('readview-info');
            
            if (!readview) {
                container.innerHTML = '<div class="readview-info">å°šæœªåˆ›å»ºReadView</div>';
                return;
            }
            
            container.innerHTML = `
                <div class="readview-info">
                    <strong>m_ids:</strong> [${readview.m_ids.join(', ')}]<br>
                    <small>æ´»è·ƒäº‹åŠ¡åˆ—è¡¨</small>
                </div>
                <div class="readview-info">
                    <strong>min_trx_id:</strong> ${readview.min_trx_id}<br>
                    <small>æœ€å°æ´»è·ƒäº‹åŠ¡ID</small>
                </div>
                <div class="readview-info">
                    <strong>max_trx_id:</strong> ${readview.max_trx_id}<br>
                    <small>ä¸‹ä¸€ä¸ªäº‹åŠ¡ID</small>
                </div>
                <div class="readview-info">
                    <strong>creator_trx_id:</strong> ${readview.creator_trx_id}<br>
                    <small>åˆ›å»ºè€…äº‹åŠ¡ID</small>
                </div>
            `;
        }

        // æ›´æ–°æ—¶é—´çº¿
        function updateTimeline(timeline) {
            const container = document.getElementById('transaction-timeline');
            container.innerHTML = '';
            
            timeline.forEach(item => {
                const timelineDiv = document.createElement('div');
                timelineDiv.className = 'timeline-item';
                
                if (item.status === 'active') {
                    timelineDiv.classList.add('active');
                } else if (item.status === 'completed') {
                    timelineDiv.classList.add('completed');
                }
                
                timelineDiv.innerHTML = `
                    <div class="timeline-time">${item.time}</div>
                    <div class="timeline-event">${item.event}</div>
                `;
                
                container.appendChild(timelineDiv);
            });
        }

        // æ›´æ–°Undo Log
        function updateUndoLog(undolog) {
            const container = document.getElementById('undo-log');
            
            if (!undolog || undolog.length === 0) {
                container.innerHTML = '<div class="undo-log-item">æš‚æ— Undo Logè®°å½•</div>';
                return;
            }
            
            container.innerHTML = '';
            
            undolog.forEach((log, index) => {
                const logDiv = document.createElement('div');
                logDiv.className = 'undo-log-item';
                
                logDiv.innerHTML = `
                    <div class="undo-log-header">
                        <strong>Undo Log ${index + 1}</strong>
                        <span class="undo-log-type">${log.type}</span>
                    </div>
                    <div class="undo-log-content">
                        <strong>äº‹åŠ¡ID:</strong> ${log.trx_id}<br>
                        <strong>æ“ä½œ:</strong> ${log.operation}<br>
                        <strong>å›æ»šæŒ‡é’ˆ:</strong> ${log.rollback_ptr || 'NULL'}
                    </div>
                `;
                
                container.appendChild(logDiv);
            });
        }

        // æ›´æ–°å¤šè§†å›¾
        function updateMultiView(multiview) {
            if (!multiview) return;
            
            // è¾…åŠ©å‡½æ•°ï¼šç”ŸæˆçŠ¶æ€æ–‡æœ¬
            function getStatusText(status) {
                switch(status) {
                    case 'preparing': return 'å‡†å¤‡ä¸­';
                    case 'reading': return 'æ­£åœ¨è¯»å–';
                    case 'waiting': return 'ç­‰å¾…ä¸­';
                    case 'completed': return 'å·²å®Œæˆ';
                    default: return status;
                }
            }
            
            // è¾…åŠ©å‡½æ•°ï¼šç”Ÿæˆè§†å›¾å†…å®¹
            function generateViewContent(view) {
                let content = `
                    <div class="view-status ${view.status}">
                        äº‹åŠ¡${view.trx_id} - ${getStatusText(view.status)}
                    </div>
                `;
                
                if (view.data) {
                    content += `
                        <div class="view-data">
                            <div class="data-section">
                                <h4>ğŸ“– è¯»å–ç»“æœ</h4>
                                <div class="data-row">
                                    <span class="data-label">å§“å:</span>
                                    <span class="data-value">${view.data.name}</span>
                                </div>
                                <div class="data-row">
                                    <span class="data-label">å¹´é¾„:</span>
                                    <span class="data-value">${view.data.age}</span>
                                </div>
                            </div>
                    `;
                    
                    // å¦‚æœæœ‰ReadViewä¿¡æ¯ï¼Œæ˜¾ç¤ºReadViewè¯¦æƒ…
                    if (view.readview) {
                        content += `
                            <div class="data-section">
                                <h4>ğŸ‘ï¸ ReadViewè¯¦æƒ…</h4>
                                <div class="readview-info">
                                    <div class="readview-item">
                                        <span class="readview-label">æ´»è·ƒäº‹åŠ¡:</span>
                                        <span class="readview-value">[${view.readview.m_ids.join(', ')}]</span>
                                    </div>
                                    <div class="readview-item">
                                        <span class="readview-label">æœ€å°äº‹åŠ¡ID:</span>
                                        <span class="readview-value">${view.readview.min_trx_id}</span>
                                    </div>
                                    <div class="readview-item">
                                        <span class="readview-label">æœ€å¤§äº‹åŠ¡ID:</span>
                                        <span class="readview-value">${view.readview.max_trx_id}</span>
                                    </div>
                                    <div class="readview-item">
                                        <span class="readview-label">åˆ›å»ºè€…ID:</span>
                                        <span class="readview-value">${view.readview.creator_trx_id}</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                    
                    content += '</div>';
                } else {
                    content += `
                        <div class="view-data">
                            <div class="no-data">
                                <div class="waiting-icon">â³</div>
                                <div class="waiting-text">ç­‰å¾…äº‹åŠ¡å¼€å§‹...</div>
                            </div>
                        </div>
                    `;
                }
                
                return content;
            }
            
            // æ›´æ–°äº‹åŠ¡Aè§†å›¾
            const viewA = document.getElementById('view-a');
            if (multiview.viewA && viewA) {
                viewA.innerHTML = generateViewContent(multiview.viewA);
            }
            
            // æ›´æ–°äº‹åŠ¡Bè§†å›¾
            const viewB = document.getElementById('view-b');
            if (multiview.viewB && viewB) {
                viewB.innerHTML = generateViewContent(multiview.viewB);
            }
            
            // æ›´æ–°äº‹åŠ¡Cè§†å›¾
            const viewC = document.getElementById('view-c');
            if (multiview.viewC && viewC) {
                viewC.innerHTML = generateViewContent(multiview.viewC);
            }
        }

        // æ›´æ–°è§„åˆ™
        function updateRules(rules) {
            const container = document.getElementById('visibility-rules');
            
            if (!rules || rules.length === 0) {
                container.innerHTML = '<div class="rules-title">ğŸ” å¯è§æ€§åˆ¤æ–­è§„åˆ™</div><div class="rule-item">ç­‰å¾…åˆ¤æ–­...</div>';
                return;
            }
            
            let rulesHTML = '<div class="rules-title">ğŸ” å¯è§æ€§åˆ¤æ–­è§„åˆ™</div>';
            
            rules.forEach(rule => {
                rulesHTML += `<div class="rule-item ${rule.status}">${rule.text}</div>`;
            });
            
            container.innerHTML = rulesHTML;
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initDemo);
    </script>
</body>
</html>