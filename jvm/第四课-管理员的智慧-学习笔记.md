# ç¬¬å››è¯¾ï¼šç®¡ç†å‘˜çš„æ™ºæ…§ - åƒåœ¾å›æ”¶ç­–ç•¥å¤§æ­ç§˜

> JVMåƒåœ¾æ”¶é›†å™¨çš„å·¥ä½œåŸç†ä¸ç­–ç•¥é€‰æ‹©

---

*æœ¬è¯¾ç¨‹åŸºäºOracle JVM Specificationå’ŒOpenJDKæºç ï¼Œç¡®ä¿æŠ€æœ¯å†…å®¹çš„å‡†ç¡®æ€§å’Œæƒå¨æ€§ã€‚*

## ğŸ¯ å¼€ç¯‡é—®é¢˜

ä¸ŠèŠ‚è¯¾æˆ‘ä»¬è®¤è¯†äº†JVMè¿™ä½"æ”¶å®¹æ‰€ç®¡ç†å‘˜"ï¼ŒçŸ¥é“äº†å®ƒä¼šè‡ªåŠ¨æ¸…ç†"æ— ä¸»"å¯¹è±¡ã€‚ä½†æ˜¯é¢å¯¹ä¸€ä¸ªå·¨å¤§çš„"æ”¶å®¹æ‰€"ï¼Œç®¡ç†å‘˜æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿ

æƒ³è±¡ä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ï¼š
```java
// ä¸€ä¸ªæ‹¥æœ‰ç™¾ä¸‡"å±…æ°‘"çš„æ”¶å®¹æ‰€
public class MassiveObjectShelter {
    public static void main(String[] args) {
        List<Object> residents = new ArrayList<>();
        
        // åˆ›å»º100ä¸‡ä¸ª"å±…æ°‘"
        for (int i = 0; i < 1000000; i++) {
            residents.add(new Object());
        }
        
        // çªç„¶è®©ä¸€åŠ"å±…æ°‘"å¤±å»"ä¸»äºº"
        for (int i = 0; i < 500000; i++) {
            residents.set(i, null);
        }
        
        // ç®¡ç†å‘˜å¦‚ä½•å¿«é€Ÿæ‰¾åˆ°è¿™50ä¸‡"æ— ä¸»å¯¹è±¡"ï¼Ÿ
        System.gc();
    }
}
```

**æ ¸å¿ƒç–‘é—®ï¼š**
- ç®¡ç†å‘˜å¦‚ä½•åœ¨100ä¸‡"å±…æ°‘"ä¸­å¿«é€Ÿæ‰¾åˆ°50ä¸‡"æ— ä¸»å¯¹è±¡"ï¼Ÿ
- ä¸ºä»€ä¹ˆæœ‰æ—¶å€™æ¸…ç†å·¥ä½œä¼šè®©ç¨‹åº"å¡é¡¿"ï¼Ÿ
- ä¸åŒç±»å‹çš„"æ”¶å®¹æ‰€"éœ€è¦ä¸åŒçš„ç®¡ç†ç­–ç•¥å—ï¼Ÿ

## ğŸ” æ ¸å¿ƒè®¤çŸ¥

é€šè¿‡ä¸‰ä¸ªå…³é”®å®éªŒï¼Œæˆ‘ä»¬å°†å‘ç°"ç®¡ç†å‘˜"å·¥ä½œçš„ä¸‰å¤§æ™ºæ…§ï¼š

### ğŸ¯ ç°è±¡ä¸€ï¼š"ä¾¦æ¢"ç®—æ³• - å¦‚ä½•å¿«é€Ÿæ‰¾åˆ°"æ— ä¸»å¯¹è±¡"

**å®éªŒè®¾è®¡ï¼š**
```java
// DetectiveAlgorithm.java
import java.util.ArrayList;
import java.util.List;

public class DetectiveAlgorithm {
    // æ¨¡æ‹Ÿ"æ ¹æ®åœ°" - æ°¸è¿œä¸ä¼šè¢«æ¸…ç†çš„åœ°æ–¹
    private static List<Object> headquarters = new ArrayList<>();
    
    public static void main(String[] args) {
        System.out.println("=== ä¾¦æ¢ç®—æ³•å®éªŒ ===");
        
        // é˜¶æ®µ1ï¼šå»ºç«‹"æœ‹å‹ç½‘ç»œ"
        Object boss = new Object();  // "è€å¤§"
        Object friend1 = new Object();  // "æœ‹å‹1"
        Object friend2 = new Object();  // "æœ‹å‹2"
        Object lostObject = new Object();   // "å¤±è”å¯¹è±¡"
        
        // å»ºç«‹å¼•ç”¨å…³ç³» - "æœ‹å‹ç½‘ç»œ"
        headquarters.add(boss);  // è€å¤§ä½åœ¨"æ ¹æ®åœ°"
        // boss -> friend1 -> friend2 (æœ‹å‹é“¾)
        // orphan æ²¡æœ‰æœ‹å‹
        
        System.out.println("é˜¶æ®µ1ï¼šæœ‹å‹ç½‘ç»œå»ºç«‹å®Œæˆ");
        System.out.println("- è€å¤§æœ‰æ ¹æ®åœ°ä¿æŠ¤");
        System.out.println("- æœ‹å‹1è¢«è€å¤§è®¤è¯†");
        System.out.println("- æœ‹å‹2è¢«æœ‹å‹1è®¤è¯†");
        System.out.println("- å¤±è”å¯¹è±¡æ²¡æœ‰ä»»ä½•æœ‹å‹");
        
        // é˜¶æ®µ2ï¼š"ä¾¦æ¢"å¼€å§‹å·¥ä½œ
        System.out.println("\né˜¶æ®µ2ï¼šä¾¦æ¢å¼€å§‹å¯»æ‰¾å¤±è”å¯¹è±¡...");
        simulateGCDetection();
        
        System.out.println("=== å®éªŒç»“æŸ ===");
    }
    
    private static void simulateGCDetection() {
        System.out.println("ä¾¦æ¢å·¥ä½œæµç¨‹ï¼š");
        System.out.println("1. ä»'æ ¹æ®åœ°'å¼€å§‹æœç´¢");
        System.out.println("2. æ ‡è®°æ‰€æœ‰èƒ½æ‰¾åˆ°çš„'å±…æ°‘'");
        System.out.println("3. æ²¡è¢«æ ‡è®°çš„å°±æ˜¯'å¤±è”å¯¹è±¡'");
        System.out.println("4. æ¸…ç†æ‰€æœ‰'å¤±è”å¯¹è±¡'");
        
        // è§¦å‘åƒåœ¾å›æ”¶è§‚å¯Ÿ
        System.gc();
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        
        System.out.println("ä¾¦æ¢å·¥ä½œå®Œæˆï¼");
    }
}
```

**å®éªŒè§‚å¯Ÿï¼š**
```bash
javac DetectiveAlgorithm.java
java -XX:+PrintGC -XX:+PrintGCDetails DetectiveAlgorithm
```

**ä½ ä¼šå‘ç°ï¼š**
- "ä¾¦æ¢"ä»"æ ¹æ®åœ°"å¼€å§‹æœç´¢
- é€šè¿‡"æœ‹å‹å…³ç³»"æ‰¾åˆ°æ‰€æœ‰æœ‰ä¸»äººçš„å¯¹è±¡
- æ²¡æ‰¾åˆ°çš„å°±æ˜¯"å¤±è”å¯¹è±¡"ï¼Œä¼šè¢«æ¸…ç†

### ğŸ¯ ç°è±¡äºŒï¼šä¸åŒçš„"æ¸…ç†ç­–ç•¥" - å„æœ‰ä¼˜ç¼ºç‚¹

**å®éªŒè®¾è®¡ï¼š**
```java
// CleaningStrategy.java
import java.util.ArrayList;
import java.util.List;

public class CleaningStrategy {
    public static void main(String[] args) {
        System.out.println("=== æ¸…ç†ç­–ç•¥å¯¹æ¯”å®éªŒ ===");
        
        // ç­–ç•¥ä¸€ï¼š"æ ‡è®°-æ¸…é™¤"ç­–ç•¥
        System.out.println("\nç­–ç•¥ä¸€ï¼šæ ‡è®°-æ¸…é™¤ç­–ç•¥");
        testMarkAndSweep();
        
        // ç­–ç•¥äºŒï¼š"å¤åˆ¶æ¬å®¶"ç­–ç•¥  
        System.out.println("\nç­–ç•¥äºŒï¼šå¤åˆ¶æ¬å®¶ç­–ç•¥");
        testCopying();
        
        // ç­–ç•¥ä¸‰ï¼š"æ ‡è®°-æ•´ç†"ç­–ç•¥
        System.out.println("\nç­–ç•¥ä¸‰ï¼šæ ‡è®°-æ•´ç†ç­–ç•¥");
        testMarkAndCompact();
        
        System.out.println("=== å®éªŒç»“æŸ ===");
    }
    
    private static void testMarkAndSweep() {
        System.out.println("å·¥ä½œæ–¹å¼ï¼š");
        System.out.println("1. æ ‡è®°æ‰€æœ‰åƒåœ¾å¯¹è±¡");
        System.out.println("2. æ¸…é™¤åƒåœ¾å¯¹è±¡");
        System.out.println("ä¼˜ç‚¹ï¼šç®€å•ç›´æ¥");
        System.out.println("ç¼ºç‚¹ï¼šä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡");
        
        // æ¨¡æ‹Ÿäº§ç”Ÿç¢ç‰‡
        List<byte[]> objects = new ArrayList<>();
        for (int i = 0; i < 100; i++) {
            if (i % 2 == 0) {
                objects.add(new byte[1024]); // ä¿ç•™
            } else {
                objects.add(null); // æ¸…é™¤ï¼Œäº§ç”Ÿç¢ç‰‡
            }
        }
    }
    
    private static void testCopying() {
        System.out.println("å·¥ä½œæ–¹å¼ï¼š");
        System.out.println("1. å°†æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°æ–°åŒºåŸŸ");
        System.out.println("2. æ¸…ç©ºåŸåŒºåŸŸ");
        System.out.println("ä¼˜ç‚¹ï¼šæ²¡æœ‰ç¢ç‰‡ï¼Œé€Ÿåº¦å¿«");
        System.out.println("ç¼ºç‚¹ï¼šéœ€è¦åŒå€å†…å­˜ç©ºé—´");
        
        // æ¨¡æ‹Ÿå¤åˆ¶è¿‡ç¨‹
        List<Object> oldArea = new ArrayList<>();
        List<Object> newArea = new ArrayList<>();
        
        // æ·»åŠ å¯¹è±¡åˆ°æ—§åŒºåŸŸ
        for (int i = 0; i < 50; i++) {
            oldArea.add(new Object());
        }
        
        // å¤åˆ¶å­˜æ´»å¯¹è±¡åˆ°æ–°åŒºåŸŸ
        for (Object obj : oldArea) {
            if (obj != null) {
                newArea.add(obj);
            }
        }
        
        // æ¸…ç©ºæ—§åŒºåŸŸ
        oldArea.clear();
    }
    
    private static void testMarkAndCompact() {
        System.out.println("å·¥ä½œæ–¹å¼ï¼š");
        System.out.println("1. æ ‡è®°åƒåœ¾å¯¹è±¡");
        System.out.println("2. å°†æ´»ç€çš„å¯¹è±¡å‘ä¸€ç«¯ç§»åŠ¨");
        System.out.println("3. æ¸…ç†å¦ä¸€ç«¯çš„åƒåœ¾");
        System.out.println("ä¼˜ç‚¹ï¼šæ²¡æœ‰ç¢ç‰‡ï¼Œä¸éœ€è¦åŒå€ç©ºé—´");
        System.out.println("ç¼ºç‚¹ï¼šç§»åŠ¨å¯¹è±¡éœ€è¦æ—¶é—´");
        
        // æ¨¡æ‹Ÿæ•´ç†è¿‡ç¨‹
        Object[] memory = new Object[100];
        
        // å¡«å……å¯¹è±¡ï¼ˆæ¨¡æ‹Ÿç¢ç‰‡åŒ–ï¼‰
        for (int i = 0; i < 100; i += 2) {
            memory[i] = new Object(); // å­˜æ´»å¯¹è±¡
            // memory[i+1] ä¿æŒnullï¼ˆåƒåœ¾å¯¹è±¡ï¼‰
        }
        
        // æ•´ç†ï¼šå°†å­˜æ´»å¯¹è±¡ç§»åˆ°å‰é¢
        int writeIndex = 0;
        for (int readIndex = 0; readIndex < memory.length; readIndex++) {
            if (memory[readIndex] != null) {
                memory[writeIndex++] = memory[readIndex];
            }
        }
        
        // æ¸…ç†åé¢çš„ç©ºé—´
        for (int i = writeIndex; i < memory.length; i++) {
            memory[i] = null;
        }
    }
}
```

**ä½ ä¼šå‘ç°ï¼š**
- **æ ‡è®°-æ¸…é™¤**ï¼šç®€å•ä½†ä¼šäº§ç”Ÿç¢ç‰‡
- **å¤åˆ¶æ¬å®¶**ï¼šå¿«é€Ÿä½†éœ€è¦åŒå€ç©ºé—´
- **æ ‡è®°-æ•´ç†**ï¼šå¹³è¡¡ä½†ç§»åŠ¨è€—æ—¶

### ğŸ¯ ç°è±¡ä¸‰ï¼š"åˆ†ä»£ç®¡ç†" - å¹´è½»äººå’Œè€å¹´äººçš„ä¸åŒå¾…é‡

**å®éªŒè®¾è®¡ï¼š**
```java
// GenerationalManagement.java
import java.util.ArrayList;
import java.util.List;

public class GenerationalManagement {
    // æ¨¡æ‹Ÿ"å¹´è½»äººåŒºåŸŸ"
    private static List<Object> youngGeneration = new ArrayList<>();
    // æ¨¡æ‹Ÿ"è€å¹´äººåŒºåŸŸ"
    private static List<Object> oldGeneration = new ArrayList<>();
    
    public static void main(String[] args) {
        System.out.println("=== åˆ†ä»£ç®¡ç†å®éªŒ ===");
        
        // è§‚å¯Ÿå¹´è½»å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ
        System.out.println("\né˜¶æ®µ1ï¼šè§‚å¯Ÿå¹´è½»å¯¹è±¡");
        observeYoungObjects();
        
        // è§‚å¯Ÿè€å¹´å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ
        System.out.println("\né˜¶æ®µ2ï¼šè§‚å¯Ÿè€å¹´å¯¹è±¡");
        observeOldObjects();
        
        // å¯¹æ¯”æ¸…ç†é¢‘ç‡
        System.out.println("\né˜¶æ®µ3ï¼šå¯¹æ¯”æ¸…ç†é¢‘ç‡");
        compareCleaningFrequency();
        
        System.out.println("=== å®éªŒç»“æŸ ===");
    }
    
    private static void observeYoungObjects() {
        System.out.println("å¹´è½»å¯¹è±¡ç‰¹ç‚¹ï¼š");
        
        for (int round = 0; round < 5; round++) {
            System.out.println("ç¬¬" + (round + 1) + "è½®ï¼š");
            
            // åˆ›å»ºå¤§é‡çŸ­å‘½å¯¹è±¡
            List<String> tempObjects = new ArrayList<>();
            for (int i = 0; i < 10000; i++) {
                tempObjects.add("çŸ­å‘½å¯¹è±¡" + i);
            }
            
            System.out.println("- åˆ›å»ºäº†10000ä¸ªå¹´è½»å¯¹è±¡");
            
            // åªä¿ç•™å°‘æ•°å¯¹è±¡
            for (int i = 0; i < 100; i++) {
                youngGeneration.add(tempObjects.get(i));
            }
            
            // å…¶ä½™å¯¹è±¡å¤±å»å¼•ç”¨ï¼ˆå˜æˆåƒåœ¾ï¼‰
            tempObjects.clear();
            System.out.println("- 9900ä¸ªå¯¹è±¡æˆä¸ºåƒåœ¾");
            System.out.println("- 100ä¸ªå¯¹è±¡å­˜æ´»");
            
            // è§¦å‘å¹´è½»ä»£åƒåœ¾å›æ”¶
            System.gc();
            
            try {
                Thread.sleep(500);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        
        System.out.println("å¹´è½»å¯¹è±¡æ€»ç»“ï¼šå¤§éƒ¨åˆ†å¾ˆå¿«æ­»äº¡ï¼Œå°‘æ•°å­˜æ´»");
    }
    
    private static void observeOldObjects() {
        System.out.println("è€å¹´å¯¹è±¡ç‰¹ç‚¹ï¼š");
        
        // å°†å­˜æ´»çš„å¹´è½»å¯¹è±¡"æ™‹å‡"ä¸ºè€å¹´å¯¹è±¡
        oldGeneration.addAll(youngGeneration);
        System.out.println("- å­˜æ´»çš„å¹´è½»å¯¹è±¡æ™‹å‡ä¸ºè€å¹´å¯¹è±¡");
        
        // è€å¹´å¯¹è±¡å¾ˆå°‘å˜åŒ–
        for (int round = 0; round < 10; round++) {
            System.out.println("ç¬¬" + (round + 1) + "è½®æ£€æŸ¥ï¼šè€å¹´å¯¹è±¡ä¾ç„¶å­˜æ´»");
            
            try {
                Thread.sleep(200);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        
        System.out.println("è€å¹´å¯¹è±¡æ€»ç»“ï¼šç”Ÿå‘½åŠ›é¡½å¼ºï¼Œå¾ˆå°‘æ­»äº¡");
    }
    
    private static void compareCleaningFrequency() {
        System.out.println("ç®¡ç†ç­–ç•¥å¯¹æ¯”ï¼š");
        System.out.println("å¹´è½»äººåŒºåŸŸï¼š");
        System.out.println("- æ¸…ç†é¢‘ç‡ï¼šå¾ˆé«˜ï¼ˆå› ä¸ºåƒåœ¾å¤šï¼‰");
        System.out.println("- æ¸…ç†ç­–ç•¥ï¼šå¤åˆ¶æ¬å®¶ï¼ˆå¿«é€Ÿï¼‰");
        System.out.println("- æ¸…ç†æˆæœ¬ï¼šä½ï¼ˆå¯¹è±¡å°‘ï¼‰");
        
        System.out.println("\nè€å¹´äººåŒºåŸŸï¼š");
        System.out.println("- æ¸…ç†é¢‘ç‡ï¼šå¾ˆä½ï¼ˆå› ä¸ºåƒåœ¾å°‘ï¼‰");
        System.out.println("- æ¸…ç†ç­–ç•¥ï¼šæ ‡è®°-æ•´ç†ï¼ˆå½»åº•ï¼‰");
        System.out.println("- æ¸…ç†æˆæœ¬ï¼šé«˜ï¼ˆå¯¹è±¡å¤šï¼‰");
        
        System.out.println("\næ™ºæ…§æ€»ç»“ï¼š");
        System.out.println("- å¹´è½»äººï¼šé¢‘ç¹å¿«é€Ÿæ¸…ç†");
        System.out.println("- è€å¹´äººï¼šå¶å°”å½»åº•æ¸…ç†");
        System.out.println("- è¿™æ ·æ—¢ä¿è¯æ•ˆç‡ï¼ŒåˆèŠ‚çœèµ„æºï¼");
    }
}
```

**å®éªŒè§‚å¯Ÿï¼š**
```bash
javac GenerationalManagement.java
java -XX:+PrintGC -XX:+PrintGCDetails -Xms100m -Xmx200m GenerationalManagement
```

**ä½ ä¼šå‘ç°ï¼š**
- å¹´è½»å¯¹è±¡ï¼šå¤§éƒ¨åˆ†å¾ˆå¿«"æ­»äº¡"
- è€å¹´å¯¹è±¡ï¼šç”Ÿå‘½åŠ›é¡½å¼º
- ç®¡ç†å‘˜é‡‡ç”¨ä¸åŒç­–ç•¥ï¼šå¹´è½»äººé¢‘ç¹æ¸…ç†ï¼Œè€å¹´äººå¶å°”æ¸…ç†

## ğŸ” æ·±å…¥ç†è§£ï¼š"ç®¡ç†å‘˜"çš„å·¥ä½œæ™ºæ…§

é€šè¿‡ä¸‰ä¸ªå®éªŒï¼Œæˆ‘ä»¬å‘ç°äº†"ç®¡ç†å‘˜"çš„ä¸‰å¤§å·¥ä½œæ™ºæ…§ï¼š

### ğŸ“– æ™ºæ…§ä¸€ï¼š"ä¾¦æ¢"ç®—æ³•çš„ç§˜å¯†

æƒ³è±¡"ç®¡ç†å‘˜"å°±åƒä¸€ä¸ªè¶…çº§ä¾¦æ¢ï¼š

#### ğŸ” "æ ¹æ®åœ°"æœç´¢æ³•
```
1. ä»"æ ¹æ®åœ°"å¼€å§‹ï¼ˆæ ˆã€é™æ€å˜é‡ç­‰ï¼‰
2. æ²¿ç€"æœ‹å‹å…³ç³»"ï¼ˆå¼•ç”¨é“¾ï¼‰æœç´¢
3. èƒ½æ‰¾åˆ°çš„éƒ½æ˜¯"æœ‰ä¸»äººçš„"
4. æ‰¾ä¸åˆ°çš„å°±æ˜¯"å¤±è”å¯¹è±¡"
```

**ç”Ÿæ´»ç±»æ¯”ï¼š**
- å°±åƒè­¦å¯Ÿé€šè¿‡"äººé™…å…³ç³»ç½‘"æ‰¾äºº
- ä»å·²çŸ¥çš„"æ ¹æ®åœ°"å¼€å§‹
- é€šè¿‡"æœ‹å‹ä»‹ç»æœ‹å‹"çš„æ–¹å¼
- æ‰¾ä¸åˆ°çš„å°±æ˜¯"å¤±è”äººå‘˜"

#### ğŸ¯ "å¯è¾¾æ€§åˆ†æ"ç®—æ³•
è¿™å°±æ˜¯JVMä½¿ç”¨çš„æ ¸å¿ƒç®—æ³•ï¼š
- **GC Roots**ï¼š"æ ¹æ®åœ°"ï¼ˆæ ˆå˜é‡ã€é™æ€å˜é‡ã€å¸¸é‡ç­‰ï¼‰
- **å¼•ç”¨é“¾**ï¼š"æœ‹å‹å…³ç³»ç½‘"
- **å¯è¾¾å¯¹è±¡**ï¼šæœ‰"æœ‹å‹"çš„å¯¹è±¡
- **ä¸å¯è¾¾å¯¹è±¡**ï¼š"å¤±è”å¯¹è±¡"ï¼Œç­‰å¾…æ¸…ç†

### ğŸ“– æ™ºæ…§äºŒï¼š"æ¸…ç†ç­–ç•¥"çš„é€‰æ‹©

ä¸åŒçš„"æ”¶å®¹æ‰€"éœ€è¦ä¸åŒçš„æ¸…ç†ç­–ç•¥ï¼š

#### ğŸ§¹ æ ‡è®°-æ¸…é™¤ï¼ˆMark-Sweepï¼‰
**å·¥ä½œæ–¹å¼ï¼š**
```
1. æ ‡è®°ï¼šç»™åƒåœ¾å¯¹è±¡è´´"æ ‡ç­¾"
2. æ¸…é™¤ï¼šæ¸…ç†æœ‰"æ ‡ç­¾"çš„å¯¹è±¡
```
**ä¼˜ç‚¹ï¼š** ç®€å•ç›´æ¥ï¼Œä¸ç§»åŠ¨å¯¹è±¡
**ç¼ºç‚¹ï¼š** äº§ç”Ÿå†…å­˜ç¢ç‰‡
**é€‚ç”¨åœºæ™¯ï¼š** è€å¹´ä»£ï¼ˆå¯¹è±¡è¾ƒå¤§ï¼Œç§»åŠ¨æˆæœ¬é«˜ï¼‰

#### ğŸ  å¤åˆ¶ç®—æ³•ï¼ˆCopyingï¼‰
**å·¥ä½œæ–¹å¼ï¼š**
```
1. å‡†å¤‡ä¸¤ä¸ªåŒºåŸŸï¼šAåŒºå’ŒBåŒº
2. å°†AåŒºå­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°BåŒº
3. æ¸…ç©ºAåŒº
4. ä¸‹æ¬¡ä½¿ç”¨AåŒºï¼Œæ¸…ç©ºBåŒº
```
**ä¼˜ç‚¹ï¼š** æ²¡æœ‰ç¢ç‰‡ï¼Œé€Ÿåº¦å¿«
**ç¼ºç‚¹ï¼š** éœ€è¦åŒå€ç©ºé—´
**é€‚ç”¨åœºæ™¯ï¼š** å¹´è½»ä»£ï¼ˆå¯¹è±¡è¾ƒå°ï¼Œå­˜æ´»ç‡ä½ï¼‰

#### ğŸ”§ æ ‡è®°-æ•´ç†ï¼ˆMark-Compactï¼‰
**å·¥ä½œæ–¹å¼ï¼š**
```
1. æ ‡è®°ï¼šæ‰¾åˆ°åƒåœ¾å¯¹è±¡
2. æ•´ç†ï¼šå°†å­˜æ´»å¯¹è±¡ç§»åˆ°ä¸€ç«¯
3. æ¸…ç†ï¼šæ¸…ç©ºå¦ä¸€ç«¯
```
**ä¼˜ç‚¹ï¼š** æ²¡æœ‰ç¢ç‰‡ï¼Œä¸éœ€è¦åŒå€ç©ºé—´
**ç¼ºç‚¹ï¼š** ç§»åŠ¨å¯¹è±¡è€—æ—¶
**é€‚ç”¨åœºæ™¯ï¼š** è€å¹´ä»£çš„å½»åº•æ¸…ç†

### ğŸ“– æ™ºæ…§ä¸‰ï¼š"åˆ†ä»£ç®¡ç†"çš„å“²å­¦

"ç®¡ç†å‘˜"å‘ç°äº†ä¸€ä¸ªé‡è¦è§„å¾‹ï¼š

#### ğŸ‘¶ å¹´è½»ä»£çš„ç‰¹ç‚¹
- **ç”Ÿå‘½å‘¨æœŸçŸ­**ï¼šå¤§éƒ¨åˆ†å¯¹è±¡å¾ˆå¿«"æ­»äº¡"
- **åƒåœ¾ç‡é«˜**ï¼š90%ä»¥ä¸Šçš„å¯¹è±¡ä¼šæˆä¸ºåƒåœ¾
- **æ¸…ç†é¢‘ç‡é«˜**ï¼šéœ€è¦ç»å¸¸æ¸…ç†
- **æ¸…ç†ç­–ç•¥**ï¼šå¤åˆ¶ç®—æ³•ï¼ˆå¿«é€Ÿï¼‰

#### ğŸ‘´ è€å¹´ä»£çš„ç‰¹ç‚¹
- **ç”Ÿå‘½å‘¨æœŸé•¿**ï¼šå¯¹è±¡"ç”Ÿå‘½åŠ›é¡½å¼º"
- **åƒåœ¾ç‡ä½**ï¼šå¤§éƒ¨åˆ†å¯¹è±¡ä¼šç»§ç»­å­˜æ´»
- **æ¸…ç†é¢‘ç‡ä½**ï¼šå¶å°”æ¸…ç†ä¸€æ¬¡
- **æ¸…ç†ç­–ç•¥**ï¼šæ ‡è®°-æ¸…é™¤æˆ–æ ‡è®°-æ•´ç†ï¼ˆå½»åº•ï¼‰

#### ğŸ¯ åˆ†ä»£å‡è¯´
è¿™æ˜¯JVMå†…å­˜ç®¡ç†çš„æ ¸å¿ƒç†è®ºï¼š
1. **å¼±åˆ†ä»£å‡è¯´**ï¼šå¤§éƒ¨åˆ†å¯¹è±¡éƒ½æ˜¯"æœç”Ÿå¤•æ­»"
2. **å¼ºåˆ†ä»£å‡è¯´**ï¼šç†¬è¿‡å¤šæ¬¡æ¸…ç†çš„å¯¹è±¡ä¼šæ´»å¾—æ›´ä¹…
3. **è·¨ä»£å¼•ç”¨å‡è¯´**ï¼šè€å¹´å¯¹è±¡å¾ˆå°‘å¼•ç”¨å¹´è½»å¯¹è±¡

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µæ€»ç»“

é€šè¿‡ä¸‰ä¸ªå®éªŒï¼Œæˆ‘ä»¬ç†è§£äº†"ç®¡ç†å‘˜"çš„å·¥ä½œæ™ºæ…§ï¼š

### ğŸ“‹ å®éªŒæ€»ç»“

| å®éªŒ | å‘ç° | æ™ºæ…§ |
|------|------|------|
| ä¾¦æ¢ç®—æ³• | ä»"æ ¹æ®åœ°"æœç´¢"æœ‹å‹å…³ç³»" | å¯è¾¾æ€§åˆ†æç®—æ³• |
| æ¸…ç†ç­–ç•¥ | ä¸åŒç­–ç•¥æœ‰ä¸åŒä¼˜ç¼ºç‚¹ | æ ¹æ®åœºæ™¯é€‰æ‹©æœ€ä¼˜ç­–ç•¥ |
| åˆ†ä»£ç®¡ç† | å¹´è½»äººå’Œè€å¹´äººç”Ÿå‘½å‘¨æœŸä¸åŒ | åˆ†ä»£æ”¶é›†ï¼Œå› ææ–½æ•™ |

### ğŸ”‘ æ ¸å¿ƒè®¤çŸ¥

#### 1. "ä¾¦æ¢"çš„å·¥ä½œæ–¹æ³•
```
å¯è¾¾æ€§åˆ†æ = ä»æ ¹æ®åœ°å‡ºå‘ + æ²¿ç€æœ‹å‹å…³ç³»æœç´¢
```
- **GC Roots**ï¼šæœç´¢çš„èµ·ç‚¹
- **å¼•ç”¨é“¾**ï¼šæœç´¢çš„è·¯å¾„
- **æ ‡è®°ç»“æœ**ï¼šå¯è¾¾ vs ä¸å¯è¾¾

#### 2. "æ¸…ç†"çš„ç­–ç•¥é€‰æ‹©
- **æ ‡è®°-æ¸…é™¤**ï¼šç®€å•ä½†æœ‰ç¢ç‰‡
- **å¤åˆ¶ç®—æ³•**ï¼šå¿«é€Ÿä½†è´¹ç©ºé—´
- **æ ‡è®°-æ•´ç†**ï¼šå¹³è¡¡ä½†è€—æ—¶

#### 3. "åˆ†ä»£"çš„ç®¡ç†å“²å­¦
- **å¹´è½»ä»£**ï¼šé¢‘ç¹å¿«é€Ÿæ¸…ç†ï¼ˆå¤åˆ¶ç®—æ³•ï¼‰
- **è€å¹´ä»£**ï¼šå¶å°”å½»åº•æ¸…ç†ï¼ˆæ ‡è®°-æ¸…é™¤/æ•´ç†ï¼‰
- **æ°¸ä¹…ä»£/å…ƒç©ºé—´**ï¼šå¾ˆå°‘æ¸…ç†ï¼ˆç±»ä¿¡æ¯ï¼‰

### ğŸ’¡ ç¼–ç¨‹å¯ç¤º

1. **ç†è§£å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ**ï¼šå¤§éƒ¨åˆ†å¯¹è±¡éƒ½æ˜¯çŸ­å‘½çš„
2. **åˆç†ä½¿ç”¨å†…å­˜**ï¼šé¿å…åˆ›å»ºä¸å¿…è¦çš„é•¿ç”Ÿå‘½å‘¨æœŸå¯¹è±¡
3. **å…³æ³¨GCæ€§èƒ½**ï¼šç†è§£ä¸åŒåƒåœ¾æ”¶é›†å™¨çš„ç‰¹ç‚¹

## ğŸ¤” è¯¾åæ€è€ƒé¢˜

### ğŸ”¬ åŠ¨æ‰‹å®éªŒé¢˜

1. **"ä¾¦æ¢è¿½è¸ª"å®éªŒ**
   - åˆ›å»ºå¤æ‚çš„å¯¹è±¡å¼•ç”¨ç½‘ç»œ
   - è§‚å¯Ÿï¼šæ–­å¼€ä¸åŒå¼•ç”¨å¯¹åƒåœ¾å›æ”¶çš„å½±å“

2. **"ç­–ç•¥å¯¹æ¯”"å®éªŒ**
   - ä½¿ç”¨ä¸åŒçš„JVMå‚æ•°æµ‹è¯•ä¸åŒçš„åƒåœ¾æ”¶é›†å™¨
   - å¯¹æ¯”ï¼š`-XX:+UseSerialGC`ã€`-XX:+UseParallelGC`ã€`-XX:+UseG1GC`

3. **"åˆ†ä»£è§‚å¯Ÿ"å®éªŒ**
   - åˆ›å»ºä¸åŒç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡
   - è§‚å¯Ÿï¼šå¯¹è±¡åœ¨å¹´è½»ä»£å’Œè€å¹´ä»£ä¹‹é—´çš„"æ™‹å‡"

### ğŸ§ ç°è±¡è§‚å¯Ÿé¢˜

1. **"æ ¹æ®åœ°"çš„ç§˜å¯†**
   - å“ªäº›åœ°æ–¹å¯ä»¥ä½œä¸ºGC Rootsï¼Ÿ
   - ä¸ºä»€ä¹ˆè¿™äº›åœ°æ–¹çš„å¯¹è±¡ä¸ä¼šè¢«å›æ”¶ï¼Ÿ

2. **"ç­–ç•¥é€‰æ‹©"çš„æ™ºæ…§**
   - ä»€ä¹ˆæƒ…å†µä¸‹é€‰æ‹©å¤åˆ¶ç®—æ³•ï¼Ÿ
   - ä»€ä¹ˆæƒ…å†µä¸‹é€‰æ‹©æ ‡è®°-æ•´ç†ç®—æ³•ï¼Ÿ

3. **"åˆ†ä»£è¾¹ç•Œ"çš„å¥¥ç§˜**
   - å¯¹è±¡ä»€ä¹ˆæ—¶å€™ä»å¹´è½»ä»£"æ™‹å‡"åˆ°è€å¹´ä»£ï¼Ÿ
   - "æ™‹å‡"çš„æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ

### ğŸ’­ æ·±åº¦æ€è€ƒé¢˜

1. **"å¾ªç¯å¼•ç”¨"çš„éš¾é¢˜**
   - å¦‚æœå¯¹è±¡Aå¼•ç”¨Bï¼ŒBå¼•ç”¨Aï¼Œä½†éƒ½ä¸è¢«GC Rootå¼•ç”¨ï¼Œä¼šè¢«å›æ”¶å—ï¼Ÿ
   - å¯è¾¾æ€§åˆ†æå¦‚ä½•è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Ÿ

2. **"æ€§èƒ½å¹³è¡¡"çš„è‰ºæœ¯**
   - åƒåœ¾å›æ”¶çš„é¢‘ç‡å’Œç¨‹åºæ€§èƒ½å¦‚ä½•å¹³è¡¡ï¼Ÿ
   - å¦‚ä½•é€‰æ‹©æœ€é€‚åˆçš„åƒåœ¾æ”¶é›†å™¨ï¼Ÿ

3. **"æœªæ¥å‘å±•"çš„æ€è€ƒ**
   - éšç€å†…å­˜è¶Šæ¥è¶Šå¤§ï¼Œåƒåœ¾å›æ”¶é¢ä¸´ä»€ä¹ˆæŒ‘æˆ˜ï¼Ÿ
   - æœ‰æ²¡æœ‰å¯èƒ½å®ç°"é›¶åœé¡¿"çš„åƒåœ¾å›æ”¶ï¼Ÿ

## ğŸ”® ä¸‹èŠ‚é¢„å‘Šï¼š"æ”¶é›†å™¨å¤§å®¶æ—"

é€šè¿‡è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬ç†è§£äº†"ç®¡ç†å‘˜"çš„å·¥ä½œåŸç†å’Œç­–ç•¥ã€‚ä½†æ˜¯ä½ çŸ¥é“å—ï¼ŸJVMå…¶å®æœ‰å¾ˆå¤šä¸åŒçš„"ç®¡ç†å‘˜"ï¼

### ğŸ¤” "ç®¡ç†å‘˜"çš„è¿›åŒ–å²

æƒ³è±¡ä¸€ä¸‹ï¼Œéšç€"æ”¶å®¹æ‰€"è§„æ¨¡çš„ä¸æ–­æ‰©å¤§ï¼š

- **ğŸ  å°å‹æ”¶å®¹æ‰€**ï¼šä¸€ä¸ªç®¡ç†å‘˜å°±å¤Ÿäº†ï¼ˆSerial GCï¼‰
- **ğŸ¢ ä¸­å‹æ”¶å®¹æ‰€**ï¼šéœ€è¦å¤šä¸ªç®¡ç†å‘˜åä½œï¼ˆParallel GCï¼‰
- **ğŸ™ï¸ å¤§å‹æ”¶å®¹æ‰€**ï¼šéœ€è¦æ™ºèƒ½ç®¡ç†ç³»ç»Ÿï¼ˆG1 GCï¼‰
- **ğŸŒ è¶…å¤§å‹æ”¶å®¹æ‰€**ï¼šéœ€è¦é©å‘½æ€§æŠ€æœ¯ï¼ˆZGCã€Shenandoahï¼‰

### ğŸ¯ ä¸‹èŠ‚è¯¾æ­ç§˜

**ç¬¬äº”è¯¾ï¼šã€Šæ”¶é›†å™¨å¤§å®¶æ— - é€‰æ‹©æœ€é€‚åˆçš„"ç®¡ç†å‘˜"ã€‹**

æˆ‘ä»¬å°†é€šè¿‡å®éªŒå‘ç°ï¼š
1. **"å•çº¿ç¨‹ç®¡ç†å‘˜"**ï¼šSerial GCçš„å·¥ä½œæ–¹å¼
2. **"å›¢é˜Ÿç®¡ç†å‘˜"**ï¼šParallel GCçš„åä½œæ¨¡å¼
3. **"æ™ºèƒ½ç®¡ç†å‘˜"**ï¼šG1 GCçš„åˆ†åŒºç­–ç•¥
4. **"æœªæ¥ç®¡ç†å‘˜"**ï¼šZGCçš„é©å‘½æ€§æŠ€æœ¯

### ğŸ’­ è¯¾å‰æ€è€ƒ

å¦‚æœä½ è¦ä¸ºä¸åŒè§„æ¨¡çš„"æ”¶å®¹æ‰€"é€‰æ‹©"ç®¡ç†å‘˜"ï¼Œä½ ä¼šè€ƒè™‘å“ªäº›å› ç´ ï¼Ÿ
- æ”¶å®¹æ‰€çš„å¤§å°ï¼Ÿ
- å±…æ°‘çš„æ•°é‡ï¼Ÿ
- å¯¹"åœé¡¿æ—¶é—´"çš„è¦æ±‚ï¼Ÿ
- å¯¹"ååé‡"çš„è¦æ±‚ï¼Ÿ

---

**ğŸŒŸ è®°ä½ï¼šç†è§£äº†"ç®¡ç†å‘˜"çš„æ™ºæ…§ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯é€‰æ‹©æœ€é€‚åˆçš„"ç®¡ç†å‘˜"ï¼**